#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(tp) <- cn
#options------------------------------------------------------------
rm(list=ls())
options(scipen = 100)
#R의 데이터를 올릴 수 있는 메모리 제한 해제
memory.limit(10000000000000)
#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(df) <- cn
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","1",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.)
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(dep ~ ind[,1],family = binomial)
ind[,1]
dep
fit <- glm(dep ~ ind[,1],family = binomial)
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","1",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.) %>%
as.numeric()
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(dep ~ ind[,1],family = binomial)
fit <-step(fit,trace=F)
fit_int <- update(fit, . ~ 1)
anova(fit_int, fit, test="Chisq")
drop1(fit,test="Chisq")
hoslem.test()
fit <- glm(dep ~ ind,family = binomial)
fit <- glm(dep ~ ind[,1]+ind[,2]+ind[,3]+ind[,4]+ind[,5]+ind[,6]
+ind[,7]+ind[,8]+ind[,9]+ind[,10]+ind[,1]+ind[,1] ,family = binomial)
summary(fit)
fit <-step(fit,trace=F)
fit_int <- update(fit, . ~ 1)
anova(fit_int, fit, test="Chisq")
drop1(fit,test="Chisq")
hoslem.test()
fit <-step(fit,trace=F)
fit_int <- update(fit, . ~ 1)
anova(fit_int, fit, test="Chisq")
#options------------------------------------------------------------
rm(list=ls())
options(scipen = 100)
#R의 데이터를 올릴 수 있는 메모리 제한 해제
memory.limit(10000000000000)
#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(df) <- cn
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","0",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.) %>%
as.numeric()
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(dep ~ ind[,1]+ind[,2]+ind[,3]+ind[,4]+ind[,5]+ind[,6]
+ind[,7]+ind[,8]+ind[,9]+ind[,10]+ind[,1]+ind[,1] ,family = binomial)
summary(fit)
fit <-step(fit,trace=F)
fit_int <- update(fit, . ~ 1)
anova(fit_int, fit, test="Chisq")
drop1(fit,test="Chisq")
df
ind <- df[,c(6:15)]
View(ind)
fit <- glm(태평동이용 ~ 맛+접근성성,family = binomial, data=df)
fit <- glm(태평동이용 ~ 맛+접근성,family = binomial, data=df)
fit <- glm(태평동이용 ~ 맛+접근성+가격+서비스+위생+다양성+양+크기+시간+분위기,family = binomial, data=df)
summary(fit)
fit <-step(fit,trace=F)
fit_int <- update(fit, . ~ 1)
anova(fit_int, fit, test="Chisq")
drop1(fit,test="Chisq")
hoslem.test()
#options------------------------------------------------------------
rm(list=ls())
options(scipen = 100)
#R의 데이터를 올릴 수 있는 메모리 제한 해제
memory.limit(10000000000000)
#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(df) <- cn
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","1",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.) %>%
as.numeric()
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(태평동이용 ~ 맛+접근성+가격+서비스+위생+다양성+양+크기+시간+분위기
,family = binomial, data=df)
summary(fit)
fit <-step(fit,trace=F)
fit_int <- update(fit, . ~ 1)
anova(fit_int, fit, test="Chisq")
drop1(fit,test="Chisq")
hoslem.test()
View(fit_int)
fit_int
fit1 <-step(fit,direction = "backward")
summary(fit1)
#options------------------------------------------------------------
rm(list=ls())
options(scipen = 100)
#R의 데이터를 올릴 수 있는 메모리 제한 해제
memory.limit(10000000000000)
#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(df) <- cn
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","0",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.) %>%
as.numeric()
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(태평동이용 ~ 맛+접근성+가격+서비스+위생+다양성+양+크기+시간+분위기
,family = binomial, data=df)
summary(fit)
fit1 <-step(fit,direction = "backward")
summary(fit1)
fit1 <-step(fit,direction = "stepwise")
fit1 <-step(fit,direction = "both")
summary(fit1)
fit <- glm(태평동이용 ~ 맛+접근성+가격+서비스+위생+다양성+양+크기+시간+분위기
,family = binomial(), data=df)
summary(fit)
predict(logistic, newdata=df)
predict(fit1, newdata=df)
probability = predict(fit1, newdata=df)
probability = predict(fit1, newdata=df, type='response')
probability
install.packages(c("caret","e1071"))
install.packages(c("caret", "e1071"))
library(caret)
confusionMatrix(df$비대면, predict_c)
#options------------------------------------------------------------
rm(list=ls())
options(scipen = 100)
#R의 데이터를 올릴 수 있는 메모리 제한 해제
memory.limit(10000000000000)
#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(df) <- cn
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","0",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.) %>%
as.numeric()
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(태평동이용 ~ 맛+접근성+가격+서비스+위생+다양성+양+크기+시간+분위기
,family = binomial(), data=df)
summary(fit)
fit1 <-step(fit,direction = "both")
summary(fit1)
log_odds = predict(fit1, newdata=df)
probability = predict(fit1, newdata=df, type='response')
predict_c = ifelse(probability > 0.5, 1, 0) %>%
as.factor()
install.packages(c("caret","e1071"))
library(caret)
confusionMatrix(df$비대면, predict_c)
install.packages(c("caret", "e1071"))
library()l
#install.packages(c("caret","e1071"))
library(caret)
confusionMatrix(df$비대면, predict_c)
predict_c
df$비대면
View(df)
confusionMatrix(df$태평동이용용, predict_c)
confusionMatrix(df$태평동이용, predict_c)
df$태평동이용용
df$태평동이용
confusionMatrix(as.factor(df$태평동이용), predict_c)
hoslem.test()
install.packages('ResourceSelection')
library(ResourceSelection)
#install.packages('ResourceSelection')
library(ResourceSelection)
hoslem.test()
hoslem.test(fit1$y, fitted(fit1), g=5)
hoslem.test(fit1$y, fitted(fit1), g=10)
?hoslem.test
#
install.packages('rms')
library(rms)
install.packages("rms")
#install.packages('rms')
library(rms)
lrm(formula=fit1)
lrm(fit1)
View(fit1)
View(fit1)
lrm(fit1)
summary(fit1)
lrm(fit1)
?lrm
lrm(fit1, data=df)
#options------------------------------------------------------------
rm(list=ls())
options(scipen = 100)
#R의 데이터를 올릴 수 있는 메모리 제한 해제
memory.limit(10000000000000)
#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(df) <- cn
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","0",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.) %>%
as.numeric()
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(태평동이용 ~ 맛+접근성+가격+서비스+위생+다양성+양+크기+시간+분위기
,family = binomial(), data=df)
summary(fit)
fit1 <-step(fit,direction = "both")
summary(fit1)
log_odds = predict(fit1, newdata=df)
probability = predict(fit1, newdata=df, type='response')
predict_c = ifelse(probability > 0.5, 1, 0) %>%
as.factor()
#install.packages(c("caret","e1071"))
library(caret)
confusionMatrix(as.factor(df$태평동이용), predict_c)
predict_c
df$태평동이용
#install.packages('ResourceSelection')
#모형 적합도 권장X
library(ResourceSelection)
hoslem.test(fit1$y, fitted(fit1), g=10)
?hoslem.test
#install.packages('rms')
library(rms)
lrm(fit1, data=df)
?lrm
fit <-step(fit,trace=F)
fit_int <- update(fit, . ~ 1)
anova(fit_int, fit, test="Chisq")
drop1(fit,test="Chisq")
exp(1.8537)
fit1 <-step(fit,direction = "both")
summary(fit1)
exp(1.6800)
exp(1.2282)
exp(1.6800)
exp(-1.8537)
exp(1.2282)
View(fit1)
View(ind)
exp(0.3557)
exp(1.6800)
exp(-0.6525)
exp(-1.8537)
exp(1.2282)
#options------------------------------------------------------------
rm(list=ls())
options(scipen = 100)
#R의 데이터를 올릴 수 있는 메모리 제한 해제
memory.limit(10000000000000)
#################################################################
#install.packages('psych')
#install.packages('CCA')
#install.packages('bestglm')
library(bestglm)
library(psych)
library(CCA)
library(dplyr)
#1.비대면수업횟수
#2.학교방문횟수
#3.몇인가구?
#4.한달소비?
#5.태평동상권방문횟수
#6.맛 7.접근성 8.가격 9.서비스 10.위생 11.메뉴다양성 12.양 13.크기 14.나오는시간 15.분위기
cn=c('비대면','학교','가구','소비','태평동이용','맛','접근성',
'가격','서비스','위생','다양성','양','크기','시간','분위기')
df <- read.csv('G:/공유 드라이브/data/태평동 상권 만족도 조사.csv',sep = '\t')
df <- df[,c(4:5,7:9,14:23)]
colnames(df) <- cn
#0:자주방문X, 1:자주방문O
df[,c(5)] <- df[,c(5)] %>%
gsub("0","0",.) %>%
gsub("1","0",.) %>%
gsub("2","0",.) %>%
gsub("3","1",.) %>%
gsub("4","1",.) %>%
gsub("5","1",.) %>%
as.numeric()
ind <- df[,c(6:15)]
dep <- df[,c(5)]
#######
fit <- glm(태평동이용 ~ 맛+접근성+가격+서비스+위생+다양성+양+크기+시간+분위기
,family = binomial(), data=df)
summary(fit)
fit1 <-step(fit,direction = "both")
summary(fit1)
log_odds = predict(fit1, newdata=df)
probability = predict(fit1, newdata=df, type='response')
predict_c = ifelse(probability > 0.5, 1, 0) %>%
as.factor()
#install.packages(c("caret","e1071"))
library(caret)
confusionMatrix(as.factor(df$태평동이용), predict_c)
predict_c
df$태평동이용
#install.packages('ResourceSelection')
#모형 적합도 권장X
library(ResourceSelection)
hoslem.test(fit1$y, fitted(fit1), g=10)
#install.packages('rms')
library(rms)
lrm(fit1, data=df)
exp(1.6800)
exp(-0.6525)
exp(-1.8537)
exp(1.2282)
exp(-4.0776)
ind %>% cor() %>% KMO
ind %>% cor() %>% KMO
exp(-4.0776)
exp(1.6800)
exp(-0.6525)
exp(-1.8537)
exp(1.2282)
install.packages('ggcorrplot')
#install.packages('ggcorrplot')
library(ggcorrplot)
ind %>% cor %>% ggcorrplot(lab=T,lab_size = 2,show.legend = F,colors = c('red','white','skyblue'))
library(ggplot2)
ggsave("D:/OneDrive - 가천대학교/학교 비교과 관련/2022-2 맛집으로로그인/zz.tiff", dpi=300, dev='tiff', height=18.64, width=18.64, units="in")
ind %>% cor %>% ggcorrplot(lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(lab=T,lab_size = 5.5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(lab=T,lab_size = 6,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(lab=T,lab_size = 10,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ggsave("D:/OneDrive - 가천대학교/학교 비교과 관련/2022-2 맛집으로로그인/zz.tiff", dpi=300, dev='tiff', height=18.64, width=18.64, units="in")
ggsave("D:/OneDrive - 가천대학교/학교 비교과 관련/2022-2 맛집으로로그인/zz.tiff", dpi=300, dev='tiff', height=18.64, width=18.64,tl.cex=5, units="in")
ggsave("D:/OneDrive - 가천대학교/학교 비교과 관련/2022-2 맛집으로로그인/zz.tiff", dpi=300, dev='tiff', height=18.64, width=18.64,tl.cex=0.5, units="in")
ind %>% cor %>% ggcorrplot(tl.cex=0.5,lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(tl.cex=5,lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(tl.cex=50,lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(tl.cex=10,lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(tl.cex=15,lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(tl.cex=20,lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ind %>% cor %>% ggcorrplot(tl.cex=17,lab=T,lab_size = 5,show.legend = F,colors = c('red','white','skyblue'))
ggsave("D:/OneDrive - 가천대학교/학교 비교과 관련/2022-2 맛집으로로그인/zz.tiff", dpi=300, dev='tiff', height=18.64, width=18.64, units="in")
setwd("C:/EDA/data")
knitr::opts_chunk$set(echo = TRUE)
data_path
data_path
data_path = "C:/EDA/data/"
data_path
toeic <- read.csv(paste0(data_path, "toeic.2021.csv"), header=False)
data_path
toeic <- read.csv(paste0(data_path, "toeic.2021.csv"))
toeic
rm(list = ls())
