<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="이하늘, 가천대학교 응용통계학과 201932142" />


<title>통계 방법론 I - CH2~7 기말고사 대체 실습</title>

<script src="통계방법론1_기말고사_이하늘_files/header-attrs-2.18/header-attrs.js"></script>
<script src="통계방법론1_기말고사_이하늘_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="통계방법론1_기말고사_이하늘_files/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="통계방법론1_기말고사_이하늘_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="통계방법론1_기말고사_이하늘_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="통계방법론1_기말고사_이하늘_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="통계방법론1_기말고사_이하늘_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="통계방법론1_기말고사_이하늘_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="통계방법론1_기말고사_이하늘_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="통계방법론1_기말고사_이하늘_files/navigation-1.1/tabsets.js"></script>
<script src="통계방법론1_기말고사_이하늘_files/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">통계 방법론 I - CH2~7 기말고사 대체
실습</h1>
<h4 class="author">이하늘, 가천대학교 응용통계학과 201932142</h4>
<h4 class="date">2022-12-10(SAT)</h4>

</div>


<style type="text/css">
  body, td {
     font-size: 16px;
     font-family: 맑은 고딕
  }
  code.r{
    font-size: 16px;
    font-weight: bold;
    font-family: 맑은 고딕
  }
  pre {
    font-size: 14px
    font-family: 맑은 고딕
  }
  h1,h2,h3,h4,h5,h6{
    font-family: 맑은 고딕;
  }
  h1{
    font-size: 22pt;
  }
  h2{
    font-size: 20pt;
  }
  h3{
    font-size: 18pt;
  }
</style>
<p><br></p>
<div id="chap2.-data-and-statistics" class="section level1">
<h1>Chap2. Data and Statistics</h1>
<div id="types-of-data" class="section level2">
<h2>2.1 Types of Data</h2>
<ul>
<li>count: 특정 속성을 가지지 않는 데이터로 음이 아닌 정수 값만 취할 수
있는 형태이다. ex) 동전 N번 던졌을 경우 n 번의 앞면의 개수가 나왔을 때
n이 가지는 값</li>
<li>categorical: 범주형 데이터를 의미하며, 클래스 데이터나 팩터형
데이터로 불린다. 범주형 데이터가 가지는 클래스를 수준이라고 한다. ex)
성별, 혈액형</li>
<li>ordered: 순서형 데이터를 의미하며, 개개의 값들이 이산적이고 그들
사이에 순서 관계가 존재하는 형태이다. ex) 만족도, 성적</li>
<li>interval: 구간형 데이터를 의미하며, 데이터의 연속된 측정 구간 사이의
간격이 동일한 경우이다. 절대적 원점이 존재하지 않는다. ex) 온도,
주가지수</li>
<li>ratio: 비율형 데이터를 의미하며, 절대적 원점이 존재하고 숫자 간의
비율이 산술적 의미를 가진다. ex) 키, 무게, 압력</li>
</ul>
</div>
<div id="data-display-and-calculation" class="section level2">
<h2>2.2 Data Display and Calculation</h2>
<p>숫자형 데이터를 사용할 경우 1. 계산 도중 반올림을 하면 안된다. 2.
최종 데이터는 원본 데이터와 자릿수를 맞춰주는 것이 가능하다. 3.
표준편차를 통해 신뢰할 수 있는 자릿수를 얻을 수 있다.</p>
</div>
<div id="importing-data" class="section level2">
<h2>2.3 Importing Data</h2>
<p>해당 책에서는 R 프로그램과 R에서 제공하는 ‘HH’ 패키지에서 대부분의
데이터를 가져온다.</p>
</div>
<div id="data-rearrangement" class="section level2">
<h2>2.5 Data Rearrangement</h2>
<p>데이터 정렬은 ‘reshape2’ 패키지를 사용한다.</p>
</div>
<div id="code-files-for-statistical-analysis-and-data-display-hh"
class="section level2">
<h2>2.7 Code Files for Statistical Analysis and Data Display (HH)</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;HH&#39;)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH) <span class="co">#해당 패키지 로드</span></span></code></pre></div>
<pre><code>## 필요한 패키지를 로딩중입니다: lattice</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: grid</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: latticeExtra</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: multcomp</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: mvtnorm</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: survival</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: TH.data</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: MASS</code></pre>
<pre><code>## 
## 다음의 패키지를 부착합니다: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
<pre><code>## 필요한 패키지를 로딩중입니다: gridExtra</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;reshape2&#39;)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2) <span class="co">#해당 패키지 로드</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터프레임 형태 만들기</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Names=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>) <span class="co">#3개의 변수(Names,x,y)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>wide</span></code></pre></div>
<pre><code>##   Names x  y
## 1     A 1  6
## 2     B 2  7
## 3     C 3  8
## 4     D 4  9
## 5     E 5 10</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reshape2::melt를 사용하여 여러 컬럼으로 구성된 데이터를 데이터 식별자(id), 측정변수(variable), 측정값(value)이라는 3개 컬럼으로 변환.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> <span class="fu">melt</span>(wide, <span class="at">id=</span><span class="st">&quot;Names&quot;</span>) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>long</span></code></pre></div>
<pre><code>##    Names variable value
## 1      A        x     1
## 2      B        x     2
## 3      C        x     3
## 4      D        x     4
## 5      E        x     5
## 6      A        y     6
## 7      B        y     7
## 8      C        y     8
## 9      D        y     9
## 10     E        y    10</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reshape2::dcast - melt()된 데이터를 다시 여러 컬럼으로 변환. dcast는 결과로 데이터프레임 반환.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#formula - &quot;id변수~variable 변수&quot; 형태</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>wideagain <span class="ot">&lt;-</span> <span class="fu">dcast</span>(Names <span class="sc">~</span> variable, <span class="at">value=</span><span class="st">&quot;value&quot;</span>, <span class="at">data=</span>long)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>wideagain</span></code></pre></div>
<pre><code>##   Names x  y
## 1     A 1  6
## 2     B 2  7
## 3     C 3  8
## 4     D 4  9
## 5     E 5 10</code></pre>
</div>
<div id="a-appendix-missing-values-in-r" class="section level2">
<h2>2.A Appendix: Missing Values in R</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read.table - txt 파일을 불러오는 함수</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>AA <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span><span class="st">&quot;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">                 x y</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">                 1 2</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 3 NA</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">                 5 6</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">                 &quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>AA</span></code></pre></div>
<pre><code>##   x  y
## 1 1  2
## 2 3 NA
## 3 5  6</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sapply - 주어진 데이터에 함수를 적용하여 벡터나 행렬 또는 배열로 결과를 반환하는 함수</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#각 컬럼 별 데이터 타입 확인</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(AA, class) <span class="co">#x, y 모두 integer 출력</span></span></code></pre></div>
<pre><code>##         x         y 
## &quot;integer&quot; &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>BB <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span><span class="st">&quot;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="st">                 x y</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">                 1 2</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">                 3 999</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 5 6</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">                 7 .</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="st">                 9 10</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">                 &quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">na.strings=</span><span class="fu">c</span>(<span class="st">&quot;999&quot;</span>, <span class="st">&quot;.&quot;</span>))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#na.strings - NA로 인식할 문자나 숫자 입력</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>BB</span></code></pre></div>
<pre><code>##   x  y
## 1 1  2
## 2 3 NA
## 3 5  6
## 4 7 NA
## 5 9 10</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 컬럼 별 데이터 타입 확인</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(BB, class) <span class="co">#x, y 모두 integer 출력</span></span></code></pre></div>
<pre><code>##         x         y 
## &quot;integer&quot; &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>CC <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span><span class="st">&quot;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="st">                 x y</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="st">                 1 2</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">                 3 999</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 5 6</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">                 7 .</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">                 9 10</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">                 &quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>CC</span></code></pre></div>
<pre><code>##   x   y
## 1 1   2
## 2 3 999
## 3 5   6
## 4 7   .
## 5 9  10</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 컬럼 별 데이터 타입 확인</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(CC, class) <span class="co">#x-integer, y-character -&gt; .으로 인해 모두 문자형으로 인식</span></span></code></pre></div>
<pre><code>##           x           y 
##   &quot;integer&quot; &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>CC<span class="sc">$</span>y</span></code></pre></div>
<pre><code>## [1] &quot;2&quot;   &quot;999&quot; &quot;6&quot;   &quot;.&quot;   &quot;10&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>abcd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="cn">NA</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>),</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="cn">NA</span>,<span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">11</span>), <span class="at">ch=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;P&quot;</span>,<span class="st">&quot;Q&quot;</span>,<span class="st">&quot;R&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;T&quot;</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stringsAsFactors - 문자열 데이터가 있을 경우 자동으로 클래스를 facotr로 변환.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>abcd   </span></code></pre></div>
<pre><code>##    x  y   ch
## 1  1  6 &lt;NA&gt;
## 2  2  5    N
## 3 NA  8    O
## 4  4 NA    P
## 5  5 10    Q
## 6  6  9    R
## 7  7 12    S
## 8  8 11    T</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 컬럼 별 데이터 타입 확인</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(abcd,class) <span class="co"># x-numeric, y-numeric, ch-character</span></span></code></pre></div>
<pre><code>##           x           y          ch 
##   &quot;numeric&quot;   &quot;numeric&quot; &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stringsAsFactors=FALSE로 지정했기 때문</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(y <span class="sc">~</span> x, <span class="at">data=</span>abcd, <span class="at">labels=</span>abcd<span class="sc">$</span>ch, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span>panel.text, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-3-1.png" width="960" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#문자형의 NA는 표시되지만 수치형 NA는 표시되지 않는다. - O,P가 표시되지 않음.</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#NA 산술</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">+</span> <span class="cn">NA</span> <span class="co">#NA</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="dv">3</span>, <span class="cn">NA</span>) <span class="co">#NA</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="dv">3</span>, <span class="cn">NA</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="co">#3, na.rm - na값 제외 후 계산 여부</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>abcd<span class="sc">$</span>x <span class="co">#1 2 NA 4 5 6 7 8</span></span></code></pre></div>
<pre><code>## [1]  1  2 NA  4  5  6  7  8</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(abcd<span class="sc">$</span>x) <span class="co">#NA</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(abcd<span class="sc">$</span>x, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="co">#4.714286</span></span></code></pre></div>
<pre><code>## [1] 4.714286</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#linear model(선형 모델)은 NA에 대한 기본값이 (na.action=na.omit)로 NA값을 제거하고 작동한다.</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#lm - 선형 모델 적용</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>a.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>abcd) </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#predict-선형 모델 예측</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(a.lm)</span></code></pre></div>
<pre><code>##         1         2         5         6         7         8 
##  5.296137  6.218884  8.987124  9.909871 10.832618 11.755365</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(na.action=na.exclude)를 사용하면 모델 적용시에는 NA가 제거되지만</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 자체의 값에서는 보존이 되어 predict 적용시 NA가 출력된다.</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>b.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>abcd, <span class="at">na.action=</span>na.exclude)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(b.lm) <span class="co">#3,4 - NA 출력</span></span></code></pre></div>
<pre><code>##         1         2         3         4         5         6         7         8 
##  5.296137  6.218884        NA        NA  8.987124  9.909871 10.832618 11.755365</code></pre>
<p><br></p>
</div>
</div>
<div id="chap3.-statistics-concepts" class="section level1">
<h1>Chap3. Statistics Concepts</h1>
<div id="concepts-that-are-used-when-discussing-distributions"
class="section level2">
<h2>3.3 Concepts That Are Used When Discussing Distributions</h2>
<div id="displays-of-univariate-data" class="section level3">
<h3>3.3.4 Displays of Univariate Data</h3>
<p>데이터 표현에 관한 다양한 방법이 제시된다.</p>
</div>
<div id="histogram" class="section level3">
<h3>3.3.4.1 Histogram</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#파이프라인 사용을 위해 &#39;tidyverse&#39; &amp; &#39;magrittr&#39; 패키지 로드</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## Found more than one class &quot;atomicVector&quot; in cache; using the first, from namespace &#39;Matrix&#39;</code></pre>
<pre><code>## Also defined by &#39;Rmpfr&#39;</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
## ✔ readr   2.1.3      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::combine()   masks gridExtra::combine()
## ✖ dplyr::filter()    masks stats::filter()
## ✖ dplyr::lag()       masks stats::lag()
## ✖ ggplot2::layer()   masks latticeExtra::layer()
## ✖ dplyr::select()    masks MASS::select()
## ✖ purrr::transpose() masks HH::transpose()</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code></pre></div>
<pre><code>## 
## 다음의 패키지를 부착합니다: &#39;magrittr&#39;
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     set_names
## 
## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#남성 기대수명의 빈도 분포</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#tv-HH 패키지 제공 데이터</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tv)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">#as.matrix - 행렬로 변환</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(<span class="fu">cut</span>(tv<span class="sc">$</span>male.life.exp,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="fl">49.5</span>,<span class="fl">79.5</span>,<span class="dv">5</span>))))</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#차원(행,열) 이름 지정</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;Male Life Expectancy&quot;</span> </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>       <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;50--54&quot;</span>,<span class="st">&quot;55--59&quot;</span>,<span class="st">&quot;60--64&quot;</span>,<span class="st">&quot;65--69&quot;</span>,<span class="st">&quot;70--74&quot;</span>,<span class="st">&quot;75--79&quot;</span>),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot; &quot;</span><span class="ot">=</span><span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>tmp <span class="co">#남성의 평균 수명 빈도분포표 출력</span></span></code></pre></div>
<pre><code>##                      
## Male Life Expectancy Frequency
##               50--54         6
##               55--59         4
##               60--64         9
##               65--69        11
##               70--74         7
##               75--79         3</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hist - 히스토그램</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(tv<span class="sc">$</span>male.life.exp, <span class="at">xlab=</span><span class="st">&quot;male.life.exp&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Count&quot;</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;Life Expectancy for Males&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hist(tv$male.life.exp, xlab=&quot;male.life.exp&quot;,ylab=&quot;Count&quot;,</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     main = &quot;Life Expectancy for Males&quot;)</span></span></code></pre></div>
</div>
<div id="stem-and-leaf-display" class="section level3">
<h3>3.3.4.2 Stem-and-Leaf Display</h3>
<p>데이터 자체의 값을 볼 수 있다는 장점이 있다.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stem - 줄기잎 그림 출력</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(tv<span class="sc">$</span>male.life.exp)</span></code></pre></div>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   5 | 002234
##   5 | 6799
##   6 | 012223344
##   6 | 66777888899
##   7 | 1223334
##   7 | 556</code></pre>
</div>
<div id="boxplots" class="section level3">
<h3>3.3.4.3 Boxplots</h3>
<p>최소값, q1, 중위수, q3, 최대값을 박스-그림으로 볼 수 있다.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#quantile - 분위수 값(기본값: 0, 0.25, 0.5, 0.75, 1)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(tv<span class="sc">$</span>male.life.exp)</span></code></pre></div>
<pre><code>##    0%   25%   50%   75%  100% 
## 50.00 59.75 66.00 69.50 76.00</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot - 박스-수염 그림</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>(male_stat <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(tv<span class="sc">$</span>male.life.exp)) <span class="co">#개수, 신뢰구간 등 박스그림 정보 저장</span></span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-8-1.png" width="960" /></p>
<pre><code>## $stats
##      [,1]
## [1,] 50.0
## [2,] 59.5
## [3,] 66.0
## [4,] 70.0
## [5,] 76.0
## 
## $n
## [1] 40
## 
## $conf
##          [,1]
## [1,] 63.37689
## [2,] 68.62311
## 
## $out
## numeric(0)
## 
## $group
## numeric(0)
## 
## $names
## [1] &quot;1&quot;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(tv<span class="sc">$</span>male.life.exp, <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(male_stat<span class="sc">$</span>stats[[<span class="dv">3</span>]], <span class="dv">1</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-8-2.png" width="960" /></p>
</div>
</div>
<div id="three-probability-distributions" class="section level2">
<h2>3.4 Three Probability Distributions</h2>
<p>세 가지의 확률 분포에 대해 소개한다.</p>
<ul>
<li>이항 분포(이산형 분포)</li>
<li>정규 분포(연속형 분포)</li>
<li>t 분포(연속형 분포)</li>
</ul>
<div id="the-binomial-distribution" class="section level3">
<h3>3.4.1 The Binomial Distribution</h3>
<p>이항 분포는 연속된 n번 독립적 시행에서 각 시행이 확률 p를 가질 때의
이산확률분포로 정의된다. k번의 성공, (n-k)번의 실패일 경우 이항 분포의
확률질량함수는 다음과 같다.</p>
<p><span class="math display">\[
Pr(K=k) = {n\choose k}  p^k (1-p)^{n-k}
\]</span> 이항분포의 평균 $ = np $, 표준편차 $ = $이다.</p>
<p>이항 분포 관련 R 함수</p>
<ul>
<li>pbinom(q, size, prob, lower.tail = TRUE, log.p = FALSE):
누적분포함수</li>
<li>dbinom(x, size, prob, log = FALSE): 확률밀도함수 $ P(X=x) $</li>
<li>qbinom(p, size, prob, lower.tail = TRUE, log.p = FALSE):
누적분포함수의 역함수</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">size=</span><span class="dv">15</span>, <span class="at">prob=</span>.<span class="dv">4</span>, <span class="at">q=</span><span class="dv">6</span>) <span class="co">#0.6098</span></span></code></pre></div>
<pre><code>## [1] 0.6098132</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q=</span><span class="fl">6.5</span>, <span class="at">mean=</span><span class="dv">15</span><span class="sc">*</span>.<span class="dv">4</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">15</span><span class="sc">*</span>.<span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-.4</span>))) <span class="co">#0.6039 #pnorm-정규분포의 누적분포함수</span></span></code></pre></div>
<pre><code>## [1] 0.6039263</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">size=</span><span class="dv">15</span>, <span class="at">prob=</span>.<span class="dv">4</span>, <span class="at">x=</span><span class="dv">6</span>) <span class="co">#0.2066 </span></span></code></pre></div>
<pre><code>## [1] 0.2065976</code></pre>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#정규분포의 P(5.5 &lt; x &lt; 6.5) = .2079</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">pnorm</span>(<span class="at">q=</span><span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">6.5</span>), <span class="at">mean=</span><span class="dv">15</span><span class="sc">*</span>.<span class="dv">4</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">15</span><span class="sc">*</span>.<span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-.4</span>)))) <span class="co">#0.2079 </span></span></code></pre></div>
<pre><code>## [1] 0.2078526</code></pre>
</div>
<div id="the-normal-distribution" class="section level3">
<h3>3.4.2 The Normal Distribution</h3>
<p>정규 분포는 대칭인 종 모양을 갖는 분포로 평균과 중간값이 같고, 분포의
중앙에 있다. 평균 $ $, 표준편차 $ $를 가질 때 확률밀도함수는 다음과
같다.</p>
<p><span class="math display">\[
f(x) = {1\over \sigma\sqrt{2\pi}}\exp(-{(x-\mu)^2\over2\sigma^2}), X
\sim N(\mu, \sigma^2)
\]</span> 만약 <span class="math inline">\(X\)</span>가 평균 $ $,
표준편차 $ $를 가지는 정규분포를 따른다면 표준정규분포는 다음과
같다.</p>
<p><span class="math display">\[
\begin{aligned}
Z &amp;= {X-\mu \over \sigma} , Z \sim N(0, 1)\\
f(z) &amp;= {1\over \sqrt{2\pi}}\exp(-{x^2\over2})
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#HH 패키지를 통한 역동적 그래프 그리기</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#표준 정규 분포</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">shiny=</span><span class="cn">TRUE</span>) </span></code></pre></div>
<div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mu = 100, sd = 5</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">100</span>, <span class="at">mean1=</span><span class="cn">NA</span>, <span class="at">xbar=</span><span class="cn">NA</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">125</span>),</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="at">sd=</span><span class="dv">5</span>, <span class="at">digits=</span><span class="dv">6</span>, <span class="at">zaxis=</span><span class="cn">TRUE</span>, <span class="at">cex.z=</span><span class="fl">0.6</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="at">cex.prob=</span>.<span class="dv">9</span>, <span class="at">shiny=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#평균이 다른 2개의 그래프 겹쳐그리기 mu1=8, mu2=8.411, sd=2</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">8</span>, <span class="at">mean1=</span><span class="fl">8.411</span>, <span class="at">sd=</span><span class="dv">2</span>, <span class="at">n=</span><span class="dv">64</span>, <span class="at">cex.prob=</span><span class="fl">1.3</span>,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="at">shiny=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#정규 분포 관련 R 함수 - 표준정규분포</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="fl">1.645</span>,<span class="at">m=</span><span class="dv">0</span>,<span class="at">s=</span><span class="dv">1</span>) <span class="co">#0.1031108 - dnorm(확률밀도함수)</span></span></code></pre></div>
<pre><code>## [1] 0.1031108</code></pre>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.645</span>,<span class="at">m=</span><span class="dv">0</span>,<span class="at">s=</span><span class="dv">1</span>) <span class="co">#0.9500151 - pnorm(누적확률함수)</span></span></code></pre></div>
<pre><code>## [1] 0.9500151</code></pre>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>,<span class="at">m=</span><span class="dv">0</span>,<span class="at">s=</span><span class="dv">1</span>) <span class="co">#1.644854 - qnorm(분위수함수)</span></span></code></pre></div>
<pre><code>## [1] 1.644854</code></pre>
</div>
<div id="the-students-t-distribution" class="section level3">
<h3>3.4.3 The (Student’s) t Distribution</h3>
<p>t분포는 모집단이 정규분포를 하더라도 분산 $ ^2 $이 알려져 있지 않고
표본의 수가 적은 경우에 평균 <span class="math inline">\(\mu\)</span>에
대한 신뢰구간 추정 및 가설검정에 유용하게 쓰이는 분포이다. t분포는
’모집단은 정규분포를 이룬다는 가정’이 있어 평균 = 0, 분산 = 1인
정규분포를 따른다. t분포 수식은 다음과 같다.</p>
<p><span class="math display">\[
\begin{aligned}
T &amp;= {\bar X - \mu\over s/\sqrt{n}}, t \sim t(n-1) \\
&amp;여기서, \bar X = 표본평균, \mu = 모평균, s/\sqrt{n} =표준오차,
n=자유도
\end{aligned}
\]</span> t분포는 표본크기 <span
class="math inline">\(n&gt;=30\)</span>이면 정규분포에 근사하게
된다.</p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#t 분포 관련 R 함수</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fl">8.5</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>s.xbar <span class="ot">&lt;-</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>s.xbar <span class="co">#0.4</span></span></code></pre></div>
<pre><code>## [1] 0.4</code></pre>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df=</span><span class="dv">24</span>) <span class="co">#2.063899 - qt(분위수함수)</span></span></code></pre></div>
<pre><code>## [1] 2.063899</code></pre>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fl">8.5</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> <span class="fl">2.064</span> <span class="sc">*</span> <span class="fl">0.4</span> <span class="co">#95% 신뢰구간[7.6744 9.3256]</span></span></code></pre></div>
<pre><code>## [1] 7.6744 9.3256</code></pre>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fig. 3.17 Confidence interval plot for the t distribution</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">xbar=</span><span class="fl">8.5</span>,<span class="at">sd=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">7.0</span>,<span class="dv">10</span>),<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.right=</span>.<span class="dv">025</span>,<span class="at">alpha.left=</span><span class="fl">0.025</span>,<span class="at">distribution.name=</span><span class="st">&quot;t&quot;</span>,<span class="at">n=</span><span class="dv">25</span>,<span class="at">df=</span><span class="dv">24</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-12-1.png" width="960" /></p>
</div>
</div>
<div id="estimation" class="section level2">
<h2>3.6 Estimation</h2>
<div id="criteria-for-point-estimators" class="section level3">
<h3>3.6.3 Criteria for Point Estimators</h3>
<p>좋은 추정량에 대한 조건이다.</p>
<ul>
<li>불편성(unbiasedness): 모수가 <span
class="math inline">\(\theta\)</span>이고, <span
class="math inline">\(\hat\theta\)</span>가 해당 추정량이라고 정의했을
때, <span class="math inline">\(E[\hat\theta]=\theta\)</span>를 만족할
경우 불편성을 만족한다고 한다.</li>
<li>일치성(consistency): 표본 크기 <span
class="math inline">\(n\)</span>이 증가함에 따라서 추정량이 불편성을
충족시키는 방향으로 움직이는 현상을 의미한다.</li>
<li>효율성(sufficiency, efficiency): 불편성을 만족시키는 두 개의
추정량이 있다고 가정했을 때, <span
class="math inline">\(E[\hat\theta_1]=\theta\)</span>, <span
class="math inline">\(E[\hat\theta_2]=\theta\)</span> 이 중에서
불확실성(분산)이 적은 추정량을 효율적 추정량이라고 한다. <span
class="math inline">\(Var[\hat\theta_1]&lt;Var[\hat\theta_2]\)</span>이라면
<span class="math inline">\(\hat\theta_1\)</span>이 효율적 추정량이
된다.</li>
</ul>
</div>
</div>
<div id="power-and-operating-characteristic-o.c.-beta-curves"
class="section level2">
<h2>3.9 Power and Operating Characteristic (O.C.) (Beta) Curves</h2>
<p>OC curve라고 불리는 검사특성곡선은 품질관리 부분에서 많이 사용된다.
품질을 관리할 때 LOT(로트)로부터 샘플링 검사를 하는 경우 어떤 불량율을
같는 LOT가 합격할 확률을 표현한 곡선을 말한다.</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#one-sample t-test를 사용한 OC곡선 작성</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>PowerT <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n=</span><span class="dv">12</span>, <span class="at">sd=</span><span class="dv">2</span>, <span class="at">delta=</span><span class="fl">1.4</span>,<span class="at">type=</span><span class="st">&quot;one.sample&quot;</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="at">alternative=</span><span class="st">&quot;one.sided&quot;</span>)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(PowerT, <span class="at">beta=</span><span class="cn">TRUE</span>, <span class="at">power=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-13-1.png" width="960" />
## 3.11 Sampling 샘플링 관련한 챕터이다.</p>
<div id="확률적-샘플링-종류" class="section level3">
<h3>확률적 샘플링 종류</h3>
<ul>
<li>3.11.1 Simple Random Sampling: 전체 <span
class="math inline">\(N\)</span>개의 모집단에서 <span
class="math inline">\(n\)</span>개의 표본을 랜덤으로 추출하는 방법으로
단순 무작위 추출법이라고 불린다. <span class="math inline">\(N \choose
n\)</span>으로 구성된 모든 부분집합들이 표본으로 선택될 확률이 같도록
설계된 표본추출방법이다.</li>
</ul>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sample(N, n)</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ex</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(x,<span class="dv">3</span>) <span class="co">#replace-복원추출여부 기본값은 FALSE</span></span></code></pre></div>
<pre><code>## [1] 6 1 8</code></pre>
<ul>
<li><p>3.11.2 Stratified Random Sampling: 층화추출법으로 모집단을 비슷한
성질을 갖는 2개 이상의 동질적인 층으로 구분하고, 각 층으로부터 단순
무작위 추출방법을 적용하여 표본을 추출하는 방법이다. ex)행정구역으로
나누어 각 행정구역에서 표본 추출</p></li>
<li><p>3.11.3 Cluster Random Sampling: 군집(집락)추출법으로 모집단을
여러 개의 군집으로 나눈 뒤 일부를 추출하여 추출된 군집에서 일부 또는
전부를 표본으로 추출하는 방법이다. ex) 행정구역 몇 개를 선정해 해당
데이터를 모두 사용</p></li>
<li><p>3.11.4 Systematic Random Sampling: 계통추출법으로 모집단의
목록표를 이용하여 최초의 표본단위만 무작위로 추출하고, 나머지는 일정한
간격(<span class="math inline">\(k\)</span>)을 두고 표본을 추출하는
방법이다. ex) 시계열 데이터의 대표값을 샘플링하는데 주로 이용</p></li>
</ul>
</div>
<div id="비확률적-샘플링-종류" class="section level3">
<h3>비확률적 샘플링 종류</h3>
<ul>
<li><p>Quota Sampling(할당표본추출법): 모집단이 여러 가지 특성으로
구성되어있는 경우 각 특성에 따라 층을 구성한 다음 층별 크기에 비례하여
표본을 배분하거나 동일한 크기의 표본을 조사원이 그 층 내에서 직접
선정하여 조사하는 방법</p></li>
<li><p>Snowball Sampling(눈덩이(표본)추출법): 눈덩이를 굴리면 커지는
것처럼 소수의 응답자를 찾은 다음 이들과 비슷한 사람들을 소개받아 가는
식으로 표본을 추출하는 방법</p></li>
<li><p>Purpose Sampling(판단추출법): 조사원이 자신의 지식과 경험에 의해
모집단을 가장 잘 대표한다고 여겨지는 표본을 주관적으로 판단하여 표본을
추출하는 방법</p></li>
<li><p>Convenience Sampling(편의추출법(임의추출법)): 모집단에 대한
정보가 전혀 없거나 모집단의 구성요소들 간의 차이가 별로 없다고 판단될 때
표본선정의 편리성에 기준을 두고 조사원이 마음대로 표본을 선정하는 방법
<br></p></li>
</ul>
<p><br></p>
</div>
</div>
</div>
<div id="chap4.-graphs" class="section level1">
<h1>Chap4. Graphs</h1>
<p>그래프는 데이터의 패턴을 감시하고 표시하는데 유용하게 쓰인다.
데이터를 이해하기에 가장 좋은 방법이라고 할 수 있다. 4장에서는 유용하게
쓰이는 다양한 그래프의 유형을 제시하고 설명한다. <em>lattice</em>
패키지를 이용해서 그래프의 디자인과 사용에 중점을 둔다. 또한
<em>ggplot2</em> 패키지도 함께 사용하여 다양한 시각화 기법을 익힌다.</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#사용 패키지 불러오기</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
<div id="what-is-a-graph" class="section level2">
<h2>4.1 What Is a Graph?</h2>
<p>그래프는 숫자 표의 정보를 기하학적으로 표현한 것이다. 해당 예제는
기본적인 <em>plot</em> 함수를 사용하여 그린 <span
class="math inline">\(x,y\)</span> 두 변수의 2차원 산점도이다. 주요
그래프 옵션은 다음과 같다.</p>
<ul>
<li>xlab, ylab: x축, y축 이름</li>
<li>main: 그래프 제목</li>
<li>pch: 점의 종류</li>
<li>cex: 점의 크기(기본값 = 1)</li>
<li>col: 색상</li>
<li>xlim, ylim: x축, y축 값의 범위</li>
<li>type: 그래프 유형, 점(p), 선(l), 점과 선 모두(b), 초기화(n) 등</li>
</ul>
<div class="sourceCode" id="cb124"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(njgolf) <span class="co">#데이터 로드 - HH 패키지</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(njgolf) <span class="co">#데이터 변수 확인</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    105 obs. of  115 variables:
##  $ index      : int  723702 745677 746177 747305 749516 750950 751122 754171 754261 754454 ...
##  $ lprice     : int  147600 179000 169900 69900 149900 159900 97900 159900 154500 103500 ...
##  $ oprice     : int  147600 179000 169900 81900 149900 159900 97900 159900 156900 91999 ...
##  $ sprice     : int  145000 175000 157000 68000 142000 144750 90200 154000 150000 96700 ...
##  $ grid       : Factor w/ 2 levels &quot;E19&quot;,&quot;E20&quot;: 2 1 2 2 2 1 2 1 2 2 ...
##  $ subsect    : Factor w/ 19 levels &quot;BIR&quot;,&quot;CON&quot;,&quot;CVI&quot;,..: 13 13 13 13 13 13 4 13 13 2 ...
##  $ taxes      : int  2398 2814 2520 1669 2573 2453 1898 5494 2398 2017 ...
##  $ taxyr      : int  91 91 91 91 91 92 91 91 91 91 ...
##  $ lotsize    : num  8970 9375 7920 0 10080 ...
##  $ primsch    : int  3 5 2 2 2 2 NA NA 2 3 ...
##  $ intsch     : int  3 5 2 1 2 2 NA NA 1 3 ...
##  $ highsch    : int  1 1 1 1 1 1 NA NA 1 1 ...
##  $ agent      : int  6 4 1 6 7 2 6 1 5 3 ...
##  $ floodp     : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ waterf     : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ age        : int  30 18 26 7 28 25 3 30 30 3 ...
##  $ stories    : num  2 2 2 1 2 2 1 2 2 3 ...
##  $ floor      : int  NA NA 3 NA NA 2 NA NA NA NA ...
##  $ style      : int  3 1 1 5 2 1 6 1 3 4 ...
##  $ firepl     : int  1 1 1 1 2 1 1 1 1 1 ...
##  $ basemt     : int  1 1 1 0 1 1 0 1 1 1 ...
##  $ pool       : int  0 0 0 0 0 0 0 1 0 0 ...
##  $ garage     : int  1 1 1 0 1 1 1 1 1 0 ...
##  $ allrms     : int  8 10 8 5 8 9 5 8 8 5 ...
##  $ beds       : int  4 5 4 2 3 4 2 4 4 1 ...
##  $ baths      : num  2.5 2.5 2.5 1.5 2.5 2.5 2 2.5 2.5 1.5 ...
##  $ lrarea     : int  338 240 312 221 336 286 240 299 338 154 ...
##  $ drarea     : int  132 180 156 72 108 143 72 156 143 80 ...
##  $ kitarea    : int  144 180 169 88 126 234 72 210 156 99 ...
##  $ famarea    : int  345 231 180 0 338 221 0 144 300 242 ...
##  $ den        : int  0 81 0 0 0 0 0 0 0 0 ...
##  $ study      : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ masarea    : int  182 204 225 165 180 168 192 210 210 224 ...
##  $ secarea    : int  110 156 144 81 121 120 126 121 156 0 ...
##  $ area3      : int  120 81 132 0 144 132 0 121 110 0 ...
##  $ area4      : int  128 165 168 0 0 110 0 195 128 0 ...
##  $ area5      : int  0 156 0 0 0 0 0 0 0 0 ...
##  $ range      : int  2 1 NA 2 2 1 2 2 1 2 ...
##  $ dwasher    : int  1 1 NA 1 1 1 0 1 0 1 ...
##  $ washer     : int  1 0 NA 1 1 1 1 1 0 1 ...
##  $ secsys     : int  0 0 NA 0 0 0 0 0 0 0 ...
##  $ micro      : int  0 0 NA 1 0 1 0 0 0 1 ...
##  $ rtop       : int  NA NA NA 2 NA 2 NA NA NA 2 ...
##  $ disposal   : int  0 1 NA 1 1 1 1 1 1 1 ...
##  $ dryer      : int  1 0 NA 1 1 1 1 1 0 1 ...
##  $ freezer    : int  0 0 NA 0 0 0 0 0 0 0 ...
##  $ compact    : int  0 0 NA 0 0 0 0 0 0 0 ...
##  $ walloven   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ refrig     : int  1 0 NA 1 1 1 1 1 0 1 ...
##  $ patio      : int  0 0 NA 0 0 0 0 0 0 0 ...
##  $ deck       : int  0 1 NA 1 0 0 1 1 0 0 ...
##  $ fence      : int  0 1 NA 0 0 0 1 1 0 1 ...
##  $ fuel       : int  0 0 NA 0 0 0 0 0 0 0 ...
##  $ ac         : int  1 1 1 2 1 1 1 1 1 1 ...
##  $ heat       : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ hwater     : int  1 1 1 2 1 1 1 1 1 1 ...
##  $ water      : int  1 1 NA 2 1 1 1 1 1 1 ...
##  $ sewer      : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ unknown    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ amps       : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ assvalue   : int  93000 109100 97700 64700 111400 95100 73600 232500 93000 78200 ...
##  $ cfee       : int  0 0 0 52 0 0 125 0 0 68 ...
##  $ golf       : int  0 0 1 0 1 0 0 0 0 1 ...
##  $ culdesac   : int  0 0 1 0 0 0 0 0 0 0 ...
##  $ unrate     : num  6.8 6.8 7.5 7 6.8 6.7 7 6.4 7 7.3 ...
##  $ greenmm    : int  12 NA 1 9 1 36 10 NA 21 4 ...
##  $ gatemm     : int  94 NA 70 16 63 167 20 NA 103 15 ...
##  $ lotsizef   : Factor w/ 4 levels &quot;house&quot;,&quot;con&quot;,..: 1 1 1 2 1 1 2 1 1 2 ...
##  $ own        : Factor w/ 4 levels &quot;con&quot;,&quot;house&quot;,..: 2 2 2 1 2 2 1 2 2 1 ...
##  $ gate       : num  0.2804 NA 0.2088 0.0477 0.1879 ...
##  $ green      : num  0.03579 NA 0.00298 0.02684 0.00298 ...
##  $ invgate    : num  3.57 NA 4.79 20.96 5.32 ...
##  $ linvgate   : num  1.27 NA 1.57 3.04 1.67 ...
##  $ invgate2   : num  12.7 NA 22.9 439.1 28.3 ...
##  $ loglp      : num  11.9 12.1 12 11.2 11.9 ...
##  $ logsp      : num  11.9 12.1 12 11.1 11.9 ...
##  $ loglot     : num  9.1 9.15 8.98 -Inf 9.22 ...
##  $ logage     : num  3.4 2.89 3.26 1.95 3.33 ...
##  $ logbeds    : num  1.386 1.609 1.386 0.693 1.099 ...
##  $ logbaths   : num  0.916 0.916 0.916 0.405 0.916 ...
##  $ logdra     : num  4.88 5.19 5.05 4.28 4.68 ...
##  $ logkita    : num  4.97 5.19 5.13 4.48 4.84 ...
##  $ logstor    : num  0.693 0.693 0.693 0 0.693 ...
##  $ lograte    : num  1.92 1.92 2.01 1.95 1.92 ...
##  $ sdate      : Date, format: &quot;1992-03-05&quot; &quot;1992-09-14&quot; ...
##  $ time.months: num  0.167 6.6 9.2 11.4 6.833 ...
##  $ logtime    : num  -1.79 1.89 2.22 2.43 1.92 ...
##  $ primf      : Factor w/ 3 levels &quot;other&quot;,&quot;2&quot;,&quot;3&quot;: 3 1 2 2 2 2 NA NA 2 3 ...
##   ..- attr(*, &quot;contrasts&quot;)= num [1:3, 1:2] 0 1 0 0 0 1
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:3] &quot;other&quot; &quot;2&quot; &quot;3&quot;
##   .. .. ..$ : chr [1:2] &quot;2&quot; &quot;3&quot;
##  $ stylef     : Factor w/ 3 levels &quot;colonial&quot;,&quot;condos&quot;,..: 3 1 1 2 3 1 2 1 3 2 ...
##  $ noappl     : num  -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 ...
##  $ logappl    : num  -2.3 -2.3 -2.3 -2.3 -2.3 ...
##  $ basemtf    : Factor w/ 3 levels &quot;fullbase&quot;,&quot;partbase&quot;,..: 2 2 2 1 2 2 1 2 2 2 ...
##  $ nobase     : Factor w/ 2 levels &quot;FALSE&quot;,&quot;TRUE&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ gar12      : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...
##  $ ldate      : Date, format: &quot;1991-09-02&quot; &quot;1992-04-14&quot; ...
##  $ exdate     : Date, format: &quot;1992-12-11&quot; &quot;1992-10-15&quot; ...
##  $ setdate    : Date, format: &quot;1992-11-20&quot; &quot;1992-11-30&quot; ...
##  $ listp      : num  466 184 286 380 365 386 349 187 304 540 ...
##  $ expdays    : num  281 31 61 99 239 46 99 61 158 232 ...
##   [list output truncated]</code></pre>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(dplyr) 내에 있는 with 함수를 사용하여 데이터명 사용 줄이기</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(njgolf, { </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="cn">NULL</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">25000</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50000</span>,<span class="dv">250000</span>), <span class="at">xlab=</span><span class="st">&quot;Lot Size&quot;</span>,</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;Single Family Homes&quot;</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(lotsize[lotsize<span class="sc">&gt;</span><span class="dv">0</span>],sprice[lotsize<span class="sc">&gt;</span><span class="dv">0</span>],<span class="at">pch=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(lotsize[lotsize<span class="sc">==</span><span class="dv">0</span>],sprice[lotsize<span class="sc">==</span><span class="dv">0</span>],<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;bottom&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Zero&quot;</span>, <span class="st">&quot;Positive&quot;</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-16-1.png" width="960" /></p>
<div id="pch---점의-종류" class="section level3">
<h3>pch - 점의 종류</h3>
<div class="sourceCode" id="cb127"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">example</span>(points) <span class="co">#실행하면 모든 점에 대한 그래프와 내용을 확인할 수 있음</span></span></code></pre></div>
<pre><code>## 
## points&gt; require(stats) # for rnorm
## 
## points&gt; plot(-4:4, -4:4, type = &quot;n&quot;)  # setting up coord. system</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-17-1.png" width="960" /></p>
<pre><code>## 
## points&gt; points(rnorm(200), rnorm(200), col = &quot;red&quot;)
## 
## points&gt; points(rnorm(100)/2, rnorm(100)/2, col = &quot;blue&quot;, cex = 1.5)
## 
## points&gt; op &lt;- par(bg = &quot;light blue&quot;)
## 
## points&gt; x &lt;- seq(0, 2*pi, length.out = 51)
## 
## points&gt; ## something &quot;between type=&#39;b&#39; and type=&#39;o&#39;&quot;:
## points&gt; plot(x, sin(x), type = &quot;o&quot;, pch = 21, bg = par(&quot;bg&quot;), col = &quot;blue&quot;, cex = .6,
## points+  main = &#39;plot(..., type=&quot;o&quot;, pch=21, bg=par(&quot;bg&quot;))&#39;)</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-17-2.png" width="960" /></p>
<pre><code>## 
## points&gt; par(op)
## 
## points&gt; ## Not run: 
## points&gt; ##D ## The figure was produced by calls like
## points&gt; ##D png(&quot;pch.png&quot;, height = 0.7, width = 7, res = 100, units = &quot;in&quot;)
## points&gt; ##D par(mar = rep(0,4))
## points&gt; ##D plot(c(-1, 26), 0:1, type = &quot;n&quot;, axes = FALSE)
## points&gt; ##D text(0:25, 0.6, 0:25, cex = 0.5)
## points&gt; ##D points(0:25, rep(0.3, 26), pch = 0:25, bg = &quot;grey&quot;)
## points&gt; ## End(Not run)
## points&gt; 
## points&gt; ##-------- Showing all the extra &amp; some char graphics symbols ---------
## points&gt; pchShow &lt;-
## points+   function(extras = c(&quot;*&quot;,&quot;.&quot;, &quot;o&quot;,&quot;O&quot;,&quot;0&quot;,&quot;+&quot;,&quot;-&quot;,&quot;|&quot;,&quot;%&quot;,&quot;#&quot;),
## points+            cex = 3, ## good for both .Device==&quot;postscript&quot; and &quot;x11&quot;
## points+            col = &quot;red3&quot;, bg = &quot;gold&quot;, coltext = &quot;brown&quot;, cextext = 1.2,
## points+            main = paste(&quot;plot symbols :  points (...  pch = *, cex =&quot;,
## points+                         cex,&quot;)&quot;))
## points+   {
## points+     nex &lt;- length(extras)
## points+     np  &lt;- 26 + nex
## points+     ipch &lt;- 0:(np-1)
## points+     k &lt;- floor(sqrt(np))
## points+     dd &lt;- c(-1,1)/2
## points+     rx &lt;- dd + range(ix &lt;- ipch %/% k)
## points+     ry &lt;- dd + range(iy &lt;- 3 + (k-1)- ipch %% k)
## points+     pch &lt;- as.list(ipch) # list with integers &amp; strings
## points+     if(nex &gt; 0) pch[26+ 1:nex] &lt;- as.list(extras)
## points+     plot(rx, ry, type = &quot;n&quot;, axes  =  FALSE, xlab = &quot;&quot;, ylab = &quot;&quot;, main = main)
## points+     abline(v = ix, h = iy, col = &quot;lightgray&quot;, lty = &quot;dotted&quot;)
## points+     for(i in 1:np) {
## points+       pc &lt;- pch[[i]]
## points+       ## &#39;col&#39; symbols with a &#39;bg&#39;-colored interior (where available) :
## points+       points(ix[i], iy[i], pch = pc, col = col, bg = bg, cex = cex)
## points+       if(cextext &gt; 0)
## points+           text(ix[i] - 0.3, iy[i], pc, col = coltext, cex = cextext)
## points+     }
## points+   }
## 
## points&gt; pchShow()</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-17-3.png" width="960" /></p>
<pre><code>## 
## points&gt; pchShow(c(&quot;o&quot;,&quot;O&quot;,&quot;0&quot;), cex = 2.5)</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-17-4.png" width="960" /></p>
<pre><code>## 
## points&gt; pchShow(NULL, cex = 4, cextext = 0, main = NULL)</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-17-5.png" width="960" /></p>
<pre><code>## 
## points&gt; ## No test: 
## points&gt; ##D ## ------------ test code for various pch specifications -------------
## points&gt; ##D # Try this in various font families (including Hershey)
## points&gt; ##D # and locales.  Use sign = -1 asserts we want Latin-1.
## points&gt; ##D # Standard cases in a MBCS locale will not plot the top half.
## points&gt; ##D TestChars &lt;- function(sign = 1, font = 1, ...)
## points&gt; ##D {
## points&gt; ##D    MB &lt;- l10n_info()$MBCS
## points&gt; ##D    r &lt;- if(font == 5) { sign &lt;- 1; c(32:126, 160:254)
## points&gt; ##D        } else if(MB) 32:126 else 32:255
## points&gt; ##D    if (sign == -1) r &lt;- c(32:126, 160:255)
## points&gt; ##D    par(pty = &quot;s&quot;)
## points&gt; ##D    plot(c(-1,16), c(-1,16), type = &quot;n&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;,
## points&gt; ##D         xaxs = &quot;i&quot;, yaxs = &quot;i&quot;,
## points&gt; ##D         main = sprintf(&quot;sign = %d, font = %d&quot;, sign, font))
## points&gt; ##D    grid(17, 17, lty = 1) ; mtext(paste(&quot;MBCS:&quot;, MB))
## points&gt; ##D    for(i in r) try(points(i%%16, i%/%16, pch = sign*i, font = font,...))
## points&gt; ##D }
## points&gt; ##D TestChars()
## points&gt; ##D try(TestChars(sign = -1))
## points&gt; ##D TestChars(font = 5)  # Euro might be at 160 (0+10*16).
## points&gt; ##D                      # macOS has apple at 240 (0+15*16).
## points&gt; ##D try(TestChars(-1, font = 2))  # bold
## points&gt; ## End(No test)
## points&gt; 
## points&gt;</code></pre>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#해당 코드로 점의 종류(pch)의 모양과 값을 확인할 수 있음</span></span></code></pre></div>
</div>
<div id="lattice-패키지의-xyplot-사용" class="section level3">
<h3>lattice 패키지의 xyplot 사용</h3>
<p>lattice 패키지에서 제공하는 <em>xyplot()</em> 함수를 사용하면 조건부
그래프도 쉽게 그릴 수 있다는 것이 장점이다. xyplot(y~x) 형식이
기본이다.</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ifelse 함수를 사용하여 그룹 나누기</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>njgolf<span class="sc">$</span>leg <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(njgolf<span class="sc">$</span>lotsize<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;Zero&quot;</span>,<span class="st">&quot;Positive&quot;</span>) </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co">#groups - 그룹 지정, auto.key - 범례 여부(자동으로 위치 지정)</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(njgolf, {</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xyplot</span>(sprice<span class="sc">~</span>lotsize,<span class="at">xlab=</span><span class="st">&quot;Lot Size&quot;</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;Single Family Homes&quot;</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups=</span>leg, <span class="at">auto.key =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-18-1.png" width="960" /></p>
</div>
<div id="ggplot2-패키지-사용" class="section level3">
<h3>ggplot2 패키지 사용</h3>
<p><em>ggplot2</em> 패키지는 현재 R의 시각화 패키지 중 가장 많이 쓰이는
패키지로 기본 틀만 작성해놓으면 간단하고 다양하게 시각화를 할 수 있다는
장점이 있다.</p>
<p><em>ggplot()</em> 함수를 사용하여 기본 틀을 작성한다고 생각하면 된다.
이후 + 기호를 덧붙여 <em>geom_point(산점도)</em>, <em>geom_line(선)
</em>등 새로운 레이어들을 추가시켜 다양하게 작업할 수 있다.</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggplot2)</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(njgolf, <span class="fu">aes</span>(<span class="at">x=</span>lotsize, <span class="at">y=</span>sprice, <span class="at">shape=</span>leg)) <span class="sc">+</span> <span class="co">#기본 틀: x축, y축, 모양 변수</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>leg)) <span class="sc">+</span> <span class="co">#색깔 변수</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Single Family Homes&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Lot Size&quot;</span>, <span class="at">y=</span><span class="st">&quot;Selling Price&quot;</span>)<span class="sc">+</span> <span class="co">#제목, xlab, ylab 설정</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name=</span><span class="st">&quot;leg&quot;</span>) <span class="co">#범례 제목 추가(shape-모양으로 구분, color-색깔로 구분)</span></span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-19-1.png" width="960" /></p>
</div>
</div>
<div id="scatterplots" class="section level2">
<h2>4.3 Scatterplots</h2>
<p>산점도(scatter plots)는 한 변수 로트 크기가 x축(수평축 또는 축)에
있고 다른 변수 스프라이스가 y축(수직축 또는 좌표)에 있는 일반 2차원
그림입니다.</p>
<p>해당 예제는 1992년 3월부터 1994년 9월까지 뉴저지주 마운트 로렐에 있는
105개 단독주택의 침실 수, 식당 면적 및 주방 면적별 판매 가격에 대한
산점도이다.</p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(njgolf, {</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span> <span class="fu">xyplot</span>(sprice<span class="sc">~</span>beds,<span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;beds&quot;</span>, </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">groups=</span>leg)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span> <span class="fu">xyplot</span>(sprice<span class="sc">~</span>drarea,<span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;Dining Room Area&quot;</span>, </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">groups=</span>leg)</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span> <span class="fu">xyplot</span>(sprice<span class="sc">~</span>kitarea,<span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;Kitchen Area&quot;</span>, </span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">groups=</span>leg)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.arrange</span>(a,b,c, <span class="at">nrow=</span><span class="dv">1</span>) <span class="co">#library(gridExtra)</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-20-1.png" width="960" /></p>
<div id="ggplot2-패키지-사용-1" class="section level3">
<h3>ggplot2 패키지 사용</h3>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">#전체적인 틀 만들기(공통적인 부분)</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(njgolf, <span class="fu">aes</span>(<span class="at">y=</span>sprice, <span class="at">color=</span>leg))<span class="sc">+</span> </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> <span class="fu">scale_color_discrete</span>(<span class="at">name=</span><span class="st">&quot;Lot Size&quot;</span>) <span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">guide=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co">#하나씩 x축 데이터 값 및 title 지정</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>beds, <span class="at">shape=</span>leg)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;beds&quot;</span>)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>drarea, <span class="at">shape=</span>leg)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Dining Room Area&quot;</span>)</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>kitarea, <span class="at">shape=</span>leg)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Kitchen Area&quot;</span>)</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co">#한꺼번에 그리기(top=textGrop으로 전체 title 지정)</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1, g2, g3, <span class="at">ncol=</span><span class="dv">3</span>,<span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">&quot;Measures of Dwelling Size&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-21-1.png" width="960" /></p>
</div>
</div>
<div id="scatterplot-matrix" class="section level2">
<h2>4.4 Scatterplot Matrix</h2>
<p>산점도 행렬(Scatter Plot Matrix)은 다변량 데이터에서 변수 쌍 간의
산점도들을 그린 그래프를 말한다. 산점도 행렬을 사용하면 여러 변수가 있을
때 모든 변수 간 산점도를 손쉽게 그릴 수 있고, 이를 들여다보면 변수들 간
상관관계 등의 특징을 쉽게 찾을 수 있다. <em>xyplot</em> 함수는 조건부
plot을 그리기 유용한다. 해당 예제는 lot size 별 산점도이다.</p>
<div class="sourceCode" id="cb141"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#layout - 추출시 행, 열 지정(열,행 순서)</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(njgolf, {</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span> <span class="fu">xyplot</span>(sprice<span class="sc">~</span>beds<span class="sc">|</span>leg,<span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;beds&quot;</span>, </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">groups=</span>leg, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span> <span class="fu">xyplot</span>(sprice<span class="sc">~</span>drarea<span class="sc">|</span>leg,<span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;Dining Room Area&quot;</span>, </span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">groups=</span>leg, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span> <span class="fu">xyplot</span>(sprice<span class="sc">~</span>kitarea<span class="sc">|</span>leg,<span class="at">ylab=</span><span class="st">&quot;Selling Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;Kitchen Area&quot;</span>, </span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">groups=</span>leg, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.arrange</span>(a,b,c, <span class="at">nrow=</span><span class="dv">1</span>) </span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-22-1.png" width="960" /></p>
<div id="ggplot2-패키지-사용-2" class="section level3">
<h3>ggplot2 패키지 사용</h3>
<p><em>ggplot2</em> 패키지를 통해 조건부 그래프를 그리기 위해서는
<em>facet</em> 함수를 사용하면 된다.</p>
<ul>
<li>facet_wrap(~factor, ncol=nc, nrow=nr): factor값에 따라 sub그래프
그려줌</li>
<li>facet_grid(factor1~factor2): factor1 level을 행, factor2 level을
열로 하여 격자로 sub그래프를 그려줌</li>
</ul>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#전체적인 틀 만들기(공통적인 부분)</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(njgolf, <span class="fu">aes</span>(<span class="at">y=</span>sprice, <span class="at">color=</span>leg))<span class="sc">+</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> <span class="fu">scale_color_discrete</span>(<span class="at">name=</span><span class="st">&quot;Lot Size&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">guide=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>leg, <span class="at">ncol=</span><span class="dv">1</span>) <span class="co">#조건 변수 지정 및 행,열 설정</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">#하나씩 x축 데이터 값 및 title 지정</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>beds, <span class="at">shape=</span>leg)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;beds&quot;</span>)</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>drarea, <span class="at">shape=</span>leg)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Dining Room Area&quot;</span>)</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>kitarea, <span class="at">shape=</span>leg)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Kitchen Area&quot;</span>)</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">#한꺼번에 그리기(top=textGrop으로 전체 title 지정)</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1, g2, g3, <span class="at">ncol=</span><span class="dv">3</span>,<span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">&quot;Measures of Dwelling Size&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-23-1.png" width="960" /></p>
</div>
<div id="그림-4.5-구현" class="section level3">
<h3>그림 4.5 구현</h3>
<p>다차원 데이터에 대한 산점도를 그리는 방법은 다양하다. R에서 기본으로
제공하는 <em>pairs</em> 함수를 사용하면 원하는 변수들만 사용해서 다차원
산점도를 작성할 수 있다.</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="sc">~</span>sprice<span class="sc">+</span>lotsize<span class="sc">+</span>beds<span class="sc">+</span>drarea<span class="sc">+</span>kitarea<span class="sc">+</span>cfee,<span class="at">data=</span>njgolf)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-24-1.png" width="960" /></p>
</div>
<div id="lattice-패키지의-splom-함수-사용" class="section level3">
<h3>lattice 패키지의 splom 함수 사용</h3>
<p><em>splom</em> 함수는 <em>xyplot</em>과 비슷하며 조건부 산점도 행렬을
그릴 때 주로 사용된다. 형식(~변수|조건 변수)을 지정해주고 그룹 및 색상
등 추가로 옵션을 지정한다. group을 지정해주면 해당 그룹 별 색상이나
모양을 다르게 할 수 있다.</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select - dplyr 패키지 내에 있는 함수로 필요한 변수만 선택할 때 사용된다.</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co">#%&gt;% - dplyr 패키지 내에 있는 함수로 파이프라인이라고 불리며 순서대로 작업이 진행될 때 사용되며  코드의 가독성을 높여주는 장점이 있다. </span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co">#::를 사용하는 이유는 패키지마다 겹치는 함수 이름이 있기 때문에 dplyr 패키지 내의 select 함수를 정확하게 사용하기 위함이다.</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> njgolf <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(sprice,lotsize,beds,drarea,kitarea))</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>dat, <span class="at">data=</span>njgolf, <span class="at">group =</span> leg, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">varname.cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-25-1.png" width="960" /></p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#key 옵션에서 title이나 각 조건 그래프 별 제목 등을 설정할 수 있다.</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(<span class="sc">~</span>dat<span class="sc">|</span>leg, <span class="at">data=</span>njgolf, <span class="at">group =</span> leg,</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">varname.cex=</span><span class="fl">0.7</span>,</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">key =</span> <span class="fu">list</span>(<span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Positive&quot;</span>,<span class="st">&quot;zero&quot;</span>)),</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>))))</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-25-2.png" width="960" /></p>
</div>
<div id="ggplot2-패키지-확장-패키지-ggally-사용" class="section level3">
<h3>ggplot2 패키지 확장 패키지 GGally 사용</h3>
<p>다변량 산점도 행렬은 <em>ggplot2</em> 패키지의 확장 패키지인
<em>GGally</em> 패키지의 <em>ggpairs()</em> 함수로 그릴 수 있다. 해당
함수는 산점도와 상관계수, 히스토그램까지 확인할 수 있다.</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(GGally)</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co">#aes 설정으로 조건 변수 설정</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(dat, <span class="fu">aes</span>(<span class="at">color=</span>njgolf<span class="sc">$</span>leg)) </span></code></pre></div>
<pre><code>## Warning in cor(x, y): 표준편차가 0입니다</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 6 rows containing missing values</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 9 rows containing missing values</code></pre>
<pre><code>## Warning in cor(x, y): 표준편차가 0입니다</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 6 rows containing missing values</code></pre>
<pre><code>## Warning in cor(x, y): 표준편차가 0입니다</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 9 rows containing missing values</code></pre>
<pre><code>## Warning in cor(x, y): 표준편차가 0입니다</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 6 rows containing missing values</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 9 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values (`geom_point()`).
## Removed 6 rows containing missing values (`geom_point()`).
## Removed 6 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 6 rows containing non-finite values (`stat_density()`).</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 13 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (`geom_point()`).
## Removed 9 rows containing missing values (`geom_point()`).
## Removed 9 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 13 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 9 rows containing non-finite values (`stat_density()`).</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-26-1.png" width="960" /></p>
</div>
</div>
<div id="examplelife-expectancy" class="section level2">
<h2>4.6 Example—Life Expectancy</h2>
<p>data(tv)를 사용하여 기대 수명에 관한 시각화를 다양하게 진행한다. 변수
설명은 아래와 같다.</p>
<ul>
<li>life.exp: 출생시 기대수명</li>
<li>ppl.per.tv: Tv 1대당 인원 수</li>
<li>ppl.per.phys: 의사 당 인원 수</li>
<li>fem.life.exp: 출생 시 여성 기대 수명</li>
<li>male.life.exp: 출생 시 남성 기대 수명</li>
</ul>
<div class="sourceCode" id="cb165"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 불러오기</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tv)</span></code></pre></div>
</div>
<div id="scatterplot-matricescontinued" class="section level2">
<h2>4.7 Scatterplot Matrices—Continued</h2>
<p>국가 별 여성 평균 수명과 남성의 평균 수명을 산점도로 비교한다. plot
함수를 사용할 때에는 <em>abline</em> 함수를 사용하면 y=ax+b 형태의
직선을 그릴 수 있다.</p>
<div class="sourceCode" id="cb166"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 4.8</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co">#y=1의 직선을 추가</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co">#text 함수로 해당 좌표 값 표시</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>mi <span class="ot">&lt;-</span> <span class="fu">which.max</span>(tv<span class="sc">$</span>male.life.exp) <span class="co">#최대값 찾기</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>tv<span class="sc">$</span>fem.life.exp[mi] <span class="co">#남자 기대수명 최대값 인덱스를 사용한 여자 기대수명 값 찾기</span></span></code></pre></div>
<pre><code>## [1] 82</code></pre>
<div class="sourceCode" id="cb168"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tv, {</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(fem.life.exp, male.life.exp, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>),</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Femlae&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Male&quot;</span>,<span class="at">main=</span><span class="st">&quot;Life Expectancy&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(fem.life.exp[mi], male.life.exp[mi], <span class="at">labels =</span><span class="st">&quot;(82,76)&quot;</span>, <span class="at">pos=</span><span class="dv">4</span>) </span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-28-1.png" width="960" /></p>
<div id="ggplot2-패키지-사용-3" class="section level3">
<h3>ggplot2 패키지 사용</h3>
<div class="sourceCode" id="cb169"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tv, <span class="fu">aes</span>(<span class="at">x=</span>fem.life.exp, <span class="at">y=</span>male.life.exp)) <span class="co">#기본 틀</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> <span class="co">#abline과 같은 기능</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">83</span>, <span class="at">y=</span><span class="dv">76</span>, <span class="at">label=</span><span class="st">&quot;(82,76)&quot;</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> <span class="co">#text 추가 기능</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>)) <span class="co">#xlim, ylim 조정 함수</span></span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-29-1.png" width="960" /></p>
</div>
<div id="그림-4.9---산점도-다양하게-그리기" class="section level3">
<h3>그림 4.9 - 산점도 다양하게 그리기</h3>
<div class="sourceCode" id="cb170"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot 사용</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co">#a. text 값으로 표시</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tv, {</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(male.life.exp <span class="sc">~</span> fem.life.exp, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>),<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="st">&quot;a. abbreviated names&quot;</span>, <span class="at">cex=</span>.<span class="dv">8</span>)</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">y=</span>male.life.exp, <span class="at">x=</span>fem.life.exp, <span class="fu">abbreviate</span>(<span class="fu">row.names</span>(tv)), </span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span>.<span class="dv">8</span>, <span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-30-1.png" width="960" /></p>
<div class="sourceCode" id="cb171"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co">#b. 특정 데이터 표시</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tv, {</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(male.life.exp <span class="sc">~</span> fem.life.exp, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>),<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">y=</span>male.life.exp, <span class="at">x=</span>fem.life.exp, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span>.<span class="dv">6</span>,<span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="st">&quot;b. simulated interactive&quot;</span>, <span class="at">cex=</span>.<span class="dv">8</span>)</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">y=</span>tv<span class="sc">$</span>male.life.exp[<span class="dv">2</span>], <span class="at">x=</span>tv<span class="sc">$</span>fem.life.exp[<span class="dv">2</span>], <span class="fu">row.names</span>(tv)[<span class="dv">2</span>], <span class="at">cex=</span>.<span class="dv">8</span>, <span class="at">adj=</span><span class="dv">1</span>)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-30-2.png" width="960" /></p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#c. x,y 범위 안 맞추기</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tv, {</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(male.life.exp <span class="sc">~</span> fem.life.exp, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">y=</span>male.life.exp, <span class="at">x=</span>fem.life.exp, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span>.<span class="dv">6</span>,<span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="st">&quot;c. square, unequal scale&quot;</span>, <span class="at">cex=</span>.<span class="dv">8</span>)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-30-3.png" width="960" /></p>
<div class="sourceCode" id="cb173"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#d. c그림에 abline 추가</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tv, {</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(male.life.exp <span class="sc">~</span> fem.life.exp, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">y=</span>male.life.exp, <span class="at">x=</span>fem.life.exp, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span>.<span class="dv">6</span>,<span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="st">&quot;d. x=y line, square, unequal scale&quot;</span>, <span class="at">cex=</span>.<span class="dv">8</span>)</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-30-4.png" width="960" /></p>
<div class="sourceCode" id="cb174"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#e. 회귀선 추가 - lm 함수 사용(y~x)</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tv, {</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(male.life.exp <span class="sc">~</span> fem.life.exp, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">1</span>,</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">85</span>))</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">y=</span>male.life.exp, <span class="at">x=</span>fem.life.exp, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span>.<span class="dv">6</span>,<span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="st">&quot;e. same xlim and ylim, unequal scale,</span><span class="sc">\n</span><span class="st">least squares line&quot;</span>, <span class="at">cex=</span>.<span class="dv">8</span>)</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(male.life.exp <span class="sc">~</span> fem.life.exp), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-30-5.png" width="960" /></p>
</div>
<div id="ggplot2-패키지-사용-4" class="section level3">
<h3>ggplot2 패키지 사용</h3>
<div class="sourceCode" id="cb175"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a </span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tv, <span class="fu">aes</span>(<span class="at">x=</span>fem.life.exp, <span class="at">y=</span>male.life.exp)) <span class="co">#기본 틀</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">rownames</span>(tv)), <span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;a. abbreviated names&quot;</span>) <span class="sc">+</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>)) <span class="co">#xlim, ylim 조정 함수</span></span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-31-1.png" width="960" /></p>
<div class="sourceCode" id="cb176"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#b</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span>tv<span class="sc">$</span>male.life.exp[<span class="dv">2</span>], <span class="at">y=</span>tv<span class="sc">$</span>fem.life.exp[<span class="dv">2</span>],</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">rownames</span>(tv)[<span class="dv">2</span>], <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;b. simulated interactive&quot;</span>) <span class="sc">+</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>)) </span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-31-2.png" width="960" /></p>
<div class="sourceCode" id="cb177"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#c</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;c. square, unequal scale&quot;</span>) </span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-31-3.png" width="960" /></p>
<div class="sourceCode" id="cb178"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co">#d</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;d. x=y line, square, unequal scale&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-31-4.png" width="960" /></p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#e</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="co">#회귀선 추가 코드</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">&quot;smooth&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;e. same xlim and ylim, unequal scale,</span><span class="sc">\n</span><span class="st">least squares line&quot;</span>) <span class="sc">+</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">85</span>)) </span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-31-5.png" width="960" /></p>
</div>
<div id="그림-4.10-산점도-행렬-구현---pairs-splom-함수"
class="section level3">
<h3>그림 4.10 산점도 행렬 구현 - pairs &amp; splom 함수</h3>
<div class="sourceCode" id="cb180"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pairs 함수</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dat &lt;- tv[,c(4,5,1,2,3)]와 같은 결과 - 파이프라인 사용</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> tv <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(fem.life.exp, male.life.exp, life.exp, ppl.per.tv, ppl.per.phys)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dat)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-32-1.png" width="960" /></p>
<div class="sourceCode" id="cb181"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#splom 함수</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>( <span class="sc">~</span> dat,</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">list</span>(<span class="st">&quot;Televisions, Physicians, and Life Expectancy&quot;</span>, <span class="at">cex=</span><span class="fl">1.4</span>),</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.cex=</span>.<span class="dv">5</span>,<span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex=</span>.<span class="dv">7</span>, <span class="at">varname.cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-32-2.png" width="960" /></p>
</div>
<div id="ggplot2-패키지-사용-5" class="section level3">
<h3>ggplot2 패키지 사용</h3>
<div class="sourceCode" id="cb182"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(GGally)</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co">#aes 설정으로 조건 변수 설정</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(dat) </span></code></pre></div>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 2 rows containing missing values

## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 2 rows containing missing values

## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 2 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (`geom_point()`).
## Removed 2 rows containing missing values (`geom_point()`).
## Removed 2 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (`stat_density()`).</code></pre>
<pre><code>## Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
## Removed 2 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-33-1.png" width="960" /></p>
</div>
</div>
<div id="data-transformations" class="section level2">
<h2>4.8 Data Transformations</h2>
<p>데이터를 올바르게 탐색하고 이해하기 위해서 데이터를 변환(재표현)해야
하는 경우에 사용하는 방법들을 소개한다.</p>
<p>아래 그림 4.14의 산점도 행렬을 보면 <code>life.exp</code> 변수와
<code>ppl.per.tv</code>, <code>ppl.per.phys</code> 변수의 관계에서 L자
모양의 패턴이 보이는데 이는 자료의 분포가 한쪽으로 기울어졌다는 의미이기
때문에 올바른 추론을 위해 <em>log</em> 변환을 시행한다. 해당 장에서는
주로 비대칭성 자료에 대한 변환(재표현)을 다룬다.</p>
<div class="sourceCode" id="cb188"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 4.14</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>tv <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(life.exp, ppl.per.tv, ppl.per.phys) <span class="sc">%&gt;%</span> <span class="fu">splom</span>(</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="fu">list</span>(<span class="st">&quot;Televisions, Physicians, and Life Expectancy&quot;</span>, <span class="at">cex=</span><span class="fl">1.4</span>),</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-34-1.png" width="960" /></p>
<div class="sourceCode" id="cb189"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 4.15 - log 변환 후 산점도 행렬</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>tv <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">logtv =</span> <span class="fu">log</span>(ppl.per.tv), <span class="at">logphys =</span> <span class="fu">log</span>(ppl.per.phys)) <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(life.exp, logtv, logphys) <span class="sc">%&gt;%</span> </span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">splom</span>(<span class="at">main=</span><span class="fu">list</span>(<span class="st">&quot;Televisions, Physicians, and Life Expectancy&quot;</span>, <span class="at">cex=</span><span class="fl">1.4</span>),</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-34-2.png" width="960" /></p>
<p>자료의 변형(재표현)을 하는 목적은 비선형적인 변수 간의 관계를
선형적으로, 조금 더 알아보기 쉽게 하기 위함이다. 이때, <em>변환의
사다리(ladder of transforms)</em> 방법을 많이 사용하는데 이는 <span
class="math inline">\(x\)</span> 를 <span
class="math inline">\(f(x)\)</span>로 변환시키는 것으로 함수 <span
class="math inline">\(f()\)</span>는 단조함수(꾸준히 증가하거나 꾸준히
감소하는 함수)만이 변환시키는 함수로서 가치가 있다고 한다. 이 방법은
자료 분석에서 가장 많이 활용되는 변환 방법이고 거듭 곱(power, 멱승)형의
변환이 이루어 진다. Box-Cox 변환으로 알려져 있는 식은 다음과 같다.</p>
<p><span class="math display">\[
y =
\begin{cases}
x^p, p&gt;0\\
log(x), p=0\\
-x^p, p&lt;0
\end{cases}
\]</span> <span class="math inline">\(p=1\)</span>(무변환)을 기준으로
사다리를 오르락 내리락하면서 변환하는 방법이다.</p>
</div>
<div id="life-expectancy-examplecontinued" class="section level2">
<h2>4.9 Life Expectancy Example—Continued</h2>
<p>해당 장에서는 4.8에서 언급했던 자료의 변환(재표현)을 사용하여
시각화를 진행한다. <em>HH</em> 패키지에서 제공하는 <em>ladder</em>
함수로 <span class="math inline">\(p\)</span> 값의 변화에 따른
<code>life.exp</code>와 <code>ppl.per.phys</code> 변수 간의 관계를
확인한다.</p>
<div class="sourceCode" id="cb190"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 4.17</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ladder</span>(life.exp <span class="sc">~</span> ppl.per.phys, <span class="at">data=</span>tv,</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Ladder of Powers for Life Expectancy and People per Physician&quot;</span>,</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="dv">1</span>), <span class="co">#그림 내 텍스트 크기</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">dsx=</span><span class="st">&quot;ppp&quot;</span>, <span class="at">dsy=</span><span class="st">&quot;le&quot;</span>) <span class="co">#각 행과 열 이름인 xlab, ylab 지정</span></span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-35-1.png" width="960" /></p>
<p>또한 <em>lattice</em> 패키지 내에 있는 <em>bwplot</em> 함수를
사용하면 기본 r에서 제공하는 boxplot보다 더 부드러운 그림을 그릴 수
있다. 또한 그룹 별 boxplot을 그리는 것도 가능하다. 아래 그림은
<em>ladder.f</em> 혹은 <em>ladder.fstar</em> 함수를 이용하여
<code>ppl.per.phys</code>가 <span class="math inline">\(p\)</span> 값이
변함에 따라 분포가 어떻게 변화하는지 boxplot을 그려 확인한다.</p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(tv[,<span class="st">&quot;ppl.per.phys&quot;</span>])</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ladder.f</span>(x) <span class="co">#변환의 사다리 적용</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co">#그룹 생성</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;ppp ^&quot;</span>,<span class="fu">names</span>(y))</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ordered</span>(g, g) <span class="co">#순서형 변수로 변환</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g[<span class="fu">col</span>(<span class="fu">as.matrix</span>(y))]</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> y</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>gg[] <span class="ot">&lt;-</span> <span class="st">&#39;&#39;</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot 그리기</span></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(<span class="fu">unlist</span>(y) <span class="sc">~</span> <span class="fu">unlist</span>(gg) <span class="sc">|</span> g, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">1</span>), <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">horizontal=</span><span class="cn">FALSE</span>,</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">list</span>(<span class="st">&quot;ppl.per.phys_boxplots&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>),</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="dv">1</span>),</span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">&quot;free&quot;</span>, <span class="at">cex=</span>.<span class="dv">8</span>))</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-36-1.png" width="960" /></p>
</div>
<div id="color-vision" class="section level2">
<h2>4.10 Color Vision</h2>
<p>R에서는 다양한 시각화 기능이 지원되는만큼 color와 관련된 패키지가
많다. 해당 책에서는 <em>RColorBrewer</em> 패키지를 통해 다양한 색깔을
보여준다.</p>
<div class="sourceCode" id="cb192"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co">#패키지에 내재된 모든 색상의 파레트 출력</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>(<span class="at">n=</span><span class="dv">10</span>,<span class="at">exact.n=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-37-1.png" width="960" /></p>
<div class="sourceCode" id="cb193"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각각의 파레트에 대한 색상정보 확인</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>brewer.pal.info</span></code></pre></div>
<pre><code>##          maxcolors category colorblind
## BrBG            11      div       TRUE
## PiYG            11      div       TRUE
## PRGn            11      div       TRUE
## PuOr            11      div       TRUE
## RdBu            11      div       TRUE
## RdGy            11      div      FALSE
## RdYlBu          11      div       TRUE
## RdYlGn          11      div      FALSE
## Spectral        11      div      FALSE
## Accent           8     qual      FALSE
## Dark2            8     qual       TRUE
## Paired          12     qual       TRUE
## Pastel1          9     qual      FALSE
## Pastel2          8     qual      FALSE
## Set1             9     qual      FALSE
## Set2             8     qual       TRUE
## Set3            12     qual      FALSE
## Blues            9      seq       TRUE
## BuGn             9      seq       TRUE
## BuPu             9      seq       TRUE
## GnBu             9      seq       TRUE
## Greens           9      seq       TRUE
## Greys            9      seq       TRUE
## Oranges          9      seq       TRUE
## OrRd             9      seq       TRUE
## PuBu             9      seq       TRUE
## PuBuGn           9      seq       TRUE
## PuRd             9      seq       TRUE
## Purples          9      seq       TRUE
## RdPu             9      seq       TRUE
## Reds             9      seq       TRUE
## YlGn             9      seq       TRUE
## YlGnBu           9      seq       TRUE
## YlOrBr           9      seq       TRUE
## YlOrRd           9      seq       TRUE</code></pre>
<div class="sourceCode" id="cb195"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co">#사용된 정확한 색상을 확인할 수 있다. </span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>) <span class="co">#개수, 원하는 색상</span></span></code></pre></div>
<pre><code>## [1] &quot;#F7FCF5&quot; &quot;#E5F5E0&quot; &quot;#C7E9C0&quot; &quot;#A1D99B&quot; &quot;#74C476&quot; &quot;#41AB5D&quot; &quot;#238B45&quot;
## [8] &quot;#006D2C&quot; &quot;#00441B&quot;</code></pre>
<div class="sourceCode" id="cb197"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#얻은 색상 정보로 위의 예제 그림 색상 변환해보기 - #A1D99B</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ladder</span>(life.exp <span class="sc">~</span> ppl.per.phys, <span class="at">data=</span>tv,</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;Ladder of Powers for Life Expectancy and People per Physician&quot;</span>,</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="dv">1</span>),</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">dsx=</span><span class="st">&quot;ppp&quot;</span>, <span class="at">dsy=</span><span class="st">&quot;le&quot;</span>, <span class="at">col=</span><span class="st">&quot;#A1D99B&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-37-2.png" width="960" /></p>
<p><br></p>
<p><br></p>
</div>
</div>
<div id="chap5.-introductory-inference" class="section level1">
<h1>Chap5. Introductory Inference</h1>
<p>해당 챕터에서는 통계적 추론과 관련한 내용을 다루며 다양한 예제를 통해
신뢰구간과 가설검정을 실습하고 진행한다. 3장에서 다루었던
<em>NTplot</em>함수를 통해 신뢰구간 시각화를 진행한다.</p>
<div class="sourceCode" id="cb198"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co">#사용 패키지 불러오기</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span></code></pre></div>
<div id="normal-z-intervals-and-tests" class="section level2">
<h2>5.1 Normal (z) Intervals and Tests</h2>
<p>정규분포 그 중에서도 표준 정규분포에 대한 신뢰구간과 가설 검정을
진행한다. 해당 책에서는 <em>HH</em> 패키지에서 제공하는 <em>NTplot</em>
함수를 사용하여 정규분포 및 t분포에 대한 검정과 신뢰 구간을 나타내는
그림을 그린다. 해당 함수는 기각역, 신뢰구간 등 가설검정에 대한 다양한
시각화를 진행하기 좋다.</p>
<p><code>NTplot</code> 함수의 다양한 옵션을 지정할 수 있다.</p>
<ul>
<li><em>mean0</em>: 모평균의 값</li>
<li><em>xbar</em>: 표본평균의 값<br />
</li>
<li><em>sd</em>: 모표준편차의 값, 표본의 크기(n)를 설정하면 자동으로
표준오차 계산</li>
<li><em>n</em>: 표본의 크기</li>
<li><em>alpha.right</em>: 우측의 유의수준<br />
</li>
<li><em>alpha.left</em>: 좌측의 유의수준<br />
</li>
<li>만약 alpha.left, alpha.right를 동시에 설정하면 좌측검정, 우측검정의
결과값을 동시에 보여준다.<br />
</li>
<li><em>distribution.name</em>: 분포의 형태(normal, z,t,binomial)<br />
</li>
<li><code>type = "confidence"</code>:신뢰구간의 하한 상한 계산</li>
<li><code>shiny = TRUE</code>: 모델의 파라미터를 변경에 따른 검정과
신뢰구간의 변화가 나타남</li>
</ul>
<div
id="test-of-a-hypothesis-concerning-the-mean-of-a-population-having-known-standard-deviation"
class="section level3">
<h3>5.1.1 Test of a Hypothesis Concerning the Mean of a Population
Having Known Standard Deviation</h3>
<p>모집단의 표준 편차 <span class="math inline">\(\sigma\)</span> 가
알려진 경우 모집단의 평균에 관한 가설 검정과 구간 추정을 시각화한다.</p>
<p>이때, <span class="math inline">\(\sigma_{\overline{y}} =
\frac{\sigma}{\sqrt{n}}\)</span>이고, <span
class="math inline">\(z_{cale} = \frac{\overline{y} - \mu_0}
{\sigma_{\overline{y}}}\)</span>이다. 아래는 각 검정의 신뢰구간을
나타내었다.</p>
<ul>
<li>우측검정: <span class="math inline">\((\overline{y} -
z_{\alpha}\frac{\sigma}{\sqrt{n}}, + \infty)\)</span></li>
<li>좌측검정: <span class="math inline">\((- \infty, \overline{y} +
z_{\alpha}\frac{\sigma}{\sqrt{n}})\)</span></li>
<li>양측검정: <span class="math inline">\((\overline{y} -
z_{\alpha}\frac{\sigma}{\sqrt{n}}, \overline{y} +
z_{\alpha}\frac{\sigma}{\sqrt{n}})\)</span></li>
</ul>
<div id="우측-검정one-sided" class="section level4">
<h4>우측 검정(one-sided)</h4>
<div class="sourceCode" id="cb199"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co">#우측 검정</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co">#기각역</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">alpha.right=</span><span class="fl">0.05</span>,</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.left=</span><span class="dv">0</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-39-1.png" width="960" /></p>
<div class="sourceCode" id="cb200"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co">#신뢰구간</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.left=</span><span class="fl">0.05</span>,<span class="at">alpha.right=</span><span class="dv">0</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-39-2.png" width="960" /></p>
</div>
<div id="좌측-검정one-sided" class="section level4">
<h4>좌측 검정(one-sided)</h4>
<div class="sourceCode" id="cb201"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co">#좌측 검정</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co">#기각역</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="sc">-</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">alpha.right=</span><span class="dv">0</span>,</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.left=</span><span class="fl">0.05</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-40-1.png" width="960" /></p>
<div class="sourceCode" id="cb202"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co">#신뢰구간</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="sc">-</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.left=</span><span class="dv">0</span>,<span class="at">alpha.right=</span><span class="fl">0.05</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-40-2.png" width="960" /></p>
</div>
<div id="양측-검정two-sided" class="section level4">
<h4>양측 검정(two-sided)</h4>
<div class="sourceCode" id="cb203"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co">#양측 검정</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="co">#기각역</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">alpha.right=</span><span class="fl">0.025</span>,</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.left=</span><span class="fl">0.025</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-41-1.png" width="960" /></p>
<div class="sourceCode" id="cb204"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co">#신뢰구간</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="at">mean0=</span><span class="dv">0</span>,<span class="at">xbar=</span><span class="fl">1.8</span>,<span class="at">sd=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha.left=</span><span class="fl">0.025</span>,<span class="at">alpha.right=</span><span class="fl">0.025</span>,<span class="at">shiny=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">distribution.name=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-41-2.png" width="960" /></p>
</div>
</div>
<div id="confidence-intervals-for-unknown-population-proportion-p"
class="section level3">
<h3>5.1.2 Confidence Intervals for Unknown Population Proportion p</h3>
<p>모집단 비율 <span class="math inline">\(p\)</span>가 알려져 있지 않은
경우 모집단 비율의 구간 추정에 관한 내용이다.</p>
<p>표본 크기가 <span class="math inline">\(n\)</span>이고, 어떤 Y가
성공한 개수라면 <span class="math inline">\(\hat{p} =
\frac{Y}{n}\)</span>이고, <span class="math inline">\(\hat{p}\)</span>는
모비율 <span class="math inline">\(p\)</span>의 점추정량이다. 이때,
모비율 <span class="math inline">\(p\)</span>의 <span
class="math inline">\(100(1-\alpha)\%\)</span> 신뢰구간은 다음과 같이
나타낸다. 이때, <span class="math inline">\(\sigma_{\overline{p_0}} =
\sqrt{\frac{p_0(1-p_0)}{n}}\)</span>이고, <span
class="math inline">\(z_{cale} = \frac{\hat{p} -
p_0}{\overline{p_0}}\)</span>이다.</p>
<p><span class="math display">\[
\hat{p} \pm z_{\frac{\alpha}{2}} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}
\]</span></p>
</div>
</div>
<div
id="t-intervals-and-tests-for-the-mean-of-a-population-having-unknown-standard-deviation"
class="section level2">
<h2>5.2 t-Intervals and Tests for the Mean of a Population Having
Unknown Standard Deviation</h2>
<p>해당 장에서는 t-분포에 대해서 다루는데 t-분포란 모집단 표준편차를 알
수 없을 때 표본 평균과 모집단 평균 사이 표준화된 거리를 설명하며,
관측값은 정규 분포를 따르는 모집단에서 추출된다. t-분포는 표준정규분포와
비슷한 점이 많은데 평균이 <span class="math inline">\(0\)</span>이고,
대칭형이다. t-분포는 모집단의 표준쳔차를 알 수 없거나 작은 표본 크기일
때 유용하게 쓰인다. 표본 크기가 커질 수록 정규분포와 비슷해진다.
t-분포의 검정통계량 식은 다음과 같다.</p>
<p><span class="math inline">\(t_{cale} = \frac{\overline{y} - \mu}
{S/\sqrt{n}}\)</span></p>
<div id="t.test-실습-예제" class="section level3">
<h3>t.test 실습 예제</h3>
<p>t.test 함수의 옵션은 다음과 같다.</p>
<ul>
<li><em>alternative</em>: “two.sided”-양측 검정, “less”-좌측 검정,
“greater”-우측 검정</li>
<li>mu: 모집단의 평균</li>
<li>var.equal: 분산의 동질성 여부</li>
<li>conf.level: 신뢰수준<span
class="math inline">\((1-\alpha)\)</span></li>
</ul>
<p><span class="math inline">\(H_0: \mu = 10\)</span> <span
class="math inline">\(H_1: \mu \not = 10\)</span></p>
<div class="sourceCode" id="cb205"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co">#t.test 실습 - One sample t-test(하나의 변수의 모평균이 특정값과 같은지 검정)</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(vocab)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>vocab.t <span class="ot">&lt;-</span><span class="fu">t.test</span>(vocab<span class="sc">$</span>score, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>vocab.t</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  vocab$score
## t = 10.08, df = 53, p-value = 6.372e-14
## alternative hypothesis: true mean is not equal to 10
## 95 percent confidence interval:
##  12.29919 13.44155
## sample estimates:
## mean of x 
##  12.87037</code></pre>
<p>분석 결과 t검정통계량 값이 10.08, 유의확률 p값이 6.372e-14로 유의수준
0.05보다 작기 때문에 귀무가설(<span
class="math inline">\(H_0\)</span>)를 기각한다. 즉, score 변수의
모평균은 10이라고 할 수 없다.</p>
</div>
<div id="t-분포-시각화" class="section level3">
<h3>t-분포 시각화</h3>
<p><em>NTplot</em> 함수에서 distribution = ’t’로 지정해주면 t분포에 대한
기각역과 신뢰구간을 시각화할 수 있다. t분포는 자유도(degrees of
freedom)<span class="math inline">\((n-1)\)</span>도 같이 입력해주어야
한다.</p>
<div class="sourceCode" id="cb207"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.4</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(vocab, {</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  mu0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(score)</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  sd0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(score)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>  n0 <span class="ot">&lt;-</span> <span class="fu">length</span>(score)</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#기각역</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">NTplot</span>(<span class="at">mean0=</span>mu0, <span class="at">sd=</span>sd0, <span class="at">alpha.right=</span><span class="fl">0.025</span>, <span class="at">alpha.left=</span><span class="fl">0.025</span>,</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">distribution.name=</span><span class="st">&quot;t&quot;</span>,<span class="at">n=</span>n0, <span class="at">df=</span>n0<span class="dv">-1</span>) <span class="co">#df-자유도</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#신뢰구간</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">NTplot</span>(<span class="at">mean0=</span>mu0, <span class="at">sd=</span>sd0, <span class="at">type=</span><span class="st">&quot;confidence&quot;</span>, <span class="at">shiny=</span><span class="cn">FALSE</span>,</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha.right=</span><span class="fl">0.025</span>, <span class="at">alpha.left=</span><span class="fl">0.025</span>,</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">distribution.name=</span><span class="st">&quot;t&quot;</span>,<span class="at">n=</span>n0, <span class="at">df=</span>n0<span class="dv">-1</span>)</span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-43-1.png" width="960" /></p>
<div class="sourceCode" id="cb208"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co">#t.test 검정 결과를 NTplot에 바로 넣어도 위와 같은 그림이 나온다.</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="co">#기각역</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(vocab.t)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-43-2.png" width="960" /></p>
<div class="sourceCode" id="cb209"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co">#신뢰구간</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(vocab.t, <span class="at">type=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-43-3.png" width="960" /></p>
</div>
<div id="hh-패키지-내에-있는-chisq-함수" class="section level3">
<h3>HH 패키지 내에 있는 chisq 함수</h3>
<p>HH 패키지에서는 카이제곱(<em>chisq</em>)분포, F분포에 대한 시각화
기능도 제공한다. 아래 그림 5.5는 자유도 <span
class="math inline">\(df=12\)</span>, 표본분산 <span
class="math inline">\(s^2=15\)</span>일 때의 95% 신뢰구간에 대한
것이다.</p>
<p>카이제곱 관련 R 함수 종류</p>
<ul>
<li><p>dcisq(x, df, ncp=0, log=FALSE): 확률밀도함수, ncp - 비중심모수
값, log - 논리값 설정(TRUE이면 확률값은 log(p))</p></li>
<li><p>pchisq(q, df, ncp=0, lower.tail=TRUE, log.p=FALSE): 누적분포함수,
lower.tail - TRUE이면 <span class="math inline">\(P(X&lt;=x)\)</span>,
FALSE이면 <span class="math inline">\(P(X&gt;x)\)</span></p></li>
<li><p>qchisq(p, df, ncp=0, lower.tail=TRUE, log.p=FALSE):
누적분포함수의 역함수(분위수 함수)</p></li>
<li><p>rchisq(n, df, ncp=0): 임의추출함수</p></li>
<li><p>HH 패키지 chisq</p></li>
<li><p>chisq.setup(df, xlim.in): 카이제곱분포의 틀 잡기, xlim.in - x의
범위</p></li>
<li><p>chisq.curve(df, col, alpha): 카이제곱분포 그래프 그리기</p></li>
</ul>
<div class="sourceCode" id="cb210"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.5</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>qch <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="at">df=</span><span class="dv">12</span>) <span class="co">#분위수 계산</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>old.omd <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">omd=</span><span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">88</span>, .<span class="dv">10</span>,<span class="dv">1</span>)) <span class="co">#마진 세팅 벡터(아래, 왼쪽, 위, 오른쪽)</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.setup</span>(<span class="at">df=</span><span class="dv">12</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>) <span class="co">#세팅 - 틀 그리기</span></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a><span class="co">#그래프 추가</span></span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.curve</span>(<span class="at">df=</span><span class="dv">12</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">alpha=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">025</span>), <span class="at">axis.name=</span><span class="fu">expression</span>(chi<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a><span class="co">#모분산에 대한 구간 추정</span></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a><span class="co">#(df/분위수)</span></span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>qch, <span class="at">labels=</span><span class="fu">round</span>(<span class="dv">12</span><span class="sc">/</span>qch, <span class="dv">2</span>), <span class="at">line=</span><span class="fl">3.5</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">0</span>)</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">line=</span><span class="fl">3.5</span>, <span class="at">labels=</span><span class="fu">expression</span>(nu <span class="sc">~</span> <span class="st">&quot;/&quot;</span> <span class="sc">~</span> chi<span class="sc">^</span><span class="dv">2</span>), <span class="at">xpd=</span><span class="cn">TRUE</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">0</span>)</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a><span class="co">#((S^2*df)/분위수)</span></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>qch, <span class="at">labels=</span><span class="fu">round</span>(s2<span class="sc">*</span><span class="dv">12</span><span class="sc">/</span>qch, <span class="dv">2</span>), <span class="at">line=</span><span class="dv">5</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">0</span>)</span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">line=</span><span class="dv">5</span>, <span class="at">labels=</span><span class="fu">expression</span>(s<span class="sc">^</span><span class="dv">2</span> <span class="sc">~</span> nu <span class="sc">~</span> <span class="st">&quot;/&quot;</span> <span class="sc">~</span> chi<span class="sc">^</span><span class="dv">2</span>), <span class="at">xpd=</span><span class="cn">TRUE</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">0</span>)</span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a><span class="co">#특정 값에 대한 카이제곱 구간 그리기</span></span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.observed</span>(<span class="dv">15</span>, <span class="at">df=</span><span class="dv">12</span>, <span class="at">axis.name=</span><span class="fu">expression</span>(chi<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>, <span class="at">at=</span><span class="dv">13</span>, <span class="at">line=</span><span class="sc">-</span>.<span class="dv">5</span>, <span class="at">labels=</span><span class="fu">expression</span>(s<span class="sc">^</span><span class="dv">2</span><span class="sc">==</span><span class="dv">15</span>), <span class="at">xpd=</span><span class="cn">TRUE</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-44-1.png" width="960" /></p>
<div class="sourceCode" id="cb211"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co">#기각역 그래프</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>old.omd <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">omd=</span><span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">88</span>, .<span class="dv">05</span>,<span class="dv">1</span>))</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.setup</span>(<span class="at">df=</span><span class="dv">12</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>) </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.curve</span>(<span class="at">df=</span><span class="dv">12</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">axis.name=</span><span class="fu">expression</span>(chi<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.observed</span>(<span class="dv">24</span>, <span class="at">df=</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-45-1.png" width="960" /></p>
</div>
</div>
<div id="comparisons-of-two-populations-based-on-independent-samples"
class="section level2">
<h2>5.4 Comparisons of Two Populations Based on Independent Samples</h2>
<p>상호독립인 두 모집단에 비교에 대한 검정, 신뢰구간 등을 다루는
장이다.</p>
<div
id="confidence-intervals-on-the-difference-between-two-population-proportions"
class="section level3">
<h3>5.4.1 Confidence Intervals on the Difference Between Two Population
Proportions</h3>
<p>모비율이 <span class="math inline">\(p_1, p_2\)</span>이고,
상호독립인 두 이항모집단으로부터 각각 <span class="math inline">\(m,
n\)</span>개의 확률표본을 추출하여 얻은 두 모비율 간의 차이에 대한
분포와 신뢰구간은 다음과 같다.</p>
<ul>
<li>중심극한정리를 이용하였을 때,<span class="math inline">\(m,
n\)</span>이 충분히 클 때(<span
class="math inline">\(\geq30\)</span>)</li>
</ul>
<p><span class="math display">\[
(\hat{p}_1-\hat{p}_2) \sim N(p_1-p_2,\frac{p_1q_1}{m}+ \frac{p_2q_2}{n})
\\
Z = \frac{(\hat{P}_1-\hat{P}_2)-(p_1-p_2)}{\sqrt{\frac{p_1q_1}{m}+
\frac{p_2q_2}{n}}} \sim N(0,1) \\
[(\hat{P}_1-\hat{P}_2)\pm
z_{\alpha/2}\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{m}+
\frac{\hat{p}_2(1-\hat{p}_2)}{n}}]
\]</span></p>
<ul>
<li><span class="math inline">\(m, n\)</span>이 크지 않을 때(<span
class="math inline">\(\leq30\)</span>)</li>
</ul>
<p><span class="math display">\[
합동표본비율 \hat{p} = \frac{mp_1+np_2}{m+n}\\
Z =
\frac{\hat{p}_1-\hat{p}_2}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{m}+\frac{1}{n})}}
\sim N(0,1)
\]</span></p>
</div>
<div id="confidence-interval-on-the-difference-between-two-means"
class="section level3">
<h3>5.4.2 Confidence Interval on the Difference Between Two Means</h3>
<p>두 모집단 평균의 차이에 대한 신뢰구간을 정의한다. 이때 모분산 <span
class="math inline">\(\sigma^2\)</span>는 알려져 있지 않은 경우에 대한
신뢰구간이다.</p>
<ol style="list-style-type: decimal">
<li><p>등분산(두 모분산이 동일한 경우) <span class="math display">\[
합동표본분산(S^2_p) 사용 \\
S^2_p = \frac{(n_1-1)s^2_1+(n_2-1)s^2_2}{n_1+n_2-2}\\
[(\overline{y}_1-\overline{y}_2)\pm t_{\frac{\alpha}{2},
n_1+n_2-2}S_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}]
\]</span></p></li>
<li><p>이분산(두 모분산이 동일하지 않은 경우) 이때, 세터스퀘이트의
공식을 이용하여 자유도 df의 근사치를 구한다. <span
class="math display">\[
df =
\frac{(s^2_1/n_1+s^2_2/n_2)^2}{\frac{(s^2_1/n_1)^2}{n_1-1}+\frac{(s^2_2/n_2)^2}{n_2-1}}
\\
[(\overline{y}_1-\overline{y}_2)\pm t_{\frac{\alpha}{2},
df}\sqrt{\frac{s^2_1}{n_1}+\frac{s^2_2}{n_2}}]
\]</span></p></li>
</ol>
</div>
<div
id="tests-comparing-two-population-means-when-the-samples-are-independent"
class="section level3">
<h3>5.4.3 Tests Comparing Two Population Means When the Samples Are
Independent</h3>
<p>위의 내용들을 참고하여 모분산 <span
class="math inline">\(\sigma^2\)</span>가 알려져 있지 않은 경우의 두
모집단 평균 차이에 대한 검정을 한다. 이때 t 검정통계량 값은 다음과
같다.</p>
<p><span class="math display">\[
t_{cale} =
\frac{\overline{y}_1-\overline{y}_2}{s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}}
\]</span></p>
<div class="sourceCode" id="cb212"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co">#table 5.4</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cereals)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co">#빈도 확인</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cereals[,<span class="fu">c</span>(<span class="st">&quot;mfr&quot;</span>,<span class="st">&quot;type&quot;</span>)])</span></code></pre></div>
<pre><code>##    type
## mfr  C  H
##   A  0  1
##   G 22  0
##   K 23  0
##   N  5  1
##   P  9  0
##   Q  7  1
##   R  8  0</code></pre>
<div class="sourceCode" id="cb214"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co">#subset</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>cerealsC <span class="ot">&lt;-</span> <span class="fu">filter</span>(cereals, type<span class="sc">==</span><span class="st">&quot;C&quot;</span> <span class="sc">&amp;</span> mfr <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span>,<span class="st">&quot;G&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mfr =</span> <span class="fu">factor</span>(mfr)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;mfr&quot;</span>, <span class="st">&quot;carbo&quot;</span>)</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="co">#mfr 그룹 별 boxplot 그리기 + 점 표시</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(carbo <span class="sc">~</span> mfr, <span class="at">data=</span>cerealsC) <span class="sc">+</span> <span class="fu">dotplot</span>(carbo <span class="sc">~</span> mfr, <span class="at">data=</span>cerealsC)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-46-1.png" width="960" /></p>
<div class="sourceCode" id="cb215"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#two-sample t-test</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>t.t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(carbo <span class="sc">~</span> mfr, <span class="at">data=</span>cerealsC, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>t.t</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  carbo by mfr
## t = -0.34148, df = 43, p-value = 0.7344
## alternative hypothesis: true difference in means between group G and group K is not equal to 0
## 95 percent confidence interval:
##  -2.784151  1.977827
## sample estimates:
## mean in group G mean in group K 
##        14.72727        15.13043</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: 그룹 G와 그룹 K의
탄수화물 평균의 차이는 없다.\)</span></li>
<li>귀무가설: <span class="math inline">\(H_1: 그룹 G와 그룹 K의
탄수화물 평균의 차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = 0.7344\)</span></li>
<li>검정통계량 <span class="math inline">\(t = -0.34148\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &lt; p-value =
0.7344\)</span>로 귀무가설 기각 못함. 즉, 두 그룹 간의 탄수화물 평균의
차이는 없다고 해석할 수 있다.</li>
</ul>
</div>
<div id="ntplot" class="section level3">
<h3>NTplot</h3>
<div class="sourceCode" id="cb217"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(cerealsC,{</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  mm<span class="ot">&lt;-</span><span class="fu">tapply</span>(carbo, mfr, mean) <span class="co">#그룹별 평균</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  vv<span class="ot">&lt;-</span><span class="fu">tapply</span>(carbo, mfr, var) <span class="co">#그룹별 분산</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  ll<span class="ot">&lt;-</span><span class="fu">tapply</span>(carbo, mfr, length) <span class="co">#그룹별 크기</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#합동 분산</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>  s2p <span class="ot">&lt;-</span> ((ll<span class="dv">-1</span>) <span class="sc">%*%</span> vv) <span class="sc">/</span> <span class="fu">sum</span>(ll<span class="dv">-1</span>)</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#t-검정통계량</span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">diff</span>(mm) <span class="sc">/</span> (<span class="fu">sqrt</span>(s2p) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>ll)))</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  tt <span class="co">#-0.3414773</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#NTplot - 그림 5.6</span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>  t.t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(carbo <span class="sc">~</span> mfr, <span class="at">data=</span>cerealsC, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">NTplot</span>(t.t, <span class="at">zaxis=</span><span class="cn">TRUE</span>) </span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-47-1.png" width="960" /></p>
</div>
<div id="comparing-the-variances-of-two-normal-populations"
class="section level3">
<h3>5.4.4 Comparing the Variances of Two Normal Populations</h3>
<p>두 모분산 차이와 비에 대한 신뢰구간은 다음과 같다. <span
class="math display">\[
F = \frac{s^2_1/\sigma^2_1}{s^2_2/\sigma^2_2} \sim F(n_1-1, n_2-1)\\
[\frac{s^2_1/s^2_2}{F_{\alpha/2}(n_1-1, n_2-1)},
\frac{s^2_1/s^2_2}{F_{1-\alpha/2}(n_1-1, n_2-1)}]
\]</span></p>
</div>
</div>
<div id="paired-data" class="section level2">
<h2>5.5 Paired Data</h2>
<p>쌍체표본이란 동일한 성질을 갖는 쌍으로 구성된 표본을 말하며 짝지어진
표본이라고 불린다. 대표적으로 운동 전, 후의 체중 변화에 대한 데이터가
있다. 쌍체표본의 차이 <span class="math inline">\(d\)</span>의 표본평균
<span class="math inline">\(\overline{d}\)</span>에 대한 분포는 다음과
같다. <span class="math display">\[
\overline{d} \sim N(\mu_d, \frac{s_d^2}{n})\\
t_{cale} = \frac{\overline{d}}{s_d/\sqrt{n}} , [\overline{d} \pm
t_{\alpha/2}\frac{s_d}{\sqrt{n}}]
\]</span></p>
</div>
<div id="sample-size-determination" class="section level2">
<h2>5.6 Sample Size Determination</h2>
<p>해당 장에서는 적절한 표본크기를 정의하기 위한 내용을 다룬다.</p>
<ul>
<li>특정한 폭(추정 오차)와 <span
class="math inline">\(100(1-\alpha)%\)</span>하에서 모평균 <span
class="math inline">\(\mu\)</span>의 추정에 필요한 표본크기</li>
<li>1종 오류 <span class="math inline">\(\alpha\)</span>와 검정력 <span
class="math inline">\(1-\beta\)</span>에 대한 검정</li>
</ul>
<div id="sample-size-for-estimation" class="section level3">
<h3>5.6.1 Sample Size for Estimation</h3>
<p>추정에 필요한 표본 크기<span class="math inline">\(n\)</span>는
다음의 식에 의해 정의된다. 이때, <span
class="math inline">\(W\)</span>는 차이를 탐지하기 위한 효과의 크기를
의미하고, <span class="math inline">\(\phi^{-1}\)</span>은
표준정규분포의 역 누적 분포(CDF)를 의미한다.</p>
<p><span class="math display">\[
W = 2z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\\
n = \frac{4\sigma^2(\phi^{-1}(1-\alpha/2))^2}{W^2}
\]</span></p>
</div>
<div id="sample-size-for-hypothesis-testing" class="section level3">
<h3>5.6.2 Sample Size for Hypothesis Testing</h3>
<p>해당 챕터에서는 one-sample, one-sided 검정의 표본 크기 및 검정력에
대한 그림을 그린다. 이때 모표준편차는 <span
class="math inline">\(\sigma=3\)</span>으로 알려져 있다.</p>
<p><span class="math display">\[
n = \sigma^2(\phi^{-1}(1-\alpha)+\phi^{-1}(1-\beta))^2 / \delta^2,
\delta = W
\]</span></p>
<div class="sourceCode" id="cb218"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>mean0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>mean1 <span class="ot">&lt;-</span> mean0 <span class="sc">+</span> delta</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span> <span class="co">#제 1종 오류(알파)</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> .<span class="dv">20</span> <span class="co">#제 2종 오류(베타)</span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>beta <span class="co">#검정력</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="co">#위의 식에 대입해서 표본크기 직접 구하기</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha) <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> delta<span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>n <span class="co">#13.91075</span></span></code></pre></div>
<pre><code>## [1] 13.91075</code></pre>
<div class="sourceCode" id="cb220"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.9</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">NTplot</span>(<span class="at">mean0=</span>mean0, <span class="at">mean1=</span>mean1, <span class="at">sd=</span>sd, <span class="at">n=</span>n,</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">key.axis.padding=</span><span class="dv">6</span>, <span class="at">cex.main=</span><span class="fl">1.5</span>,</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.top.axis=</span><span class="fl">1.8</span>, <span class="at">cex.prob=</span><span class="fl">1.5</span>,</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob.labels=</span><span class="cn">FALSE</span>,</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">digits.axis=</span><span class="dv">5</span>, <span class="at">digits.float=</span><span class="dv">3</span>, <span class="at">digits.left=</span><span class="dv">3</span>,</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">xhalf.multiplier=</span>.<span class="dv">8</span>, <span class="at">yhalf.multiplier=</span>.<span class="dv">6</span>,</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">zaxis=</span><span class="cn">TRUE</span>, <span class="at">z1axis=</span><span class="cn">TRUE</span>, <span class="at">cex.z=</span><span class="dv">1</span>)</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-48-1.png" width="960" /></p>
</div>
<div id="power.t.test-사용하여-적절한-표본-크기-구하기"
class="section level3">
<h3>power.t.test 사용하여 적절한 표본 크기 구하기</h3>
<p>R에서 제공하는 <em>power.t.test</em> 함수를 사용하여 우리가 원하는
검정력과 수준에 맞추어 t.test에 필요한 적절한 표본 수를 계산할 수
있다.</p>
<div class="sourceCode" id="cb221"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co">#직접 구하기</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> .<span class="dv">80</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>power</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>sd<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha) <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> delta<span class="sc">^</span><span class="dv">2</span> <span class="co">#24.73023</span></span></code></pre></div>
<pre><code>## [1] 24.73023</code></pre>
<div class="sourceCode" id="cb223"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co">#power.t.test 사용하여 구하기</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>PTT <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">delta=</span>delta, <span class="at">sd=</span>sd, <span class="at">sig.level=</span>alpha, <span class="at">power=</span>power,</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">type=</span><span class="st">&quot;one.sample&quot;</span>, <span class="at">alternative=</span><span class="st">&quot;one.sided&quot;</span>)</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>PTT <span class="co">#n=26.13751</span></span></code></pre></div>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 26.13751
##           delta = 1
##              sd = 2
##       sig.level = 0.05
##           power = 0.8
##     alternative = one.sided</code></pre>
<div class="sourceCode" id="cb225"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.10 왼쪽</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(PTT, <span class="at">zaxis=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-49-1.png" width="960" /></p>
</div>
<div
id="표본-크기에-따른-검정력-직접-계산하기---초기-표본-크기가-0이-아닐-때"
class="section level3">
<h3>표본 크기에 따른 검정력 직접 계산하기 - 초기 표본 크기가 0이 아닐
때</h3>
<div class="sourceCode" id="cb226"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co">#초기 표본 크기</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="co">#임계값</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>t.critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">df=</span>n0<span class="dv">-1</span>)</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>t.critical <span class="co">#1.699</span></span></code></pre></div>
<pre><code>## [1] 1.699127</code></pre>
<div class="sourceCode" id="cb228"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(nn) <span class="ot">&lt;-</span> nn</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>nn</span></code></pre></div>
<pre><code>## 23 24 25 26 27 28 29 30 
## 23 24 25 26 27 28 29 30</code></pre>
<div class="sourceCode" id="cb230"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="do">##각 표본 크기에 따른 검정력</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(t.critical, <span class="at">df=</span>nn<span class="dv">-1</span>, <span class="at">ncp=</span>delta<span class="sc">/</span>(sd<span class="sc">/</span><span class="fu">sqrt</span>(nn)), <span class="at">lower=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##        23        24        25        26        27        28        29        30 
## 0.7567776 0.7721918 0.7867744 0.8005544 0.8135615 0.8258266 0.8373804 0.8482542</code></pre>
<div class="sourceCode" id="cb232"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="do">##     23     24     25     26     27     28     29     30</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.7568 0.7722 0.7868 0.8006 0.8136 0.8258 0.8374 0.8483</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="do">##목표 검정력에 가장 가까운 표본 크기를 새 표본 크기로 선택 후 새로운 임계값 및 검정력 계산</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>t.critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">df=</span><span class="dv">26-1</span>)</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>t.critical <span class="co">#1.708141</span></span></code></pre></div>
<pre><code>## [1] 1.708141</code></pre>
<div class="sourceCode" id="cb234"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="do">##새로운 임계값에 대한 검정력</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(t.critical, <span class="at">df=</span>nn<span class="dv">-1</span>, <span class="at">ncp=</span>delta<span class="sc">/</span>(sd<span class="sc">/</span><span class="fu">sqrt</span>(nn)), <span class="at">lower=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##        23        24        25        26        27        28        29        30 
## 0.7539976 0.7695028 0.7841789 0.7980537 0.8111566 0.8235176 0.8351671 0.8461357</code></pre>
<div class="sourceCode" id="cb236"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="do">##     23     24     25     26     27     28     29     30</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.7540 0.7695 0.7842 0.7981 0.8112 0.8235 0.8352 0.8461</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.10 오른쪽</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="fu">NTplot</span>(<span class="fu">NTplot</span>(PTT), <span class="at">n=</span><span class="dv">30</span>, <span class="at">df=</span><span class="dv">29</span>, <span class="at">main=</span><span class="cn">NA</span>,</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">zaxis=</span><span class="cn">TRUE</span>, <span class="at">cex.z=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-50-1.png" width="960" /></p>
<p>우리가 원했던 검정력 0.8 값은 power.t.test를 사용했을 때와 같이 26과
27 사이에 가장 가깝게 나타나는 것을 확인할 수 있다.</p>
</div>
</div>
<div id="goodness-of-fit" class="section level2">
<h2>5.7 Goodness of Fit</h2>
<p>해당 장에서는 적합도 검정을 다루는데 가정된 확률이 정해져 있을 때와
가정된 확률이 정해져 있지 않을 때 데이터가 가정된 확률에 적합하게 따르고
있는가를 검정하는 것이다. 카이제곱 적합도 검정의 검정통계량을
사용한다.</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: 관측값(데이터)는 가정한
확률분포를 따른다.</li>
<li><span class="math inline">\(H_1\)</span>: 관측값(데이터)는 가정한
확률분포를 따르지 않는다.</li>
</ul>
<p><span class="math inline">\(\chi^2 =
\sum{\frac{(O-E)^2}{E}}\)</span></p>
<div
id="exampletest-of-goodness-of-fit-to-a-discrete-uniform-distribution"
class="section level3">
<h3>5.7.2 Example—Test of Goodness-of-Fit to a Discrete Uniform
Distribution</h3>
<p>해당 예제는 이산형 균일 분포에 대한 적합도 검정이다. 주사위를 30번
던졌을 때 나온 횟수로 카이제곱 적합도 검정을 진행한다.</p>
<div class="sourceCode" id="cb237"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>dice <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">6</span>)))</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>dice</span></code></pre></div>
<pre><code>##  [1] 4 4 4 2 6 2 2 3 6 4 2 6 4 4 3 2 2 1 3 5 1 3 4 2 6 1 6 3 4 6</code></pre>
<div class="sourceCode" id="cb239"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dice) <span class="co">#빈도표</span></span></code></pre></div>
<pre><code>## dice
## 1 2 3 4 5 6 
## 3 7 5 8 1 6</code></pre>
<div class="sourceCode" id="cb241"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(dice))</span></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  table(dice)
## X-squared = 6.8, df = 5, p-value = 0.2359</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0:\)</span> 해당 데이터는
균일 분포를 따른다.</li>
<li>귀무가설: <span class="math inline">\(H_1:\)</span> 해당 데이터는
균일 분포를 따르지 않는다.</li>
<li><span class="math inline">\(p-value = 0.2359\)</span></li>
<li>검정통계량 <span class="math inline">\(\chi^2 = 6.8\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &lt; p-value =
0.2359\)</span>로 귀무가설 기각 못함. 즉, 해당 데이터는 균일 분포를
따른다고 할 수 있다.</li>
</ul>
<div class="sourceCode" id="cb243"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.11-위의 결과 시각화하기</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>old.omd <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">omd=</span><span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">88</span>, .<span class="dv">05</span>, <span class="dv">1</span>))</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.setup</span>(<span class="at">df=</span><span class="dv">5</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.curve</span>(<span class="at">df=</span><span class="dv">5</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">axis.name=</span><span class="fu">expression</span>(chi<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.observed</span>(<span class="fl">6.8</span>, <span class="at">df=</span><span class="dv">5</span>, <span class="at">axis.name=</span><span class="fu">expression</span>(chi<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-52-1.png" width="960" /></p>
<div class="sourceCode" id="cb244"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(old.omd)</span></code></pre></div>
</div>
<div id="exampletest-of-goodness-of-fit-to-a-binomial-distribution"
class="section level3">
<h3>5.7.3 Example—Test of Goodness-of-Fit to a Binomial
Distribution</h3>
<p>해당 예제는 이항 분포에 대한 적합도 검정이다. 관심있는 분야는 가족 내
여자아이의 수에 대한 예제이다. 이때, <span class="math inline">\(n=5,
p=0.4\)</span></p>
<div class="sourceCode" id="cb245"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>Observed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">18</span>, <span class="dv">6</span>, <span class="dv">5</span>)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Observed) <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="do">## binomial proportion p=.4 is specified</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>Expected <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">p=</span>.<span class="dv">4</span>)<span class="sc">*</span><span class="dv">80</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Expected) <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(Observed, <span class="at">p=</span>Expected, <span class="at">rescale.p=</span><span class="cn">TRUE</span>) <span class="co">#rescale.p - p 입력 인자의 합이 1이 되도록 rescaling</span></span></code></pre></div>
<pre><code>## Warning in chisq.test(Observed, p = Expected, rescale.p = TRUE): 카이제곱
## approximation은 정확하지 않을수도 있습니다</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  Observed
## X-squared = 31.215, df = 5, p-value = 8.496e-06</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0:\)</span> 해당 데이터는
이항 분포를 따른다.</li>
<li>귀무가설: <span class="math inline">\(H_1:\)</span> 해당 데이터는
이항 분포를 따르지 않는다.</li>
<li><span class="math inline">\(p-value = 8.496e-06\)</span></li>
<li>검정통계량 <span class="math inline">\(\chi^2 = 31.215\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt; p-value =
8.496e-06\)</span>로 귀무가설 기각. 즉, 해당 데이터는 이항 분포를
따른다고 할 수 없다.</li>
</ul>
<div class="sourceCode" id="cb248"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.12</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="co">#관측빈도와 기대빈도에 대한 그림</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="at">Observed =</span> <span class="fu">xyplot</span>(Observed <span class="sc">~</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">horizontal=</span><span class="cn">FALSE</span>, <span class="at">origin=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;#727EB5&quot;</span>,</span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">panel=</span>panel.barchart, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">28</span>)),</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Binomial p=.4&quot;</span> <span class="ot">=</span> <span class="fu">xyplot</span>(Expected <span class="sc">~</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">horizontal=</span><span class="cn">FALSE</span>, <span class="at">origin=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;#727EB5&quot;</span>,</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">panel=</span>panel.barchart, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">28</span>))</span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a><span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>), <span class="at">scales=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="cn">FALSE</span>), <span class="at">ylab=</span><span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-54-1.png" width="960" /></p>
</div>
</div>
<div id="normal-probability-plots-and-quantile-plots"
class="section level2">
<h2>5.8 Normal Probability Plots and Quantile Plots</h2>
<p>Q-Q plot을 이용하여 데이터에 대한 모집단이 정규모집단을 따른다는
가정을 검증할 수 있다. 수집 데이터를 표준정규분포의 분위수와 비교하여
그리는 그래프이다. 또는 서로 다른 두 데이터의 분포가 같은지 파악하기
위해서도 사용된다. x축이 정규분포의 분위수, y축이 수집 데이터의 분위수로
만약 정규성을 만족한다면 직선의 형태를 띄게 된다. R에서는
<em>qqplot</em> 함수를 사용하여 그릴 수 있다.</p>
<div id="normal-probability-plots" class="section level3">
<h3>5.8.1 Normal Probability Plots</h3>
<p>다양한 분포를 만들고 이에 대해 qqplot을 그려 각 분포의 형태일 때의
qqplot 모양을 확인하는 예제이다.</p>
<div class="sourceCode" id="cb249"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 5.13</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="co">#랜덤 난수 생성 - 정규분포, 균일분포</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>qqnorm.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal=</span><span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">uniform=</span><span class="fu">runif</span>(<span class="dv">100</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 변형 - 다양한 분포 모양 생성</span></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a>qqnorm.dat <span class="ot">&lt;-</span> <span class="fu">within</span>(qqnorm.dat, {</span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">heavy-tailed</span><span class="st">`</span> <span class="ot">&lt;-</span> normal<span class="sc">/</span>uniform</span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">thin-tailed</span><span class="st">`</span> <span class="ot">&lt;-</span> normal<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(normal))</span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">positively skewed</span><span class="st">`</span> <span class="ot">&lt;-</span> normal<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">negatively skewed</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="sc">-</span><span class="st">`</span><span class="at">positively skewed</span><span class="st">`</span></span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true" tabindex="-1"></a>  quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">ppoints</span>(<span class="fu">length</span>(normal)))</span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true" tabindex="-1"></a><span class="co">#qqplot 그릴 데이터 프레임 생성</span></span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true" tabindex="-1"></a>qqnorm.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(qqnorm.dat, sort), <span class="at">check.names=</span><span class="cn">FALSE</span>) </span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(qqnorm.dat)</span></code></pre></div>
<pre><code>##      normal   uniform quantiles negatively skewed positively skewed thin-tailed
## 1 -3.090687 -2.983333 -2.575829         -9.552345      4.426075e-06  -0.3676353
## 2 -2.457231 -2.879897 -2.170090         -6.037982      1.560941e-04  -0.3668741
## 3 -2.456415 -2.812897 -1.959964         -6.033975      1.767713e-04  -0.3666794
## 4 -2.222670 -2.784801 -1.811911         -4.940263      2.212035e-04  -0.3654254
## 5 -2.201484 -2.763002 -1.695398         -4.846530      2.471441e-04  -0.3651121
## 6 -1.898398 -2.651452 -1.598193         -3.603915      3.836512e-03  -0.3639799
##   heavy-tailed
## 1   -33.799628
## 2   -10.052681
## 3    -3.392235
## 4    -2.985915
## 5    -2.865645
## 6    -2.848974</code></pre>
<div class="sourceCode" id="cb251"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co">#qqplot 그리기</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(normal <span class="sc">+</span> uniform <span class="sc">+</span> <span class="st">`</span><span class="at">negatively skewed</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">positively skewed</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">thin-tailed</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">heavy-tailed</span><span class="st">`</span> <span class="sc">~</span> quantiles, <span class="at">data=</span>qqnorm.dat, <span class="at">outer=</span><span class="cn">TRUE</span>,</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">&quot;Observed values&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Quantiles of Standard Normal&quot;</span>,</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">likertColor</span>(<span class="dv">2</span>)[<span class="dv">2</span>],</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">rot=</span><span class="dv">0</span>, <span class="at">alternating=</span><span class="cn">FALSE</span>, <span class="at">y=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">&quot;free&quot;</span>)), </span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span><span class="dv">1</span>), <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-55-1.png" width="960" /></p>
<div class="sourceCode" id="cb252"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 각 분포 별 히스토그램 그리기</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">lapply</span>(qqnorm.dat, histogram, <span class="at">nint=</span><span class="dv">15</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co">#분포 별 히스토그램</span></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(<span class="fu">do.call</span>(latticeExtra<span class="sc">:::</span>c.trellis, <span class="fu">c</span>(tmp[<span class="sc">-</span><span class="dv">3</span>], <span class="fu">list</span>(<span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)))),</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Observed Values&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-55-2.png" width="960" /></p>
</div>
<div id="examplecomparing-t-distributions" class="section level3">
<h3>Example—Comparing t-Distributions</h3>
<p>t분포의 자유도가 변화함에 따라 정규분포와의 차이를 비교해서 그려보는
예제이다.</p>
<div class="sourceCode" id="cb253"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>points <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>) <span class="do">##ppoints -n개의 0~1 사이의 점으로 된 수열 생성</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co">#분위수 데이터 프레임</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>qqt.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ppoints=</span>points,</span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3=</span><span class="fu">qt</span>(points, <span class="dv">3</span>),</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5=</span><span class="fu">qt</span>(points, <span class="dv">5</span>),</span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">q7=</span><span class="fu">qt</span>(points, <span class="dv">7</span>),</span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">qn=</span><span class="fu">qnorm</span>(points))</span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 생성</span></span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a>qqt.data <span class="ot">&lt;-</span> <span class="fu">within</span>(qqt.data, {</span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a>  d3 <span class="ot">&lt;-</span> <span class="fu">dt</span>(q3, <span class="dv">3</span>)</span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a>  d5 <span class="ot">&lt;-</span> <span class="fu">dt</span>(q5, <span class="dv">5</span>)</span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a>  d7 <span class="ot">&lt;-</span> <span class="fu">dt</span>(q7, <span class="dv">7</span>)</span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a>  dn <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(qn)</span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(qqt.data)</span></code></pre></div>
<pre><code>##   ppoints        q3        q5        q7        qn         dn          d7
## 1   0.005 -5.840909 -4.032143 -3.499483 -2.575829 0.01445974 0.006736692
## 2   0.015 -3.896046 -3.002875 -2.714573 -2.170090 0.03787043 0.021684447
## 3   0.025 -3.182446 -2.570582 -2.364624 -1.959964 0.05844507 0.036773974
## 4   0.035 -2.762599 -2.297392 -2.136453 -1.811911 0.07727006 0.051682816
## 5   0.045 -2.470807 -2.097837 -1.966153 -1.695398 0.09478679 0.066313693
## 6   0.055 -2.249392 -1.940503 -1.829661 -1.598193 0.11124179 0.080625928
##            d5          d3
## 1 0.004939305 0.002401234
## 2 0.017228785 0.010009531
## 3 0.030337788 0.019194076
## 4 0.043703535 0.029264149
## 5 0.057112738 0.039903681
## 6 0.070454099 0.050923392</code></pre>
<div class="sourceCode" id="cb255"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co">#분위수 비교 그림(qqplot) 그리기</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(q3<span class="sc">+</span>q5<span class="sc">+</span>q7<span class="sc">+</span>qn <span class="sc">~</span> qn, <span class="at">data=</span>qqt.data, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">aspect=</span><span class="st">&quot;iso&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;distribution&quot;</span>,</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">superpose.line=</span><span class="fu">list</span>(<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>))),</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key=</span><span class="fu">list</span>(<span class="at">space=</span><span class="st">&quot;right&quot;</span>, <span class="at">border=</span><span class="cn">TRUE</span>,</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">text=</span><span class="fu">c</span>(<span class="st">&quot;t, 3 df&quot;</span>, <span class="st">&quot;t, 5 df&quot;</span>, <span class="st">&quot;t, 7 df&quot;</span>, <span class="st">&quot;normal&quot;</span>),</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lines=</span><span class="cn">TRUE</span>, <span class="at">points=</span><span class="cn">FALSE</span>))</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-56-1.png" width="960" />
t분포의 자유도가 커질 수록 정규분포와 비슷한 직선의 형태가 되는 것을 알
수 있다.</p>
</div>
</div>
<div id="kolmogorovsmirnov-goodness-of-fit-tests"
class="section level2">
<h2>5.9 Kolmogorov–Smirnov Goodness-of-Fit Tests</h2>
<p>콜모고로프 스미르노프 검정 방법은 데이터의 누적분포함수와 비교하고자
하는 분포의 누적분포함수 간의 최대 거리를 통계량으로 사용하는 적합도
검정 방법이다. R에서는 <em>ks.test</em> 함수를 사용하여 검정할 수 있다.
이때, alternative=“two-sided”, “greater”, “less”로 각각 지정해서 양측
검정, 우측 검정, 좌측 검정을 시행할 수 있다.</p>
<div id="examplekolmogorovsmirnov-goodness-of-fit-test"
class="section level3">
<h3>5.9.1 Example—Kolmogorov–Smirnov Goodness-of-Fit Test</h3>
<p>해당 예제는 자유도 5인 t분포와 표준정규분포를 따르는 300개의 랜덤
표본을 추출하여 <em>ks.test</em>를 수행한다.</p>
<p>먼저 각각의 분포가 자유도가 2인 t분포를 따르는지 검정한다.</p>
<div class="sourceCode" id="cb256"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co">#t분포 난수 생성</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>rt5 <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">300</span>, <span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="co">#표준정규분포 난수 생성</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>rnn <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">300</span>)</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(rt5, <span class="cf">function</span>(x)<span class="fu">pt</span>(x, <span class="at">df=</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  rt5
## D = 0.066978, p-value = 0.1355
## alternative hypothesis: two-sided</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0:\)</span> 해당 데이터는
자유도가 2인 t분포를 따른다.</li>
<li>귀무가설: <span class="math inline">\(H_1:\)</span> 해당 데이터는
자유도가 2인 t분포를 따르지 않는다.</li>
<li><span class="math inline">\(p-value = 0.4555\)</span></li>
<li>검정통계량 <span class="math inline">\(D = 0.049449\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &lt; p-value =
0.4555\)</span>로 귀무가설 기각 못함. 즉, 해당 데이터는 자유도가 2인
t분포를 따른다고 할 수 있다.</li>
</ul>
<div class="sourceCode" id="cb258"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(rnn, <span class="cf">function</span>(x)<span class="fu">pt</span>(x, <span class="at">df=</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  rnn
## D = 0.087522, p-value = 0.02018
## alternative hypothesis: two-sided</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0:\)</span> 해당 데이터는
자유도가 2인 t분포를 따른다.</li>
<li>귀무가설: <span class="math inline">\(H_1:\)</span> 해당 데이터는
자유도가 2인 t분포를 따르지 않는다.</li>
<li><span class="math inline">\(p-value = 0.02043\)</span></li>
<li>검정통계량 <span class="math inline">\(D = 0.087405\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt; p-value =
0.02043\)</span>로 귀무가설 기각. 즉, 해당 데이터는 자유도가 2인 t분포를
따른다고 할 수 없다.</li>
</ul>
<p>이제 두 데이터가 같은 분포로부터 나왔는지 two-sample test를
진행한다.</p>
<div class="sourceCode" id="cb260"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(rt5, rnn)</span></code></pre></div>
<pre><code>## 
##  Asymptotic two-sample Kolmogorov-Smirnov test
## 
## data:  rt5 and rnn
## D = 0.08, p-value = 0.2923
## alternative hypothesis: two-sided</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0:\)</span> 해당 두 데이터는
같은 분포로부터 나왔다.</li>
<li>귀무가설: <span class="math inline">\(H_1:\)</span> 해당 두 데이터는
같은 분포로부터 나오지 않았다.</li>
<li><span class="math inline">\(p-value = 0.4543\)</span></li>
<li>검정통계량 <span class="math inline">\(D = 0.07\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &lt; p-value =
0.4543\)</span>로 귀무가설 기각 못함. 즉, 두 데이터는 같은 분포로부터
나왔다고 할 수 있다.</li>
</ul>
<p><br></p>
<p><br></p>
<div class="sourceCode" id="cb262"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co">#사용 패키지 불러오기</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HH)</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
</div>
</div>
</div>
<div id="chap6.-one-way-analysis-of-variance" class="section level1">
<h1>Chap6. One-Way Analysis of Variance</h1>
<p>분산분석(ANOVA-Analysis of Variance)는 3개 이상 다수의 집단을 비교할
때 사용하는 가설검정 방법을 의미한다. t-test는 두 개의 집단을 비교할 때
사용되었던 방법이다.</p>
<p>분산분석의 종류</p>
<ul>
<li>One-way ANOVA: 독립변수 1개, 종속변수 1개일 때</li>
<li>Two-way ANOVA: 독립변수 2개, 종속변수 1개일 때</li>
<li>MANOVA(Multiple): (one-way)독립변수 1개, 종속변수 2개일 때,
(two-way)독립변수 2개, 종속변수 2개일 때</li>
<li>ANCOVA(공분산분석): 특정한 독립변수를 두고, 나머지 독립변수는
공변량(Covariance)로 분석하는 방법</li>
</ul>
<p>분산분석은 F-분포를 이용한다.</p>
<p><span class="math inline">\(H_0\)</span>: 모든 집단의 평균은
같다.(<span class="math inline">\(\mu_1 = \mu_2=...=\mu_r\)</span>)
<span class="math inline">\(H_1\)</span>: 모든 <span
class="math inline">\(\mu_i\)</span>는 같지 않다.</p>
<p>R에서 분산분석을 실행하는 함수는 <em>aov</em>와 <em>anova</em> 함수가
있다.</p>
<ul>
<li>aov: Formula = lm(종속변수 ~ 독립변수, data), <em>summary</em>
함수를 이용하여 p-value 확인</li>
<li>anova: summary(aov)와 동일한 결과를 볼 수 있다.</li>
</ul>
<div id="examplecatalyst-data" class="section level2">
<h2>6.1 Example—Catalyst Data</h2>
<p>해당 예제는 catalyst 데이터를 사용하여 그룹 별 concent의 평균 차이가
있는지 검정한다.</p>
<div class="sourceCode" id="cb263"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 로드</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;catalystm&quot;</span>)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 6.1 그룹 별 박스플롯 그리기</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(concent <span class="sc">~</span> catalyst, <span class="at">data=</span>catalystm,</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span>panel.bwplot.superpose, <span class="at">groups=</span>catalyst,</span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="fu">list</span>(<span class="st">&quot;concentration&quot;</span>),</span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">list</span>(<span class="st">&quot;catalyst&quot;</span>))</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-61-1.png" width="960" /></p>
<p>박스플롯 그림을 확인했을 때, D 그룹의 평균이 다른 그룹들에 비해
현저히 낮게 나타나고 있음을 확인했다. <code>aov</code> 함수를 통해
ANOVA(분산분석)을 실시해보았다.</p>
<div class="sourceCode" id="cb264"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co">#종속변수 ~ 그룹</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>catalystm1.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent <span class="sc">~</span> catalyst, <span class="at">data=</span>catalystm)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co">#aov 함수 요약</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catalystm1.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## catalyst     3  85.68   28.56   9.916 0.00144 **
## Residuals   12  34.56    2.88                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb266"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co">#anova 함수 사용 요약</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(catalystm1.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: concent
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## catalyst   3 85.676 28.5586  9.9157 0.001436 **
## Residuals 12 34.562  2.8801                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: catalyst 그룹 별 concent
평균의 차이는 없다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: catalyst 그룹 별 concent
평균의 차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = 0.00144\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value = 9.916\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt; p-value
=0.00144\)</span>로 귀무가설 기각. 즉, catalyst 그룹 별 concent 평균의
차이는 있다고 해석할 수 있다.</li>
</ul>
<p>summary(aov)와 anova 함수 사용 시의 결과가 소수점 자릿수를 제외하고는
동일하게 나타나는 것을 확인할 수 있다.</p>
<p><code>model.tables</code> 함수를 통해 aov와 같은 모델 개체에 대한
요약 테이블을 나타내준다. <em>type</em> = “means”, “effects” 등으로
평균, 효과 등 원하는 유형에 대한 요약 테이블을 나타낸다.</p>
<div class="sourceCode" id="cb268"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co">#모델에 대한 평균 요약 테이블</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(catalystm1.aov, <span class="st">&quot;means&quot;</span>)</span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##         
## 54.4875 
## 
##  catalyst 
##        A     B     C     D
##     56.9 55.77 53.23 51.12
## rep  5.0  4.00  3.00  4.00</code></pre>
<p>전체 평균은 54.49, A: 56.9, B: 55.77, C:53.23, D:51.12의 평균으로
나타난다. 위에서 박스플롯으로 확인했듯이 D 그룹이 다른 그룹과의 차이가
나타난다.</p>
</div>
<div id="random-effects" class="section level2">
<h2>6.4 Random Effects</h2>
<p>해당 예제에서는 catalyst 데이터를 활용하여 임의 효과(random effect)에
대한 실습을 진행한다.</p>
<p>먼저 고정 효과와 임의 효과에 대한 차이를 확인해보겠다.</p>
<ul>
<li>고정 효과(Fixed effect):
<ul>
<li>요인의 수준을 실험자가 직접 지정한 경우, 실험자는 오직 이 수준들의
비교에만 관심이 있다.</li>
<li>EX) 여학생과 남학생의 시험 성적을 비교하고자 할 때, 성별을
고정효과라고 한다.</li>
<li>모형: <span class="math inline">\(y_{ij} =
\mu+\tau_i+\epsilon_{ij},\epsilon_{ij}\sim N(0,\sigma^2)\)</span></li>
<li><span class="math inline">\(\tau_i\)</span>: i번째 수준의 효과</li>
<li>가설: <span class="math inline">\(H_0:
\tau_1=\tau_2=...=\tau_t=0\)</span>, <span class="math inline">\(H_1:
not \space H_0\)</span></li>
</ul></li>
<li>임의 효과(Random effect):
<ul>
<li>요인의 수준이 임의추출된 경우</li>
<li>수준의 효과는 확률변수로 간주되며 분포를 가정한다.</li>
<li>모형: <span class="math inline">\(y_{ij} =
\mu+\tau_i+\epsilon_{ij},\tau_i\sim N(0,\sigma^2_\tau),\epsilon_{ij}\sim
N(0,\sigma^2)\)</span></li>
<li><span class="math inline">\(\tau_i\)</span>: i번째 수준의 효과,
고정효과모형과는 다르게 확률변수이다.</li>
<li>가설: <span class="math inline">\(H_0:\sigma^2_\tau=0\)</span>,
<span class="math inline">\(H_1:\sigma^2_\tau&gt;0\)</span></li>
</ul></li>
</ul>
<p>7장 다중비교에서 더 자세한 내용을 다루겠지만 <code>mmc</code> 함수를
사용하면 분산분석 후 어느 집단에서 차이가 나타나는지 사후 검정을
실시하고 mmcplot으로 시각화할 수 있다. 해당 예제에서는 다양한 다중비교
중 <code>Tukey</code>의 방법을 사용했다.</p>
<div class="sourceCode" id="cb270"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co">#linfct(그룹 = &quot;방법&quot;)</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>catalystm.mmc <span class="ot">&lt;-</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(catalystm1.aov, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">catalyst =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="co">#요약</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>catalystm.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = concent ~ catalyst, data = catalystm) 
## Estimated Quantile = 2.963331 
## 95% family-wise confidence level
## $mca
##     estimate   stderr        lower    upper   height
## A-B 1.125000 1.138447 -2.248596626 4.498597 56.33750
## A-C 3.666667 1.239385 -0.006040148 7.339373 55.06667
## B-C 2.541667 1.296179 -1.299342059 6.382675 54.50417
## A-D 5.775000 1.138447  2.401403374 9.148597 54.01250
## B-D 4.650000 1.200029  1.093916918 8.206083 53.45000
## C-D 2.108333 1.296179 -1.732675393 5.949342 52.17917
## $none
##   estimate    stderr    lower    upper   height
## A 56.90000 0.7589649 54.65094 59.14906 56.90000
## B 55.77500 0.8485486 53.26047 58.28953 55.77500
## C 53.23333 0.9798195 50.32980 56.13686 53.23333
## D 51.12500 0.8485486 48.61047 53.63953 51.12500</code></pre>
<p>요약을 보면 $mca 부분에 각 그룹 별로 1대1 비교한 추정치와 95%
신뢰구간이 나타나는데 신뢰구간이 0을 포함하는 경우에는 그 그룹 간에는
평균 차이가 없다고 해석한다. 즉, A-D, B-D 그룹에서는 차이가 나타나는
것이다. 더 해석하기 쉽도록 신뢰구간에 대한 시각화를 진행하겠다.</p>
<div class="sourceCode" id="cb272"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 6.2 다중비교 시각화</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.mmc, <span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-65-1.png" width="960" /></p>
<p>해당 그립에서 아래 Tiebreaker 그림이 각 그룹 별 차이에 대한
신뢰구간을 나타내는 그림인데, 빨간색으로 표시된 부분은 0을 포함하지 않아
평균 차이가 있는 것으로 도출된 그룹이다. 위에서 요약 값으로 확인한 것과
동일한 결과이다.</p>
</div>
<div id="example-batch-data" class="section level2">
<h2>6.7 Example-Batch Data</h2>
<p>해당 예제는 batch 데이터를 사용하여 Batch 별 Calcium의 평균에 차이가
있는지 검정한다.</p>
<div class="sourceCode" id="cb273"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 로드</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(batch)</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="co">#각 그룹 별 박스플롯</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-66-1.png" width="960" /></p>
<p>박스플롯을 보면 1,2,3 그룹과 4,5 그룹 간의 평균 차이가 있을 것으로
보인다. 분산분석을 실시한다.</p>
<div class="sourceCode" id="cb274"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co">#분산분석 진행</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>batch1.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(batch1.aov)</span></code></pre></div>
<pre><code>##             Df  Sum Sq Mean Sq F value  Pr(&gt;F)   
## Batch        4 0.09698 0.02424   5.535 0.00363 **
## Residuals   20 0.08760 0.00438                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb276"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(batch1.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Calcium
##           Df   Sum Sq  Mean Sq F value   Pr(&gt;F)   
## Batch      4 0.096976 0.024244  5.5352 0.003626 **
## Residuals 20 0.087600 0.004380                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: Batch 그룹 별 Calcium
평균의 차이는 없다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: Batch 그룹 별 Calcium
평균의 차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = 0.003626\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value =
5.5352\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt; p-value
=0.003626\)</span>로 귀무가설 기각. 즉, Batch 그룹 별 Calcium 평균의
차이는 있다고 해석할 수 있다.</li>
</ul>
<p>분산분석의 기본 가정 중 하나는 등분산성을 만족하는 것이다. 여기서,
등분산이란 그룹간의 분산이 서로 같다는 것을 의미한다.<br />
등분산 검정의 귀무가설과 대립가설은 다음과 같다.</p>
<ul>
<li>H0: 모든 분산이 동일하다. (등분산성을 만족한다.)</li>
<li>H1: 모든 분산이 동일하지않다. (등분산성을 만족하지 않는다.)</li>
</ul>
<p>해당 예제에서는 <em>Homogeneity of Variance test</em>를 통해 각 그룹
별 등분산성을 만족하는지 화인하고 결과를 시각화한다. HH 패키지에서
제공하는 <em>hovBF</em> 함수를 사용한다.
Folmula(종속변수~독립변수(그룹)) <em>hovplotBF</em> 함수를 사용하여
등분산성 테스트 결과를 시각화 할 수 있다.</p>
<div class="sourceCode" id="cb278"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co">#등분산성 test</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hovBF</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span></code></pre></div>
<pre><code>## 
##  hov: Brown-Forsyth
## 
## data:  Calcium
## F = 0.032193, df:Batch = 4, df:Residuals = 20, p-value = 0.9978
## alternative hypothesis: variances are not identical</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: Batch 그룹 별 Calcium
모든 분산이 동일하다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: Batch 그룹 별 Calcium
모든 분산이 동일하지 않다.\)</span></li>
<li><span class="math inline">\(p-value = 0.9978\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value =
0.032193\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &lt; p-value
=0.9978\)</span>로 귀무가설 기각 못함. 즉, 등분산성을 만족한다고 해석할
수 있다.</li>
</ul>
<div class="sourceCode" id="cb280"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 6.3 - 등분산성 테스트 시각화</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hovplotBF</span>(Calcium<span class="sc">~</span>Batch,<span class="at">data=</span>batch)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-69-1.png" width="960" /></p>
<p>왼쪽 패널의 경우, 그룹 간 평균을 기준으로 동질성 검정을 실시한
그림이고, 중앙 패널의 경우, 그룹 간 중앙값을 기준으로, 오른쪽 패널의
경우, 중앙 패널에 절대값을 적용한 그림이다.</p>
</div>
<div id="exampleturkey-data" class="section level2">
<h2>6.8 Example—Turkey Data</h2>
<p>해당 예제는 Turkey 데이터를 활용하여 처리 효과를 비교하는데 사용되는
직교대비 실습을 진행한다. 직교대비는 평균의 특정 선형결합에 대한 가설을
검정하는데 사용되는 방법이다. 대조는 귀무 가설이 참일 때 비교의 기대값이
0이 되도록 둘 이상의 평균을 비교하는 것이다.</p>
<div id="data-description" class="section level3">
<h3>6.8.2 Data Description</h3>
<div class="sourceCode" id="cb281"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 로드</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(turkey)</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a><span class="co">#그룹 별 박스플롯</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(wt.gain <span class="sc">~</span> diet, <span class="at">data=</span>turkey, <span class="at">groups=</span>diet,</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span>panel.bwplot.superpose, <span class="at">xlab=</span><span class="st">&quot;diet&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight Gain&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-70-1.png" width="960" /></p>
<p>박스플롯에서는 B2 그룹이 다른 그룹과의 큰 차이가 나타나고, control
그룹 또한 가장 낮은 평균을 보인다.</p>
<p>먼저 분산분석을 진행한다.</p>
<div class="sourceCode" id="cb282"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ANOVA</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>turkey.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.gain <span class="sc">~</span> diet, <span class="at">data=</span>turkey)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## diet         4 103.04  25.759   81.67 5.6e-14 ***
## Residuals   25   7.89   0.315                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb284"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(turkey.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: wt.gain
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## diet       4 103.038 25.7595  81.672 5.598e-14 ***
## Residuals 25   7.885  0.3154                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: Diet 그룹 별 몸무게
평균의 차이는 없다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: Diet 그룹 별 몸무게
평균의 차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = 5.6e-14\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value = 81.67\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt; p-value
=0.5.6e-16\)</span>로 귀무가설 기각. 즉, Diet 그룹 별 몸무게 평균의
차이는 있다고 해석할 수 있다.</li>
</ul>
<p>각 다이어트 방법 별 체중 증가 평균에 대한 table을
<code>model.tables</code> 함수를 사용하여 확인했다. <em>se=TRUE</em>
옵션은 표준오차에 대한 값도 나타낸다는 의미이다.</p>
<div class="sourceCode" id="cb286"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(turkey.aov,<span class="at">type=</span><span class="st">&quot;means&quot;</span>,<span class="at">se=</span><span class="cn">TRUE</span>) <span class="co">#se=TRUE - 평균 차이에 대한 표준오차 값</span></span></code></pre></div>
<pre><code>## Tables of means
## Grand mean
##      
## 6.53 
## 
##  diet 
## diet
## control      A1      A2      B1      B2 
##   3.783   5.500   6.983   7.000   9.383 
## 
## Standard errors for differences of means
##           diet
##         0.3242
## replic.      6</code></pre>
<p>전체 평균은 6.53, control 그룹이 3.783으로 가장 낮고, 각 다이어트
방법 별 체중 증가 평균이 가장 큰 것은 B2 방법이다.</p>
</div>
</div>
<div id="interpretation" class="section level2">
<h2>6.8.4 Interpretation</h2>
<p>다양한 처리 형태에 대한 비교가 필요할 때 직교 대비를 사용하게 된다.
해당 책에서는 단순 다중비교 뿐만 아니라 4가지의 알아내고자 하는 것을
제시했다.</p>
<ol style="list-style-type: decimal">
<li>trt.vs.control: 단순한 대조군과 처리군에 대한 비교로 첨가제를 먹은
칠면조와 그렇지 않은 칠면조를 비교하는 것</li>
<li>additive: 첨가제 A와 첨가제 B의 간의 차이</li>
<li>amount: 첨가제에 1의 양을 추가했을 때와 2의 양을 추가했을 때의
차이(첨가제 양에 대한 비교)</li>
<li>interaction between additive and amount: 첨가제 종류와 첨가제 양의
상호작용</li>
</ol>
<p>R의 <em>contrasts</em> 함수를 이용해서 대비계수를 직접 설정하거나
자동적으로 설정할 수 있다.</p>
<div class="sourceCode" id="cb288"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co">#대비계수 자동 설정</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet)</span></code></pre></div>
<pre><code>##         A1 A2 B1 B2
## control  0  0  0  0
## A1       1  0  0  0
## A2       0  1  0  0
## B1       0  0  1  0
## B2       0  0  0  1</code></pre>
<div class="sourceCode" id="cb290"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co">#대비계수 직접 설정 - 위에서 소개한 4가지에 따라서 각각 다른 weight를 준다는 느낌</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet)<span class="ot">&lt;-</span></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">control.vs.treatment=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>),</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">amount =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B.by.amount =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet)</span></code></pre></div>
<pre><code>##         control.vs.treatment A.vs.B amount A.vs.B.by.amount
## control                 1.00    0.0    0.0              0.0
## A1                     -0.25    0.5    0.5              0.5
## A2                     -0.25    0.5   -0.5             -0.5
## B1                     -0.25   -0.5    0.5             -0.5
## B2                     -0.25   -0.5   -0.5              5.0</code></pre>
<p>각 첨가제(Diet) 별 체중 증가(wt.gain)에 대한 평균을 대비계수에 따라서
계산해보았다. 그룹 별 계산은 dplyr 패키지 내에 있는 <em>tapply</em>를
사용하였다.</p>
<div class="sourceCode" id="cb292"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(turkey,{</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tapply</span>(wt.gain, diet, mean) <span class="sc">%*%</span> <span class="fu">contrasts</span>(diet)</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>##      control.vs.treatment A.vs.B    amount A.vs.B.by.amount
## [1,]            -3.433333  -1.95 -1.933333           42.675</code></pre>
<p>앞서 설정한 contrasts(대비)에 따른 검정을 진행한다. <em>split</em>에
보고자 하는 대비를 넣어주면 각각 검정이 시행되어 결과가 나온다.</p>
<div class="sourceCode" id="cb294"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>turkey2.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.gain<span class="sc">~</span>diet,<span class="at">data=</span>turkey)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="co">#기본 ANOVA</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey2.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## diet         4 103.04  25.759   81.67 5.6e-14 ***
## Residuals   25   7.88   0.315                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb296"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co">#결과창이 너무 길어 한 줄로 나타나지 않을 때 넓이 조절해주는 옵션</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>old.width <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">width=</span><span class="dv">67</span>)</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="co">#대비에 따른 비교 검정</span></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey2.aov,</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">split=</span><span class="fu">list</span>(<span class="at">diet=</span><span class="fu">list</span>(</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">control.vs.treatment=</span><span class="dv">1</span>,</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">A.vs.B=</span><span class="dv">2</span>,</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">amount=</span><span class="dv">3</span>,</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">A.vs.B.by.amount=</span><span class="dv">4</span></span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>        )))</span></code></pre></div>
<pre><code>##                              Df Sum Sq Mean Sq F value   Pr(&gt;F)
## diet                          4 103.04   25.76  81.672 5.60e-14
##   diet: control.vs.treatment  1  56.58   56.58 179.395 6.58e-13
##   diet: A.vs.B                1  22.81   22.81  72.337 7.56e-09
##   diet: amount                1  22.43   22.43  71.105 8.88e-09
##   diet: A.vs.B.by.amount      1   1.21    1.21   3.852   0.0609
## Residuals                    25   7.88    0.32                 
##                                 
## diet                         ***
##   diet: control.vs.treatment ***
##   diet: A.vs.B               ***
##   diet: amount               ***
##   diet: A.vs.B.by.amount     .  
## Residuals                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb298"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(old.width)</span></code></pre></div>
<p>anova 해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: Diet 그룹 별 몸무게
평균의 차이는 없다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: Diet 그룹 별 몸무게
평균의 차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = 5.6e-14\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value = 81.67\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt; p-value
=0.5.6e-16\)</span>로 귀무가설 기각. 즉, Diet 그룹 별 몸무게 평균의
차이는 있다고 해석할 수 있다. 대비에 따른 비교 검정 해석:
A.vs.B.by.amount에 대해서는 <span
class="math inline">\(p-value=0.0609\)</span>로 나와 0.1 수준에서
귀무가설을 기각할 수 있었다. 나머지 비교들은 모두 0.05 수준에서
귀무가설을 기각하여 해당 관심 비교 대상에 대해 차이가 나타나고 있음을
확인할 수 있다.</li>
</ul>
</div>
<div id="a-appendix-computation-for-the-analysis-of-variance"
class="section level2">
<h2>6.A Appendix: Computation for the Analysis of Variance</h2>
<p>catalystm 데이터에 대한 분산을 직접 계산하는 예시이다.</p>
<div class="sourceCode" id="cb299"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 로드</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(catalystm)</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="co">#분산분석</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>catalystm.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent <span class="sc">~</span> catalyst,</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data=</span>catalystm)</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(catalystm.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: concent
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## catalyst   3 85.676 28.5586  9.9157 0.001436 **
## Residuals 12 34.562  2.8801                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb301"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co">#효과(기본값=&quot;effects&quot;)에 대한 요약 테이블</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(catalystm.aov)</span></code></pre></div>
<pre><code>## Tables of effects
## 
##  catalyst 
##         A     B      C      D
##     2.412 1.287 -1.254 -3.362
## rep 5.000 4.000  3.000  4.000</code></pre>
<div class="sourceCode" id="cb303"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co">#proj - 모델을 행렬로 반환하는 함수</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>Proj <span class="ot">&lt;-</span> <span class="fu">proj</span>(catalystm.aov)</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>Proj <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Proj,<span class="at">Sum=</span><span class="fu">apply</span>(Proj,<span class="dv">1</span>,sum))</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>Proj</span></code></pre></div>
<pre><code>##    (Intercept)  catalyst  Residuals  Sum
## 1      54.4875  2.412500  1.3000000 58.2
## 2      54.4875  2.412500  0.3000000 57.2
## 3      54.4875  2.412500  1.5000000 58.4
## 4      54.4875  2.412500 -1.1000000 55.8
## 5      54.4875  2.412500 -2.0000000 54.9
## 6      54.4875  1.287500  0.5250000 56.3
## 7      54.4875  1.287500 -1.2750000 54.5
## 8      54.4875  1.287500  1.2250000 57.0
## 9      54.4875  1.287500 -0.4750000 55.3
## 10     54.4875 -1.254167 -3.1333333 50.1
## 11     54.4875 -1.254167  0.9666667 54.2
## 12     54.4875 -1.254167  2.1666667 55.4
## 13     54.4875 -3.362500  1.7750000 52.9
## 14     54.4875 -3.362500 -1.2250000 49.9
## 15     54.4875 -3.362500 -1.1250000 50.0
## 16     54.4875 -3.362500  0.5750000 51.7</code></pre>
<div class="sourceCode" id="cb305"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 열 별 x^2 계산</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(Proj,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## (Intercept)    catalyst   Residuals         Sum 
## 47502.20250    85.67583    34.56167 47622.44000</code></pre>
<p>catalyst 즉, 효과에 대한 sum of squares의 값이 85.67, 잔차에 대한
SS값이 34.56으로 나타났다. 그렇다면 더미변수로 적용한 lm에서도 동일한
결과가 나타나는지 확인한다.</p>
<div class="sourceCode" id="cb307"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co">#기본 대비 계수</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(catalystm<span class="sc">$</span>catalyst)</span></code></pre></div>
<pre><code>##   B C D
## A 0 0 0
## B 1 0 0
## C 0 1 0
## D 0 0 1</code></pre>
<div class="sourceCode" id="cb309"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co">#모델 매트릭스로 변환</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(catalystm.aov)[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>##    catalystB catalystC catalystD
## 1          0         0         0
## 2          0         0         0
## 3          0         0         0
## 4          0         0         0
## 5          0         0         0
## 6          1         0         0
## 7          1         0         0
## 8          1         0         0
## 9          1         0         0
## 10         0         1         0
## 11         0         1         0
## 12         0         1         0
## 13         0         0         1
## 14         0         0         1
## 15         0         0         1
## 16         0         0         1</code></pre>
<div class="sourceCode" id="cb311"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co">#일반 선형 회귀 적용 - A가 기본으로 통제 그룹</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>catalystm.lm <span class="ot">&lt;-</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(concent <span class="sc">~</span> X[,<span class="st">&quot;catalystB&quot;</span>]<span class="sc">+</span>X[,<span class="st">&quot;catalystC&quot;</span>]<span class="sc">+</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>       X[,<span class="st">&quot;catalystD&quot;</span>],<span class="at">data=</span>catalystm)</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(catalystm.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: concent
##                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## X[, &quot;catalystB&quot;]  1  8.841   8.841  3.0696 0.105259    
## X[, &quot;catalystC&quot;]  1  2.722   2.722  0.9453 0.350118    
## X[, &quot;catalystD&quot;]  1 74.112  74.112 25.7323 0.000274 ***
## Residuals        12 34.562   2.880                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>해당 결과 각 요인들에 대한 SS 값을 모두 합쳐보면 위에서 계산한
85.67의 값이 도출된다.</p>
</div>
<div id="b-object-oriented-programming" class="section level2">
<h2>6.B Object Oriented Programming</h2>
<p>다양한 변수 class에 대해 그림이 어떻게 그려지는지 확인한다.</p>
<div class="sourceCode" id="cb313"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">AA=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">8</span>),</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">BB=</span><span class="fu">factor</span>(letters[<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">8</span>)]),</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">CC=</span><span class="fu">ts</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">8</span>)),</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div>
<pre><code>##   AA BB CC
## 1  5  e  5
## 2  6  f  6
## 3  8  h  8
## 4  7  g  7
## 5  8  h  8</code></pre>
<div class="sourceCode" id="cb315"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 변수의 class 확인</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(tmp,class)</span></code></pre></div>
<pre><code>##        AA        BB        CC 
## &quot;numeric&quot;  &quot;factor&quot;      &quot;ts&quot;</code></pre>
<p>AA는 numeric, BB는 factor, CC는 ts로 나타난다. 여기서 ts는 시계열
데이터로 생각할 수 있다. 각 클래스에 대해 <code>plot</code> 함수를
지정했을 때의 결과를 살펴본다.</p>
<div class="sourceCode" id="cb317"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co">#일반 산점도</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmp<span class="sc">$</span>AA)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-80-1.png" width="960" /></p>
<div class="sourceCode" id="cb318"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co">#barchart</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmp<span class="sc">$</span>BB)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-80-2.png" width="960" /></p>
<div class="sourceCode" id="cb319"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co">#선 그림</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmp<span class="sc">$</span>CC)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-80-3.png" width="960" /></p>
<div class="sourceCode" id="cb320"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(catalystm.aov)</span></code></pre></div>
<pre><code>## [1] &quot;aov&quot; &quot;lm&quot;</code></pre>
<div class="sourceCode" id="cb322"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catalystm.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## catalyst     3  85.68   28.56   9.916 0.00144 **
## Residuals   12  34.56    2.88                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb324"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>old.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="co">#잔차에 대한 그림 4가지</span></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(catalystm.aov)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-81-1.png" width="960" /></p>
<div class="sourceCode" id="cb325"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co">#한번에 보여주기</span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(old.par)</span></code></pre></div>
<p><br></p>
<p><br></p>
</div>
</div>
<div id="chap7.-multiple-comparisons" class="section level1">
<h1>Chap7. Multiple Comparisons</h1>
<p>Chap6에서 분산분석(ANOVA)을 통해 3개 이상 다수의 집단을 비교하였다.
이때, 대립가설은 <span class="math inline">\(H_1\)</span>: 모든 <span
class="math inline">\(\mu_i\)</span>는 같지 않다.로 즉, 적어도 하나의
집단 간은 차이가 존재한다는 의미이다.</p>
<p>하지만 분산분석 결과로는 집단 간의 차이 존재 여부만 확인할 수 있을 뿐
어느 집단 간에서 차이가 나타나는지 그 차이는 어느 정도 되는지 확인할 수
없다.</p>
<p>이때 사용하는 분석이 Chap7의 내용인 Multiple Comparisons(다중 비교,
사후 분석)이다. 다중 비교를 통해 모평균 사이의 크고 작음을 구체적으로
설명하는 개별 비교를 수행한다.</p>
<p>ex) 집단이 A,B,C 3개라면 3번의 비교를 진행하는 것이다. A-B, A-C,
B-C</p>
<p>개별 검정 뿐 아니라 한 연구의 에러를 줄이는 방법이 필요하다. 즉, 한
연구에서 나올 수 있는 잘못된 결과를 줄이자 라는 것이 다중 비교 보정의
핵심이다.</p>
<p>여기서 family-wise type 1 error 의 개념이 등장한다.</p>
<ul>
<li>Family-wise type 1 error rate (FWER): 한 연구에서 적어도 한 개의
잘못된 결론 (false positive)이 나올 수 있는 확률 ex)FWER이 0.05 라면 한
연구에서 적어도 1개의 잘못된 결론이 나올 확률이 0.05 라는 것</li>
</ul>
<div id="multiple-comparison-procedures" class="section level2">
<h2>7.1 Multiple Comparison Procedures</h2>
<p>다중 비교 보정 방법에는 Bonferroni, Tukey, Dunnett, Scheffe가
있다.</p>
<ul>
<li><code>Bonferroni</code>
<ul>
<li>test의 수가 n이고, FWER 를 0.05 로 통제할 때, 개별 테스트의
유의수준을 alpha/m 으로 설정</li>
<li>모든 검정이 실제로 연관성이 없는 경우 (null인 경우), 아래 식이 m이
클수록 대략적으로 만족됨.</li>
<li>보수적(귀무가설을 웬만하면 기각하지 않는다) <span
class="math inline">\(FWER = 1-(1-\alpha/m)^m = \alpha\)</span></li>
</ul></li>
<li><code>Tukey</code>
<ul>
<li>집단의 크기가 같은 경우 사용하는 것이 바람직</li>
<li>모든 가능한 두 평균 간의 비교에 유용</li>
<li>대체로 보수적</li>
</ul></li>
<li><code>Dunnett</code>
<ul>
<li>하나의 집단을 기준으로 다른 집단들과 차이에 대하여 분석하는 방법
ex)치료군 vs 대조군(다른 치료군들은 관심 없음)</li>
<li>높은 검정력</li>
<li>모든 집단 조합에 대해 검정하지 않음</li>
</ul></li>
<li><code>Scheffe</code>
<ul>
<li>여러 개의 대비를 동시에 비교하거나 표본이 서로 다를 때 유용</li>
<li>가장 보수적 검정으로 비교적 높은 신뢰도</li>
</ul></li>
</ul>
<div id="the-dunnett-procedure-for-comparing-one-mean-with-all-others"
class="section level3">
<h3>7.1.3 The Dunnett Procedure for Comparing One Mean with All
Others</h3>
<p>위에서 살펴 본 다중 비교 방법 중 <code>Dunnett</code> 방법을 적용한
예시이다.</p>
<div class="sourceCode" id="cb326"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co">#분산분석 실행</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(weightloss) <span class="co">#HH 패키지 내의 데이터 로드</span></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>weightloss.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(loss <span class="sc">~</span> group,<span class="at">data=</span>weightloss)</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(weightloss.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## group        4  59.88  14.970   15.07 6.88e-08 ***
## Residuals   45  44.70   0.993                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: 그룹 별 loss 평균의
차이는 없다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: 그룹 별 loss 평균의
차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = 6.88e-08\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value = 15.07\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt;
p-value=6.588e-08\)</span>로 귀무가설 기각. 즉, 그룹 별 loss 평균의
차이는 있다고 할 수 있다.</li>
</ul>
<div class="sourceCode" id="cb328"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 7.1 - 그룹 별 loss 값 박스 플롯</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(weightloss, <span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>loss)) <span class="sc">+</span> </span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-83-1.png" width="960" /></p>
<p>그룹 간 차이가 나타나는 것이 보이고, 그 중에서도 D 그룹이 다른 그룹
들에 비해 낮은 평균을 가지고 있는 것을 확인했다.</p>
<p>이후, Dunnett 기법을 적용하여 D그룹을 control group으로 지정하여 다른
그룹 간의 비교를 하고 시각화를 진행한다.</p>
<p>R에서는 <code>glht</code>함수를 통해 일반화된 선형 가설 검정과
다중비교를 진행할 수 있다.<br />
우측검정: (alternative=‘greater’), dunnett 방법: mcp를 통해 linfct의
옵션을 세부적으로 설정</p>
<ul>
<li><code>glht(model,linfct=mcp(그룹변수=다중비교방법))</code>
<ul>
<li><em>model</em>: 분산분석의 결과가 저장된 객체</li>
<li><em>linfct</em>: 다중비교 방법을 지정</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb329"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>weightloss.dunnett <span class="ot">&lt;-</span> <span class="fu">glht</span>(weightloss.aov,</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group=</span><span class="fu">contrMat</span>(<span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">5</span>), <span class="at">base=</span><span class="dv">4</span>)),</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>)</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>weightloss.dunnett <span class="co">#각 그룹 간의 평균 차이 값 확인</span></span></code></pre></div>
<pre><code>## 
##   General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Linear Hypotheses:
##            Estimate
## 1 - 4 &lt;= 0     2.78
## 2 - 4 &lt;= 0     1.75
## 3 - 4 &lt;= 0     1.00
## 5 - 4 &lt;= 0     2.90</code></pre>
<div class="sourceCode" id="cb331"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(weightloss.dunnett) <span class="co">#결과 요약</span></span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: aov(formula = loss ~ group, data = weightloss)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;t)    
## 1 - 4 &lt;= 0   2.7800     0.4457   6.237 &lt;0.001 ***
## 2 - 4 &lt;= 0   1.7500     0.4457   3.926 &lt;0.001 ***
## 3 - 4 &lt;= 0   1.0000     0.4457   2.243 0.0479 *  
## 5 - 4 &lt;= 0   2.9000     0.4457   6.506 &lt;0.001 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>summary 결과를 보면 각 그룹과 D의 평균 차이의 결과가 나온다. 모든
그룹과 D에서 차이가 있는 것으로 나오지만, C그룹과 D그룹의 차이에서는
p-value 값이 0.04로 아주 큰 차이가 나타난다고는 볼 수 없다.</p>
<div class="sourceCode" id="cb333"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co">#시각화</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weightloss.dunnett)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-85-1.png" width="960" /></p>
<p>시각화 그림을 통해서도 모두 평균 차이의 boundary가 0 이상임을 확인할
수 있고, C-D의 그림은 0과 매우 가까운 것으로 보아 아주 큰 차이가
나타나지는 않는다.</p>
</div>
<div id="mmc-적용" class="section level3">
<h3>mmc 적용</h3>
<p><code>HH</code> 패키지 내에 있는 <em>mmc</em> 함수를 통해서도 다중
비교를 진행할 수 있다. <code>mmc</code>함수의 경우의 입력방법은 앞서
살펴본 <code>glht</code>함수와 상당히 유사하다.</p>
<div class="sourceCode" id="cb334"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>weightloss.mmc <span class="ot">&lt;-</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(weightloss.aov,</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group=</span><span class="fu">contrMat</span>(<span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">5</span>), <span class="at">base=</span><span class="dv">4</span>)),</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>)</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>weightloss.mmc <span class="co">#결과 요약(summary 하지 않아도 됨)</span></span></code></pre></div>
<pre><code>## Dunnett contrasts
## Fit: aov(formula = loss ~ group, data = weightloss) 
## Estimated Quantile = -2.221828 
## 95% family-wise confidence level
## $mca
##     estimate stderr       lower upper height
## 5-4     2.90   -Inf 1.909641542   Inf 10.720
## 1-4     2.78   -Inf 1.789641542   Inf 10.660
## 2-4     1.75   -Inf 0.759641542   Inf 10.145
## 3-4     1.00   -Inf 0.009641542   Inf  9.770
## $none
##   estimate stderr     lower upper height
## E    12.17   -Inf 11.469711   Inf  12.17
## A    12.05   -Inf 11.349711   Inf  12.05
## B    11.02   -Inf 10.319711   Inf  11.02
## C    10.27   -Inf  9.569711   Inf  10.27
## D     9.27   -Inf  8.569711   Inf   9.27</code></pre>
<div class="sourceCode" id="cb336"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co">#시각화</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(weightloss.mmc, <span class="at">h=</span><span class="fu">c</span>(.<span class="dv">80</span>, .<span class="dv">20</span>), <span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-87-1.png" width="960" /></p>
<p><code>glht</code> 함수를 적용했을 때와 동일한 결과가 도출된다.</p>
</div>
<div
id="simultaneously-comparing-all-possible-contrasts-scheffe-and-extended-tukey"
class="section level3">
<h3>7.1.4 Simultaneously Comparing All Possible Contrasts Scheff´e and
Extended Tukey</h3>
<p>이번에는 다중 비교 보정 방법 중 Scheff의 방법을 적용하는 예시이다.
사용 데이터는 turkey이다.</p>
<div class="sourceCode" id="cb337"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 로드</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(turkey)</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>turkey.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wt.gain <span class="sc">~</span> diet, <span class="at">data=</span>turkey)</span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turkey.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## diet         4 103.04  25.759   81.67 5.6e-14 ***
## Residuals   25   7.89   0.315                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb339"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그룹 별 박스 플롯</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(turkey, <span class="fu">aes</span>(<span class="at">x=</span>diet, <span class="at">y=</span>wt.gain)) <span class="sc">+</span> </span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-88-1.png" width="960" /></p>
<p>6장에서 살펴본 결과와 동일하게 그룹 별 차이가 있음을 확인할 수
있다.</p>
<p>Scheff의 사후 분석을 하기 위해서는 비교할 대상에 대한 contrast
matrix를 생성한다.</p>
<div class="sourceCode" id="cb340"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scheffe method에 calpha 구하기</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>scheffe.quantile <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">qf</span>(.<span class="dv">95</span>,<span class="dv">4</span>,<span class="dv">25</span>))</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a><span class="co">#contrast matrix 생성</span></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>turkey.lmat <span class="ot">&lt;-</span></span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">control.vs.treatment=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>,<span class="sc">-</span>.<span class="dv">25</span>),</span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B              =</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>,  .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span> ),</span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">amount              =</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>,  .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span> ),</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">A.vs.B.by.amount    =</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>,  .<span class="dv">5</span> ))</span>
<span id="cb340-10"><a href="#cb340-10" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(turkey.lmat) <span class="ot">&lt;-</span> <span class="fu">row.names</span>(<span class="fu">contrasts</span>(turkey<span class="sc">$</span>diet))</span></code></pre></div>
<p>첫 번째의 경우 control과 나머지 그룹을 비교하기 위해
(1,-.25,-.25,-.25,-.25)로 설정한 것을 확인할 수 있다. 나머지 contrast
matrix들도 비교하고자 하는 집단에 따라 구성됐다.</p>
<p>이제 <code>mmc</code>를 사용하여 Scheff의 사후 분석을 진행한다.
focus.lmat에 constrast matrix를 넣어줘야 한다.</p>
<div class="sourceCode" id="cb341"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>turkey.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(turkey.aov, <span class="at">calpha=</span>scheffe.quantile, <span class="at">focus=</span><span class="st">&quot;diet&quot;</span>,</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">focus.lmat=</span>turkey.lmat,</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">estimate.sign=</span><span class="dv">0</span>, <span class="at">order.contrasts=</span><span class="cn">FALSE</span>)</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>turkey.mmc<span class="sc">$</span>lmat <span class="co">#summary 결과</span></span></code></pre></div>
<pre><code>##                       estimate    stderr      lower     upper   height
## control.vs.treatment -3.433333 0.2563364 -4.2848503 -2.581816 5.500000
## A.vs.B               -1.950000 0.2292742 -2.7116199 -1.188380 7.216667
## amount               -1.933333 0.2292742 -2.6949532 -1.171713 7.216667
## A.vs.B.by.amount      0.450000 0.2292742 -0.3116199  1.211620 7.216667</code></pre>
<p>95% 신뢰구간에서 0을 포함한 경우는 해당 집단 간의 평균 차이가 없다고
해석한다. 사후 분석 결과를 시각화하여 나타내면 다음과 같다.</p>
<div class="sourceCode" id="cb343"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 7.4</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="co">#시각화</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(turkey.mmc, <span class="at">type=</span><span class="st">&quot;lmat&quot;</span>, <span class="at">style=</span><span class="st">&quot;confint&quot;</span>, <span class="at">axis.right=</span><span class="fl">2.3</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-91-1.png" width="960" /></p>
<div class="sourceCode" id="cb344"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 7.5</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(turkey.mmc, <span class="at">style=</span><span class="st">&quot;both&quot;</span>) <span class="co">#모든 그룹 기준</span></span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-91-2.png" width="960" /></p>
<div class="sourceCode" id="cb345"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co">#그림 7.6</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="co">#대비 기준 - type=&#39;lmat&#39; 지정</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(turkey.mmc, <span class="at">type=</span><span class="st">&quot;lmat&quot;</span>, <span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-91-3.png" width="960" /></p>
<div class="sourceCode" id="cb346"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>turkey.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = wt.gain ~ diet, data = turkey) 
## Estimated Quantile = 3.321873 
## 95% family-wise confidence level
## $mca
##              estimate    stderr      lower    upper   height
## A1-control 1.71666667 0.3242427  0.6395735 2.793760 4.641667
## A2-control 3.20000000 0.3242427  2.1229068 4.277093 5.383333
## B1-control 3.21666667 0.3242427  2.1395735 4.293760 5.391667
## B2-control 5.60000000 0.3242427  4.5229068 6.677093 6.583333
## A2-A1      1.48333333 0.3242427  0.4062402 2.560427 6.241667
## B1-A1      1.50000000 0.3242427  0.4229068 2.577093 6.250000
## B2-A1      3.88333333 0.3242427  2.8062402 4.960427 7.441667
## B1-A2      0.01666667 0.3242427 -1.0604265 1.093760 6.991667
## B2-A2      2.40000000 0.3242427  1.3229068 3.477093 8.183333
## B2-B1      2.38333333 0.3242427  1.3062402 3.460427 8.191667
## $none
##         estimate    stderr    lower     upper   height
## control 3.783333 0.2292742 3.021713  4.544953 3.783333
## A1      5.500000 0.2292742 4.738380  6.261620 5.500000
## A2      6.983333 0.2292742 6.221713  7.744953 6.983333
## B1      7.000000 0.2292742 6.238380  7.761620 7.000000
## B2      9.383333 0.2292742 8.621713 10.144953 9.383333
## $lmat
##                       estimate    stderr      lower     upper   height
## control.vs.treatment -3.433333 0.2563364 -4.2848503 -2.581816 5.500000
## A.vs.B               -1.950000 0.2292742 -2.7116199 -1.188380 7.216667
## amount               -1.933333 0.2292742 -2.6949532 -1.171713 7.216667
## A.vs.B.by.amount      0.450000 0.2292742 -0.3116199  1.211620 7.216667</code></pre>
<ul>
<li>type=“lmat”: 설정한 contrast matrix에 대한 차이의 그림</li>
<li>style=“both”: MMC Plot + Tiebreaker</li>
<li>style=“confint”: 신뢰구간(Tiebreaker)에 대한 그림만 나옴</li>
</ul>
<p>각 옵션에 맞게 <em>mmcplot</em> 함수를 사용하여 원하는 그림을 그릴 수
있다.</p>
</div>
</div>
<div id="the-mean-mean-multiple-comparisons-display-mmc-plot"
class="section level2">
<h2>7.2 The Mean-Mean Multiple Comparisons Display (MMC Plot)</h2>
<div id="difficulties-with-standard-displays" class="section level3">
<h3>7.2.1 Difficulties with Standard Displays</h3>
<div class="sourceCode" id="cb348"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 로드</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;catalystm&quot;</span>)</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova 적용</span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>catalystm1.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(concent <span class="sc">~</span> catalyst, <span class="at">data=</span>catalystm)</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(catalystm1.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## catalyst     3  85.68   28.56   9.916 0.00144 **
## Residuals   12  34.56    2.88                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: catalyst 별 concent
평균의 차이는 없다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: catalyst 별 concent
평균의 차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = 0.00144\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value = 9.916\)</span></li>
<li>유의수준 <span class="math inline">\(0.05 &gt;
p-value=0.00144\)</span>로 귀무가설 기각. 즉, catalyst 별 concent 평균의
차이는 있다고 할 수 있다.</li>
</ul>
<p>이제 어디에서 차이가 나타나는지 <code>tukey</code>의 사후검정을
진행한다.</p>
<div class="sourceCode" id="cb350"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tukey 사후검정</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>catalystm.glht <span class="ot">&lt;-</span></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">glht</span>(catalystm1.aov, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">catalyst =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(catalystm.glht)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = concent ~ catalyst, data = catalystm)
## 
## Quantile = 2.9681
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##            Estimate lwr     upr    
## B - A == 0 -1.1250  -4.5040  2.2540
## C - A == 0 -3.6667  -7.3452  0.0119
## D - A == 0 -5.7750  -9.1540 -2.3960
## C - B == 0 -2.5417  -6.3888  1.3055
## D - B == 0 -4.6500  -8.2118 -1.0882
## D - C == 0 -2.1083  -5.9555  1.7388</code></pre>
<p>해석:</p>
<p>신뢰구간이 0을 포함하는 경우에는 차이가 없다고 해석한다. 즉, D-A와
D-B를 제외한 나머지 조합(pairwise) 비교는 차이가 없다고 나타난다.</p>
<div class="sourceCode" id="cb352"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co">#신뢰구간 시각화 - 그림 7.7</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.glht, <span class="at">order.contrasts=</span><span class="cn">FALSE</span>, <span class="at">estimate.sign=</span><span class="dv">0</span>, <span class="at">focus=</span><span class="st">&quot;catalyst&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-94-1.png" width="960" /></p>
<div class="sourceCode" id="cb353"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 그룹(catalyst) 별 박스플롯 - 그림 7.8</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cld</span>(catalystm.glht))</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="st">&quot;3&quot;</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels=</span> <span class="fu">signif</span>(<span class="fu">model.tables</span>(catalystm1.aov, <span class="st">&quot;means&quot;</span>)[[<span class="dv">1</span>]]<span class="sc">$</span>catalyst, <span class="dv">4</span>) )</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">c</span>(.<span class="dv">5</span>, <span class="fl">2.5</span>), <span class="fu">c</span>(<span class="fl">62.1</span>, <span class="fl">63.7</span>), <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">4.5</span>), <span class="fu">c</span>(<span class="fl">62.1</span>, <span class="fl">63.7</span>), <span class="at">xpd=</span><span class="cn">NA</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-95-1.png" width="960" /></p>
<p><code>multcomp</code> 패키지에서 제공하는 <em>cld</em>를 사용하면
쌍별 비교 결과를 박스플롯으로 간단하게 시각화가 가능하다.</p>
<p>쌍별 비교시 제공되는 그룹도 나타내주어 차이가 나는 그룹을 눈으로 쉽게
확인할 수 있다는 장점이 있다. 본 그림에서는 D-A, D-B에서 차이가 나타나는
것을 확인할 수 있고, 위에서 실시했던 신뢰구간을 통한 해석과 동일한
결과이다.</p>
<div class="sourceCode" id="cb354"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mmc 적용</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>catalystm.mmc <span class="ot">&lt;-</span></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mmc</span>(catalystm1.aov, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">catalyst =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.mmc)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-96-1.png" width="960" /></p>
<p>위의 glht 함수를 적용한 것과 동일하게 D-A, D-B에서 차이가
나타났다.</p>
<p><code>Tukey</code> 방법은 집단별 샘플수가 동일해야 해당 방법을
적용했을 때의 최적의 결과를 도출한다. 예시로 A, D 그룹의 표본 크기를 5로
지정하고 B, C 그룹의 표본 크기를 100으로 임의 설정하여
<code>Tukey</code> 사후검정 결과를 비교해보겠다.</p>
<p><em>aovSufficient</em> 함수는 <code>HH</code> 패키지에서 제공하는
함수로 임의로 각 그룹의 표본 크기, 표본 평균와 그룹 내 표준 편차를
지정하여 ANOVA를 시행할 수 있게 해준다.</p>
<div class="sourceCode" id="cb355"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="co">#A-D까지</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">5</span>) <span class="co">#각 그룹 표본 크기 지정</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">2.1</span>,<span class="fl">2.8</span>,<span class="dv">3</span>) <span class="co">#각 그룹의 표본 평균 지정</span></span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>inconsistent.aov <span class="ot">&lt;-</span> <span class="fu">aovSufficient</span>(ybar <span class="sc">~</span> group, <span class="at">weight=</span>n, <span class="at">sd=</span>.<span class="dv">8</span>) <span class="co">#sd-그룹 내 표준 편차</span></span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(inconsistent.aov)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: ybar
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## group       3  27.024  9.0079  14.075 2.213e-08 ***
## Residuals 206 131.840  0.6400                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>임의 설정한 데이터의 ANOVA 결과, 적어도 한 그룹 이상에서 유의한
차이를 보인다고 할 수 있다.(p-value &lt; 0.05)</p>
<p><code>Tukey</code> 사후 검정을 실시한다.</p>
<div class="sourceCode" id="cb357"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tukey 사후검정 적용</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>inconsistent.glht <span class="ot">&lt;-</span></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glht</span>(inconsistent.aov, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">group=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">vcov.=</span>vcovSufficient, <span class="at">df=</span>inconsistent.aov<span class="sc">$</span>df.residual)</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co">#qtukey - tukey Comparision-wise 구하기(p,그룹 수, df)</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>crit.point <span class="ot">&lt;-</span> <span class="fu">qtukey</span>(.<span class="dv">95</span>,<span class="dv">4</span>,<span class="dv">206</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a>crit.point <span class="co">#2.590125</span></span></code></pre></div>
<pre><code>## [1] 2.590125</code></pre>
<div class="sourceCode" id="cb359"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co">#사후검정 신뢰구간 결과(calpha - Comparision-wise 지정)</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(inconsistent.glht, <span class="at">calpha=</span>crit.point)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = formula, data = data, weights = weights, x = TRUE)
## 
## Quantile = 2.5901
## 95% confidence level
##  
## 
## Linear Hypotheses:
##            Estimate lwr      upr     
## B - A == 0  0.10000 -0.84956  1.04956
## C - A == 0  0.80000 -0.14956  1.74956
## D - A == 0  1.00000 -0.31051  2.31051
## C - B == 0  0.70000  0.40696  0.99304
## D - B == 0  0.90000 -0.04956  1.84956
## D - C == 0  0.20000 -0.74956  1.14956</code></pre>
<p>신뢰구간을 살펴보면 C-B에서만 0을 포함하지 않아 차이가 있다고 해석할
수 있다.</p>
<div class="sourceCode" id="cb361"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 그룹 별 박스플롯 - 그림 7.9</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cld</span>(inconsistent.glht))</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="st">&quot;3&quot;</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels=</span><span class="fu">format</span>(ybar,<span class="dv">1</span>))</span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>), <span class="fu">c</span>(<span class="fl">3.43</span>, <span class="fl">3.61</span>), <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>), <span class="fu">c</span>(<span class="fl">3.43</span>, <span class="fl">3.61</span>), <span class="at">xpd=</span><span class="cn">NA</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-99-1.png" width="960" /></p>
<p>각 그룹 별 평균 그림을 보면 사후검정에서 차이가 있다고 나타난 B-C의
평균 차이보다 A-D의 평균 차이가 커보인다. 그럼에도 A-D에서는 차이가
없다고 나타난 것으로 보아 집단 간 표본의 수가 같고 클수록 더 정확한 검정
결과가 도출된다는 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb362"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co">#신뢰구간 시각화 - 그림 7.10</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(inconsistent.glht, <span class="at">focus=</span><span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-100-1.png" width="960" /></p>
<div class="sourceCode" id="cb363"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mmc 사용하여 다중비교</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>inconsistent.mmc <span class="ot">&lt;-</span> <span class="fu">mmc</span>(inconsistent.aov,</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">group=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">vcov.=</span>vcovSufficient,</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">df=</span>inconsistent.aov<span class="sc">$</span>df.residual,</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">calpha=</span><span class="fu">qtukey</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="dv">206</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a><span class="co">#각 그룹 별 평균 신뢰구간 시각화 - 그림 7.11</span></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(inconsistent.mmc<span class="sc">$</span>none<span class="sc">$</span>glht, <span class="at">focus=</span><span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-100-2.png" width="960" /></p>
<p>none을 지정하게 되면 각 그룹에 대한 정보만 확인할 수 있다.</p>
<p>본 그림을 보면 표본 크기가 작은 A와 D는 신뢰구간도 크게(보수적으로)
잡히는 것을 확인할 수 있다. 이러한 이유로 표본 크기가 클수록 더 정확한
사후검정 결과가 도출된다.</p>
<div class="sourceCode" id="cb364"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mmc 다중비교 시각화 - 그림 7.12</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(inconsistent.mmc, <span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-101-1.png" width="960" /></p>
</div>
<div id="display-of-an-orthogonal-basis-set-of-contrasts"
class="section level3">
<h3>7.2.4 Display of an Orthogonal Basis Set of Contrasts</h3>
<p>본 장에서는 catalystm 데이터셋을 사용하여 대비와 직교에 대한 내용을
다룬다.</p>
<p><code>contrasts</code> 함수를 사용하여 대비 계수 확인: + base=1이
기본이기 때문에 base를 따로 지정해주지 않으면 control 그룹이 자동적으로
첫번째 그룹 변수가 된다.</p>
<div class="sourceCode" id="cb365"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co">#대비계수 확인</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(catalystm<span class="sc">$</span>catalyst)</span></code></pre></div>
<pre><code>##   B C D
## A 0 0 0
## B 1 0 0
## C 0 1 0
## D 0 0 1</code></pre>
<p>base를 지정해주지 않아 A 그룹이 자동적으로 control 그룹으로
지정됨.</p>
<div class="sourceCode" id="cb367"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>catalystm.mmc<span class="sc">$</span>mca<span class="sc">$</span>glht<span class="sc">$</span>linfct</span></code></pre></div>
<pre><code>##     (Intercept) catalystB catalystC catalystD
## A-B           0        -1         0         0
## A-C           0         0        -1         0
## B-C           0         1        -1         0
## A-D           0         0         0        -1
## B-D           0         1         0        -1
## C-D           0         0         1        -1</code></pre>
<p><em>linfct</em>는 linear function을 의미하는 것으로 각 행은 해당
contrast matrix의 열 차이다. A는 자동적으로 control 그룹으로 지정되어
Intercept열로 나타난다.</p>
<p><code>ImatPairwise</code> 함수를 사용하면 해당 mmc 개체에 내포된
대비를 분리할 수 있다.</p>
<div class="sourceCode" id="cb369"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>catalyst.pairwise <span class="ot">&lt;-</span> <span class="fu">lmatPairwise</span>(catalystm.mmc)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>catalyst.pairwise</span></code></pre></div>
<pre><code>##   A-B A-C B-C A-D B-D C-D
## A   1   1   0   1   0   0
## B  -1   0   1   0   1   0
## C   0  -1  -1   0   0   1
## D   0   0   0  -1  -1  -1</code></pre>
<p>contrast를 Imat 포맷에 맞춰서 나타나며 각 열의 합은 0이다. 비교
대상으로 지정된(control 그룹 - A) A가 기준이기 때문에 A-B에서 A의 계수가
1, B의 계수가 -1로 열의 합이 0이 되도록 한다.</p>
<p>직교대비는 만약 요인 A가 a개의 수준을 가진다면 이 요인에 대한
직교대비를 a-1개 만들 수 있다.</p>
<div class="sourceCode" id="cb371"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co">#직교대비 행렬 만들기</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>catalystm.lmat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;AB-D&quot;</span> <span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;A-B&quot;</span>  <span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;ABD-C&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="co">#행이름 지정(각 그룹명)</span></span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(catalystm.lmat)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">levels</span>(catalystm<span class="sc">$</span>catalyst)</span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>catalystm.lmat</span></code></pre></div>
<pre><code>##   AB-D A-B ABD-C
## A    1   1     1
## B    1  -1     1
## C    0   0    -3
## D   -2   0     1</code></pre>
<p>해당 데이터는 4개의 수준을 가지기 때문에 3개의 직교대비를 만들 수
있다. 관심있는 비교에 대한 직교대비를 만들었다.</p>
<div class="sourceCode" id="cb373"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co">#crossprod - 내적 계산 함수</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">crossprod</span>(catalystm.lmat) <span class="co">#rank=3</span></span></code></pre></div>
<pre><code>##       AB-D A-B ABD-C
## AB-D     6   0     0
## A-B      0   2     0
## ABD-C    0   0    12</code></pre>
<div class="sourceCode" id="cb375"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(<span class="fu">lm</span>(catalystm.lmat <span class="sc">~</span> catalyst.pairwise))</span></code></pre></div>
<pre><code>##   AB-D A-B ABD-C
## A    0   0     0
## B    0   0     0
## C    0   0     0
## D    0   0     0</code></pre>
<p>관심있는 직교대비을 사용하여 <code>Tukey</code>의 사후검정을
진행한다.</p>
<div class="sourceCode" id="cb377"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>catalystm.mmc <span class="ot">&lt;-</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(catalystm1.aov,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">catalyst=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">focus.lmat=</span>catalystm.lmat)</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>catalystm.mmc</span></code></pre></div>
<pre><code>## Tukey contrasts
## Fit: aov(formula = concent ~ catalyst, data = catalystm) 
## Estimated Quantile = 2.970141 
## 95% family-wise confidence level
## $mca
##     estimate   stderr       lower    upper   height
## A-B 1.125000 1.138447 -2.25634933 4.506349 56.33750
## A-C 3.666667 1.239385 -0.01448022 7.347814 55.06667
## B-C 2.541667 1.296179 -1.30816890 6.391502 54.50417
## A-D 5.775000 1.138447  2.39365067 9.156349 54.01250
## B-D 4.650000 1.200029  1.08574485 8.214255 53.45000
## C-D 2.108333 1.296179 -1.74150223 5.958169 52.17917
## $none
##   estimate    stderr    lower    upper   height
## A 56.90000 0.7589649 54.64577 59.15423 56.90000
## B 55.77500 0.8485486 53.25469 58.29531 55.77500
## C 53.23333 0.9798195 50.32313 56.14354 53.23333
## D 51.12500 0.8485486 48.60469 53.64531 51.12500
## $lmat
##       estimate   stderr     lower    upper   height
## A-B   1.125000 1.138447 -2.256349 4.506349 56.33750
## ABD-C 1.366667 1.088144 -1.865274 4.598607 53.91667
## AB-D  5.212500 1.021788  2.177646 8.247354 53.73125</code></pre>
<p>$imat의 결과를 보면 AB-D의 신뢰구간이 0을 포함하지 않기 때문에 A,B와
D간 차이가 발생한다고 해석할 수 있다.</p>
<div class="sourceCode" id="cb379"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co">#직교 대비 사후검정 시각화 - 그림7.17</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(catalystm.mmc, <span class="at">type=</span><span class="st">&quot;lmat&quot;</span>, <span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-108-1.png" width="960" /></p>
</div>
<div id="hsu-and-peruggias-pulmonary-example" class="section level3">
<h3>7.2.5 Hsu and Peruggia’s Pulmonary Example</h3>
<p>본 장에서는 Hsu와 Peruggia가 다중비교그림을 도입하기 위해 사용한
폐활량 관련 데이터를 사용한다.</p>
<p>데이터명은 pulmonary로 반응변수는 FVC로 노력성 폐활량을 의미한다. 각
그룹은 아래의 기준에 따라 나눠진 것으로 6개의 그룹으로 이루어져있다.</p>
<ul>
<li>NS: 비흡연자</li>
<li>PS: 간접흡연자</li>
<li>NI: 흡입담배를 피지않는 흡연자</li>
<li>LS: 가벼운 흡연자-지난 20년동안, 하루에 핀 담배의 개수가 1~10개비인
흡연자</li>
<li>MS: 중간 흡연자-지난 20년동안, 하루에 핀 담배의 개수가 11~39개비인
흡연자</li>
<li>HS: 심한 흡연자-지난 20년동안, 하루에 핀 담배의 개수가 40개비이상인
흡연자</li>
</ul>
<p>n은 각 그룹에 속하는 사람의 수이고 s는 그룹 내 표준 편차를
의미한다.</p>
<p><em>aovSufficient</em> 함수를 이용하여 ANOVA를 실시한다.</p>
<div class="sourceCode" id="cb380"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co">#데이터 호출</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;pulmonary&quot;</span>)</span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova</span></span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>pulmonary.aov <span class="ot">&lt;-</span></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aovSufficient</span>(FVC <span class="sc">~</span> smoker, <span class="at">data=</span>pulmonary,</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">weights=</span>pulmonary<span class="sc">$</span>n, <span class="at">sd=</span>pulmonary<span class="sc">$</span>s)</span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pulmonary.aov)</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)    
## smoker         5  89.27  17.853   83.93 &lt;2e-16 ***
## Residuals   1044 222.08   0.213                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>해석:</p>
<ul>
<li>귀무가설: <span class="math inline">\(H_0: 흡연자 유형 별 FVC 평균의
차이는 없다.\)</span></li>
<li>대립가설: <span class="math inline">\(H_1: 흡연자 유형 별 FVC 평균의
차이는 있다.\)</span></li>
<li><span class="math inline">\(p-value = &lt;2e-16\)</span></li>
<li>검정통계량 <span class="math inline">\(F-value = 83.93\)</span></li>
<li>유의수준 $0.05 &gt; p-value&lt;2e-16 $로 귀무가설 기각. 즉, 흡연자
유형 별 FVC 평균의 차이는 있다고 할 수 있다.</li>
</ul>
<p>이제 어디에서 차이가 나타나는지 <code>tukey</code>의 사후검정을
진행한다. - 쌍별 비교를 위해</p>
<div class="sourceCode" id="cb382"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tukey 사후검정 적용</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>pulmonary.glht <span class="ot">&lt;-</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glht</span>(pulmonary.aov, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">smoker=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">vcov.=</span>vcovSufficient, <span class="at">df=</span>pulmonary.aov<span class="sc">$</span>df.residual)</span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>pulmonary.glht</span></code></pre></div>
<pre><code>## 
##   General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Linear Hypotheses:
##              Estimate
## PS - NS == 0    -0.12
## NI - NS == 0    -0.16
## LS - NS == 0    -0.20
## MS - NS == 0    -0.55
## HS - NS == 0    -0.80
## NI - PS == 0    -0.04
## LS - PS == 0    -0.08
## MS - PS == 0    -0.43
## HS - PS == 0    -0.68
## LS - NI == 0    -0.04
## MS - NI == 0    -0.39
## HS - NI == 0    -0.64
## MS - LS == 0    -0.35
## HS - LS == 0    -0.60
## HS - MS == 0    -0.25</code></pre>
<div class="sourceCode" id="cb384"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co">#qtukey - tukey Comparision-wise 구하기(p,그룹 수, residual-df)</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>crit.point <span class="ot">&lt;-</span> <span class="fu">qtukey</span>(.<span class="dv">95</span>,<span class="dv">6</span>,<span class="dv">1044</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>crit.point <span class="co">#2.855016</span></span></code></pre></div>
<pre><code>## [1] 2.855016</code></pre>
<div class="sourceCode" id="cb386"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co">#사후검정 신뢰구간 결과(calpha - Comparision-wise 지정)</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(pulmonary.glht, <span class="at">calpha=</span>crit.point)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = formula, data = data, weights = weights, x = TRUE)
## 
## Quantile = 2.855
## 95% confidence level
##  
## 
## Linear Hypotheses:
##              Estimate lwr      upr     
## PS - NS == 0 -0.12000 -0.25168  0.01168
## NI - NS == 0 -0.16000 -0.36820  0.04820
## LS - NS == 0 -0.20000 -0.33168 -0.06832
## MS - NS == 0 -0.55000 -0.68168 -0.41832
## HS - NS == 0 -0.80000 -0.93168 -0.66832
## NI - PS == 0 -0.04000 -0.24820  0.16820
## LS - PS == 0 -0.08000 -0.21168  0.05168
## MS - PS == 0 -0.43000 -0.56168 -0.29832
## HS - PS == 0 -0.68000 -0.81168 -0.54832
## LS - NI == 0 -0.04000 -0.24820  0.16820
## MS - NI == 0 -0.39000 -0.59820 -0.18180
## HS - NI == 0 -0.64000 -0.84820 -0.43180
## MS - LS == 0 -0.35000 -0.48168 -0.21832
## HS - LS == 0 -0.60000 -0.73168 -0.46832
## HS - MS == 0 -0.25000 -0.38168 -0.11832</code></pre>
<div class="sourceCode" id="cb388"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co">#신뢰구간 시각화</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(pulmonary.glht, <span class="at">focus=</span><span class="st">&quot;smoker&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-110-1.png" width="960" /></p>
<p>신뢰구간에 0을 포함하지 않는 것은 총 10개의 비교이다.</p>
<p>관심있는 비교를 위해 직교 대비 행렬을 5개(6-1) 생성하고, 다중 비교를
진행했다. mmc를 적용하여 mmcplot으로 시각화해보았다.</p>
<div class="sourceCode" id="cb389"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co">#직교 대비 행렬 생성</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>pulm.lmat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;npnl-mh&quot;</span><span class="ot">=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>), <span class="do">## not.much vs lots</span></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;n-pnl&quot;</span>  <span class="ot">=</span><span class="fu">c</span>( <span class="dv">3</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="do">## none vs light</span></span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;p-nl&quot;</span>   <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="do">## {} arbitrary 2 df</span></span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;n-l&quot;</span>    <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="do">## {} for 3 types of light</span></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;m-h&quot;</span>    <span class="ot">=</span><span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)) <span class="do">## moderate vs heavy</span></span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(pulm.lmat)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">row.names</span>(pulmonary)</span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-9"><a href="#cb389-9" aria-hidden="true" tabindex="-1"></a><span class="co">#mmc 적용</span></span>
<span id="cb389-10"><a href="#cb389-10" aria-hidden="true" tabindex="-1"></a>pulmonary.mmc <span class="ot">&lt;-</span></span>
<span id="cb389-11"><a href="#cb389-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mmc</span>(pulmonary.aov,</span>
<span id="cb389-12"><a href="#cb389-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">smoker=</span><span class="st">&quot;Tukey&quot;</span>),</span>
<span id="cb389-13"><a href="#cb389-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">df=</span>pulmonary.aov<span class="sc">$</span>df.residual,</span>
<span id="cb389-14"><a href="#cb389-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov.=</span>vcovSufficient,</span>
<span id="cb389-15"><a href="#cb389-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">focus.lmat=</span>pulm.lmat)</span>
<span id="cb389-16"><a href="#cb389-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-17"><a href="#cb389-17" aria-hidden="true" tabindex="-1"></a><span class="co">#pairwise 시각화 - 그림 7.18</span></span>
<span id="cb389-18"><a href="#cb389-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(pulmonary.mmc, <span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-111-1.png" width="960" /></p>
<div class="sourceCode" id="cb390"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co">#직교 대비 행렬 비교 시각화 - 그림 7.19</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mmcplot</span>(pulmonary.mmc, <span class="at">type=</span><span class="st">&quot;lmat&quot;</span>, <span class="at">style=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A01_%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC_%EC%9D%B4%ED%95%98%EB%8A%98_files/figure-html/unnamed-chunk-111-2.png" width="960" /></p>
<p>차이가 나타난 관심비교 항목은</p>
<ul>
<li>none(비흡연자)와 약한 흡연자들(간접, 전자, 약한)과의 차이</li>
<li>비흡연자&amp;약한 흡연자들과 중간&amp;심한 흡연자와의 차이</li>
<li>중간 흡연자와 강한 흡연자와의 차이</li>
</ul>
<p>이다.</p>
<p><br></p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<p><a
href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html">R
tutorial</a></p>
<hr />
<p>ⓒ Statistical Methods, Gachon University</p>
<hr />
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
