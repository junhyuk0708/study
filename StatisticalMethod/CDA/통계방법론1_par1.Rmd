---
title: "통계 방법론1 part1"
author: "응용통계학과 이준혁"
date: "2023-10-14(토)"
output:
  html_document:
    css: styles.css
    #code_folding: show
    fig_caption: yes
    fig_height: 7.5
    fig_width: 10
    fig_retina: null
    highlight: haddock
    self_contained: yes
    theme: cosmo
    toc: yes
    toc_depth: 6
    toc_float: yes
    fig_dpi: 300
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
<style type="text/css">
  body, td {
     font-size: 16px;
     font-family: 맑은 고딕
  }
  code.r{
    font-size: 16px;
    font-weight: bold;
    font-family: 맑은 고딕
  }
  pre {
    font-size: 14px
    font-family: 맑은 고딕
  }
  h1,h2,h3,h4,h5,h6{
    font-family: 맑은 고딕;
    font-weight: bold;
  }
  h1{
    font-size: 18pt;
  }
  h2{
    font-size: 16pt;
  }
  h3{
    font-size: 14pt;
  }
  table{
    font-size: 20px;
  }
</style>
<br><br><br><br>

---

# Part1, 단순 회귀 분석 Simple Regression Analysis

## 예제1. simple.csv: 임의로 선택된 소형 화물의 무게$(x;~g)$과 부피$(y;~cm^3)$

-   무게에 의하여 운송 요금을 결정하는 소형 화물들 중에서 임의로 선택된 58개의 무게(x; weight)과 부피(y; volume)을 조사하였다.
-   이를 이용하여 중량과 부피간의 관계를 추정하여 운송 계획을 수립하고자 한다.

```{r}
cargo <- read.csv(paste0(data_path, "simple.csv"))
str(cargo)

na_count <- function(df){
  sapply(df, function(y) sum(length(which(is.na(y)))))
}

na_count(cargo)
x <- cargo$x
y <- cargo$y
Sxy <- sum((x - mean(x)) * (y - mean(y)))
Sxx <- sum((x - mean(x))^2)
Syy <- sum((y - mean(y))^2)
#
hat_beta1 <- Sxy / Sxx
hat_beta0 <- mean(y) - hat_beta1*mean(x)
round(c(hat_beta0, hat_beta1), 2)


```

## 실습 18. 유통 매장 정리 시간 dist.store.csv

```{r}
dist <- read.csv(paste0(data_path, "dist.store.csv"))

```

```{r}
str(dist)
head(dist)
tail(dist)
view(dist)
```

```{r}
dist <- dist %>% 
  rename_all(tolower)

head(dist, 5)
```
```{r}
na_count <- function(df){
  sapply(df, function(y) sum(length(which(is.na(y)))))
}

na_count(dist)
```

-   (case, time)의 관계는 직선의 경향을 갖는다.

```{r}
dist %>% 
  ggplot(aes(case, time)) +
  geom_point(color = sbl) +
  theme_bw()
```

```{r}
dest_fit <- lm(time ~ case, data = dist)
```



